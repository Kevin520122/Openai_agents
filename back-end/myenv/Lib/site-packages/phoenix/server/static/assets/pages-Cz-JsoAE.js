import{z as L,aT as pe,aU as Ne,aV as ze,aW as ol,A as ul,r as m,j as e,R as Ie,u as Wa,E as T,l as s,aX as Oe,al as se,O as H,v as x,aY as _u,ab as Ae,a7 as ot,ag as Xe,af as G,Q as W,ar as ca,a8 as dt,aZ as cn,a_ as Lu,am as wu,a$ as Eu,H as li,S as ae,T as Fe,b0 as Ui,aw as xe,az as De,aA as Z,b1 as Le,b2 as Tn,b3 as Pn,b4 as hn,o as Bi,I as Vu,b5 as Mu,b6 as jl,b7 as ql,b8 as Ma,b9 as an,n as Ja,ba as Ru,an as de,aF as Hi,bb as Au,bc as ti,bd as Nu,be as zu,bf as $u,bg as Ou,bh as Qu,bi as ju,bj as qu,bk as Uu,bl as Bu,bm as Ue,bn as Ua,D as Hu,bo as Gu,bp as tl,ax as kn,g as Gi,bq as Wu,aq as ct,br as Wi,bs as Ji,bt as Ju,ah as Zu,ac as ut,bu as Xu,ad as Yu,ae as em,bv as nm,p as am}from"./vendor-Cqfydjep.js";import{z as ml,B as pl,C as O,L as va,d as X,w as He,x as ne,G as un,D as Y,A as ye,H as mt,q as gl,P as ua,e as qe,f as ma,T as fe,E as yl,a as Ve,s as Un,t as Ia,y as pt,c as Bn,J as xa,p as lm,g as gt,v as fl,K as tm,n as hl,h as Hn,M as im,N as rm,O as sm,Q as yt,R as ft,j as ii,S as om,l as dm,I as cm,k as ri,i as um,u as mm,U as pm}from"./vendor-arizeai-WnerlUPN.js";import{s as gm,l as ym,j as ht,a as we,i as kt,b as Zi,c as fm,d as On,e as In,f as Xi,D as Yi,g as $n,h as ja,k as hm,m as ke,T as We,n as km,o as bt,p as si,q as bm,r as oi,t as Sm,u as vm,v as Cm,N as Fm,w as Km,L as Ce,x as Te,y as Za,B as Tm,_ as h,z as vn,I as _,C as Pm,G as er,A as St,P as pa,M as nr,E as kl,S as ar,F as Im,H as xm,J as Dm,K as _m,O as Lm,Q as wm,R as Em,U as be,V as v,W as C,X as ce,Y as at,Z as ue,$ as me,a0 as Je,a1 as Vm,a2 as Mm,a3 as Rm,a4 as Ye,a5 as Se,a6 as Pe,a7 as M,a8 as te,a9 as J,aa as Am,ab as Nm,ac as zm,ad as $m,ae as bl,af as Sl,ag as lr,ah as Om,ai as Qm,aj as jm,ak as re,al as vl,am as qm,an as tr,ao as ir,ap as vt,aq as Qe,ar as Um,as as Ct,at as Bm,au as Hm,av as Gm,aw as Fn,ax as je,ay as ln,az as rr,aA as Cl,aB as Me,aC as Gn,aD as Ke,aE as Re,aF as Da,aG as wn,aH as xn,aI as Fl,aJ as Wn,aK as Kl,aL as sr,aM as en,aN as or,aO as Wm,aP as Ft,aQ as ia,aR as An,aS as Jm,aT as Zm,aU as dr,aV as cr,aW as Tl,aX as gn,aY as Jn,aZ as tn,a_ as rn,a$ as Xm,b0 as Ym,b1 as Ba,b2 as ep,b3 as Ca,b4 as Ge,b5 as Kt,b6 as np,b7 as ap,b8 as Pl,b9 as En,ba as lp,bb as tp,bc as Tt,bd as nn,be as yn,bf as _a,bg as Pt,bh as ur,bi as ip,bj as mr,bk as rp,bl as It,bm as Xa,bn as pr,bo as gr,bp as yr,bq as Be,br as fr,bs as bn,bt as lt,bu as sp,bv as xt,bw as Dt,bx as _t,by as op,bz as dp,bA as cp,bB as up,bC as qa,bD as hr,bE as mp,bF as kr,bG as sn,bH as pp,bI as gp,bJ as yp,bK as fp,bL as hp,bM as kp,bN as bp,bO as Lt,bP as Sp,bQ as vp,bR as br,bS as Sr,bT as di,bU as Sn,bV as Vn,bW as wt,bX as vr,bY as Cr,bZ as ci,b_ as ui,b$ as Cp,c0 as Fp,c1 as B,c2 as Fr,c3 as Et,c4 as Il,c5 as La,c6 as Kr,c7 as wa,c8 as Ea,c9 as Tr,ca as Mn,cb as $e,cc as xl,cd as Zn,ce as Kp,cf as Tp,cg as Pp,ch as Ip,ci as xp,cj as on,ck as dn,cl as Dp,cm as _p,cn as Pr,co as Lp,cp as wp,cq as mi,cr as Ep,cs as Vp,ct as Mp,cu as Rp,cv as Ap,cw as Np,cx as Ir,cy as zp,cz as $p,cA as Op,cB as Qp,cC as jp,cD as oa,cE as Vt,cF as xr,cG as Sa,cH as tt,cI as Dl,cJ as Dr,cK as _r,cL as Ul,cM as qp,cN as Up,cO as Mt,cP as _l,cQ as mn,cR as Bp,cS as Lr,cT as wr,cU as Er,cV as Hp,cW as Gp,cX as Vr,cY as Qn,cZ as Wp,c_ as pi,c$ as Mr,d0 as Jp,d1 as Zp,d2 as Xp,d3 as Yp,d4 as eg,d5 as Rr,d6 as ng,d7 as Fa,d8 as it,d9 as ag,da as Ar,db as lg,dc as tg,dd as ig,de as Ll,df as Nr,dg as gi,dh as rg,di as sg,dj as Rt,dk as zr,dl as $r,dm as og,dn as rt,dp as dg,dq as cg,dr as il,ds as ug,dt as mg,du as Or,dv as Qr,dw as pg,dx as gg,dy as yg,dz as yi,dA as fi}from"./components-CgcYOKnv.js";import{n as Xn,j as fg,E as jr,R as Yn,k as At,d as hg,m as kg,p as Ya,q as qr}from"./vendor-codemirror-D-ZZKLFq.js";import{R as ea,C as el,X as na,Y as fn,a as aa,T as la,B as Ta,A as Ha,b as Ur,c as Nt,L as Br,d as bg,P as Sg,e as vg,f as Cg}from"./vendor-recharts-KY97ZPfK.js";const Fg=4,Kg={user:["user","human"],ai:["assistant","bot","ai"],system:["system"],tool:["tool"]},Tg="Unable to parse span input messages, expected messages which include a role and content.",Pg="Unable to parse span output messages, expected messages which include a role and content.",Ig="Unable to parse span output expected output.value to be present.",xg="Unable to parse span attributes, attributes must be valid JSON.",Dg="Unable to parse model config, expected llm.model_name to be present.",_g="Unable to parse model config, expected llm.invocation_parameters JSON string to be present.",Lg="Unable to parse invocation parameters response_format, expected llm.invocation_parameters.response_format to be a well formed json object or undefined.",wg="Unable to parse tools, expected tools to be an array of valid tools.",Eg="Unable to parse prompt template variables, expected prompt template variables to be a valid JSON object string.",hi={AZURE_OPENAI:[],ANTHROPIC:["claude"],OPENAI:["gpt","o1"],GOOGLE:["gemini"]},ra="TOOL_CHOICE",Ka="tool_choice",Dn="RESPONSE_FORMAT",Kn="response_format",Vg=[ra,Dn],Mg=L.object({tool_call:L.object({id:L.string().optional(),function:L.object({name:L.string(),arguments:L.string()}).partial()}).partial()}).partial(),Hr=L.object({[pe.message]:L.object({[Ne.role]:L.string(),[Ne.content]:L.union([L.string(),L.array(L.record(L.string(),L.unknown()))]).default(""),[Ne.tool_calls]:L.array(Mg).optional(),[Ne.tool_call_id]:L.string().optional()})}),Rg=L.object({[pe.llm]:L.object({[ze.input_messages]:L.array(Hr)})}),Ag=L.object({[pe.llm]:L.object({[ze.output_messages]:L.array(Hr)})}),Ng=L.object({[pe.output]:L.object({value:L.string()})}),Gr=gm()(L.enum(["user","ai","system","tool"])),zg=L.object({id:L.number(),role:Gr,content:L.string().optional(),toolCallId:L.string().optional(),toolCalls:L.array(ym).optional()}),$g=L.array(zg),zt=L.lazy(()=>L.record(ht)),Og=zt,Wr=L.string().transform((n,a)=>{const{json:l}=we(n);if(!kt(l))return a.addIssue({code:L.ZodIssueCode.custom,message:"The invocation parameters must be a valid JSON object"}),L.NEVER;const{success:t,data:i}=Og.safeParse(l);return t?i:(a.addIssue({code:L.ZodIssueCode.custom,message:"The invocation parameters must be a valid JSON object"}),L.NEVER)}).default("{}"),Qg=L.object({[pe.llm]:L.object({[ze.provider]:L.string().optional(),[ze.model_name]:L.string()})}),Jr=L.object({[pe.llm]:L.object({[ze.invocation_parameters]:Wr})}),jg=L.object({[pe.llm]:L.object({[ze.invocation_parameters]:Wr.pipe(L.object({response_format:zt.optional()}))})}),qg=L.object({url:L.object({full:L.string(),path:L.string().optional()})}),Ug=L.string().transform((n,a)=>{const{json:l}=we(n);return l==null||!kt(l)?(a.addIssue({code:L.ZodIssueCode.custom,message:"The tool JSON schema must be a valid JSON object"}),L.NEVER):l}).transform((n,a)=>{const{data:l,success:t}=Zi.safeParse(n);return t?l:(a.addIssue({code:L.ZodIssueCode.custom,message:"The tool JSON schema must be a valid tool schema"}),L.NEVER)}),Bg=L.object({[pe.llm]:L.object({[ze.tools]:L.array(L.object({[pe.tool]:L.object({[ol.json_schema]:Ug})}).optional()).optional()}).optional()}).optional(),Hg=L.lazy(()=>L.object({type:L.literal("json_schema"),json_schema:L.object({name:L.string().describe("The name of the schema"),schema:fm.describe("The schema itself in JSON schema format"),strict:L.literal(!0).describe("The schema must be strict")})})),Gg=ul(Hg,{removeAdditionalStrategy:"passthrough"}),Wg=L.string().transform((n,a)=>{const{json:l}=we(n);return On(l)?Object.entries(l).reduce((i,[r,o])=>{if(typeof o=="string")i[r]=o;else{const{json:d}=In(o);d!=null&&(i[r]=d)}return i},{}):(a.addIssue({code:L.ZodIssueCode.custom,message:"The prompt template variables must be a valid JSON object"}),L.NEVER)}),Jg=L.object({[pe.llm]:L.object({[ze.prompt_template]:L.object({variables:Wg}).optional()}).optional()}).optional();function Zr(n){return Gr.safeParse(n).success}function Nn(n){const a=n.toLowerCase();if(Zr(a))return a;for(const[l,t]of Object.entries(Kg))if(t.includes(a))return l;return hm}function Zg({toolCalls:n,provider:a}){if(n!=null)return n.map(({tool_call:l})=>{var i,r,o,d;if(l==null)return null;let t={};if(((i=l.function)==null?void 0:i.arguments)!=null){const{json:c}=we(l.function.arguments);On(c)&&(t=c)}switch(a){case"OPENAI":case"AZURE_OPENAI":return{id:l.id??"",type:"function",function:{name:((r=l.function)==null?void 0:r.name)??"",arguments:t}};case"ANTHROPIC":return{id:l.id??"",type:"tool_use",name:((o=l.function)==null?void 0:o.name)??"",input:t};case"GOOGLE":return{id:l.id??"",function:{name:((d=l.function)==null?void 0:d.name)??"",arguments:t}};default:ke()}}).filter(l=>l!=null)}function Xr({messages:n,provider:a}){return n.map(({message:l})=>({id:$n(),role:l.tool_call_id!=null?Nn("tool"):Nn(l.role),content:typeof l.content=="string"?l.content:void 0,toolCalls:Zg({provider:a,toolCalls:l.tool_calls}),toolCallId:l.tool_call_id}))}function Xg({provider:n,parsedAttributes:a}){var t;const l=Rg.safeParse(a);if(!l.success)return{messageParsingErrors:[Tg],messages:null};if(n==="ANTHROPIC"){const{success:i,data:r}=Jr.safeParse(a);if(i){const o=l.data.llm.input_messages,d=(t=r.llm.invocation_parameters)==null?void 0:t.system;typeof d=="string"&&d&&(!o||o[0].message.role!=="system")&&l.data.llm.input_messages.unshift({message:{role:"system",content:d}})}}return{messageParsingErrors:[],messages:Xr({provider:n,messages:l.data.llm.input_messages})}}function Yg({provider:n,parsedAttributes:a}){const l=[],t=Ag.safeParse(a);if(t.success)return{output:Xr({provider:n,messages:t.data.llm.output_messages}),outputParsingErrors:l};l.push(Pg);const i=Ng.safeParse(a);return i.success?{output:i.data.output.value,outputParsingErrors:l}:(l.push(Ig),{output:void 0,outputParsingErrors:l})}function Yr(n){if(n==null)return null;switch(n.toLowerCase()){case"openai":return"OPENAI";case"anthropic":return"ANTHROPIC";case"google":return"GOOGLE";case"azure":return"AZURE_OPENAI";default:return null}}function ey(n){for(const a of Object.keys(hi))if(hi[a].some(t=>n.includes(t)))return a;return Yi}function ny(n){const{success:a,data:l}=Qg.safeParse(n);if(a){const t=Yr(l.llm.provider)||ey(l.llm.model_name),i=ay(n);return{modelConfig:{...Object.fromEntries(Object.entries(i).filter(([r,o])=>o!==null)),modelName:l.llm.model_name,provider:t,invocationParameters:[],supportedInvocationParameters:[]},parsingErrors:[]}}return{modelConfig:null,parsingErrors:[Dg]}}function ay(n){const{success:a,data:l}=qg.safeParse(n);if(a)try{const t=new URL(l.url.full);let i=t;if(l.url.path)try{i=new URL(l.url.full.split(l.url.path)[0])}catch{}return{baseUrl:`${i.origin}${i.pathname}`,endpoint:t.origin,apiVersion:t.searchParams.get("api-version")||null}}catch{}return{baseUrl:null,apiVersion:null,endpoint:null}}function ly(n,a=[]){const{success:l,data:t}=Jr.safeParse(n),i=[];return l||i.push(_g),{invocationParameters:my((t==null?void 0:t.llm.invocation_parameters)??{},a),parsingErrors:i}}function ty(n){const{success:a,data:l}=jg.safeParse(n);return a?{responseFormat:l.llm.invocation_parameters.response_format,parsingErrors:[]}:{responseFormat:void 0,parsingErrors:[Lg]}}function iy(n){var a;return(((a=n==null?void 0:n.llm)==null?void 0:a.tools)??[]).map(l=>(l==null?void 0:l.tool)==null?null:{id:ja(),definition:l.tool.json_schema}).filter(l=>l!=null)}function ry(n){var t;const{data:a,success:l}=Bg.safeParse(n);return l?((t=a==null?void 0:a.llm)==null?void 0:t.tools)==null?{tools:null,parsingErrors:[]}:{tools:iy(a),parsingErrors:[]}:{tools:null,parsingErrors:[wg]}}function sy(n){var t;const{success:a,data:l}=Jg.safeParse(n);return a?((t=l==null?void 0:l.llm)==null?void 0:t.prompt_template)==null?{variables:null,parsingErrors:[]}:{variables:l.llm.prompt_template.variables,parsingErrors:[]}:{variables:null,parsingErrors:[Eg]}}function oy(n){const{instance:a,instanceMessages:l}=Xi(),t={...a,template:{__type:"chat",messages:Object.values(l)}},{json:i,parseError:r}=we(n.attributes);if(r)return{playgroundInstance:{...t,spanId:(n==null?void 0:n.id)??null},parsingErrors:[xg]};const o=n.invocationParameters,d=ny(i);let{modelConfig:c}=d;const{parsingErrors:p}=d,{messages:y,messageParsingErrors:u}=Xg({provider:(c==null?void 0:c.provider)??t.model.provider,parsedAttributes:i}),{output:g,outputParsingErrors:f}=Yg({provider:(c==null?void 0:c.provider)??t.model.provider,parsedAttributes:i}),{invocationParameters:k,parsingErrors:b}=ly(i,o),{variables:S,parsingErrors:F}=sy(i),{parsingErrors:P}=ty(i);c=c!=null?{...c,invocationParameters:P.length>0?k.filter(K=>K.invocationName!==Kn&&K.canonicalName!==Dn):k}:null;const{tools:D,parsingErrors:w}=ry(i);return{playgroundInstance:{...t,model:c??t.model,template:y!=null?{__type:"chat",messages:y}:t.template,output:g,spanId:n.id,tools:D??t.tools},playgroundInput:S!=null?{variablesValueCache:S}:void 0,parsingErrors:[...u,...f,...p,...w,...b,...P,...F]}}const dy=n=>$g.safeParse(n).success,es=({instance:n,templateFormat:a})=>{if(a==We.NONE)return[];const l=new Set,t=n.template.__type,i=km(a);switch(t){case"chat":{n.template.messages.forEach(r=>{(r.content==null?[]:i.extractVariables(r.content)).forEach(d=>{l.add(d)})});break}case"text_completion":{i.extractVariables(n.template.prompt).forEach(o=>{l.add(o)});break}default:ke()}return Array.from(l)},cy=({instances:n,templateFormat:a})=>a==We.NONE?[]:Array.from(new Set(n.flatMap(l=>es({instance:l,templateFormat:a})))),ns=({instances:n,templateFormat:a,input:l})=>{if(a==We.NONE)return{variablesMap:{},variableKeys:[]};const t=cy({instances:n,templateFormat:a}),i=l.variablesValueCache??{};return{variablesMap:t.reduce((o,d)=>(o[d]=i[d]||"",o),{}),variableKeys:t}};function jn(n,a){return n.invocationName===a.invocationName||n.canonicalName!=null&&a.canonicalName!=null&&n.canonicalName===a.canonicalName}const uy=(n,a)=>n.filter(l=>a.some(t=>jn(t,l))).map(l=>{var t;return{...l,invocationName:((t=a.find(i=>jn(i,l)))==null?void 0:t.invocationName)??l.invocationName}}),Va=n=>n.replace(/_([a-z])/g,(a,l)=>l.toUpperCase()),my=(n,a)=>Object.entries(n).map(([l,t])=>{const i=a.find(r=>r.canonicalName&&r.canonicalName.toLowerCase()===l.toLowerCase()||r.invocationName&&r.invocationName.toLowerCase()===l.toLowerCase());return i==null||i.invocationInputField==null||i.invocationName==null?null:{canonicalName:i.canonicalName,invocationName:i.invocationName,[Va(i.invocationInputField)]:t}}).filter(l=>l!=null),as=n=>{const{provider:a,validatedToolDefinition:l}=vm(n.definition);switch(a){case"OPENAI":case"AZURE_OPENAI":return l.function.name;case"ANTHROPIC":return l.name;case"UNKNOWN":return null;default:ke()}},py=({provider:n,toolNumber:a})=>{switch(n){case"OPENAI":case"AZURE_OPENAI":return{id:ja(),definition:oi(a)};case"ANTHROPIC":return{id:ja(),definition:Sm(a)};case"GOOGLE":return{id:ja(),definition:oi(a)};default:ke()}},gy=n=>{switch(n){case"OPENAI":case"AZURE_OPENAI":return si();case"ANTHROPIC":return bm();case"GOOGLE":return si();default:ke()}};function yy(n){return{content:n.content,role:fy(n.role),toolCalls:n.toolCalls,toolCallId:n.toolCallId}}function fy(n){switch(n){case"system":return"SYSTEM";case"user":return"USER";case"tool":return"TOOL";case"ai":return"AI";default:ke()}}const ls=({playgroundStore:n,instanceId:a,credentials:l})=>{var u;const{instances:t,allInstanceMessages:i}=n.getState(),r=t.find(g=>g.id===a);if(!r)throw new Error(`No instance found for id ${a}`);if(r.template.__type!=="chat")throw new Error("We only support chat templates for now");const o=r.template.messageIds.map(g=>i[g]).filter(g=>g!=null),d=r.model.supportedInvocationParameters;let c=[...r.model.invocationParameters];const p=bt({toolChoice:r.toolChoice,targetProvider:r.model.provider});r.tools.length>0?(c=c.filter(g=>g.invocationName!==Ka&&g.canonicalName!==ra),c.push({canonicalName:ra,invocationName:Ka,valueJson:p})):c=c.filter(g=>g.invocationName!==Ka&&g.canonicalName!==ra),c=d.length?uy(c,d):c;const y=r.model.provider==="AZURE_OPENAI"?{endpoint:r.model.endpoint,apiVersion:r.model.apiVersion}:{};return{messages:o.map(yy),model:{providerKey:r.model.provider,name:r.model.modelName||"",baseUrl:r.model.baseUrl,...y},invocationParameters:c,tools:r.tools.length?r.tools.map(g=>g.definition):void 0,apiKey:l[r.model.provider]||null,promptName:(u=r.prompt)==null?void 0:u.name}},wl=(n,a)=>{if(n.template.__type==="chat"){const{messageIds:l,...t}=n.template;return{...n,template:{...t,messages:n.template.messageIds.map(i=>a[i])}}}return n},hy=({playgroundStore:n,instanceId:a,credentials:l})=>{const t=ls({playgroundStore:n,instanceId:a,credentials:l}),{instances:i,templateFormat:r,input:o,allInstanceMessages:d}=n.getState(),c=i.map(y=>wl(y,d)),{variablesMap:p}=ns({instances:c,input:o,templateFormat:r});return{...t,template:{variables:p,format:r}}},ki=({playgroundStore:n,instanceId:a,credentials:l,datasetId:t})=>({...ls({playgroundStore:n,instanceId:a,credentials:l}),templateFormat:n.getState().templateFormat,datasetId:t});function El(n){if(n===""||typeof n>"u")return"{}";if(typeof n=="string"){const a=n.startsWith('"{')||n.startsWith('"[')||n.startsWith('"\\"');try{if(a){const t=JSON.parse(n),i=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(i,null,2)}}catch{}if(/^\s*[0-9{[]|true|false|null/.test(n))return n}return JSON.stringify(n,null,2)}function ts(n,a){return a.filter(l=>l.required).every(l=>n.some(t=>jn(t,l)))}const ky=n=>{for(const[a,l]of Object.entries(n))if(a.endsWith("DefaultValue")&&l!=null)return n[a]};function Cv(n,a){const l=new Map(n.map(t=>[t.invocationName,t]));return a.forEach(t=>{var c;const i=t.invocationName,r=ky(t),o=Va(t.invocationInputField||"");if(!t.invocationName||!t.invocationInputField||!i||r==null||((c=l.get(i))==null?void 0:c[o])!=null)return;const d={canonicalName:t.canonicalName,invocationName:t.invocationName,[o]:r};l.set(i,d)}),Array.from(l.values())}const is=m.createContext(null);function Fv({children:n,...a}){const[l]=m.useState(()=>Cm(a));return e(is.Provider,{value:l,children:n})}function Pa(n,a){const l=Ie.useContext(is);if(!l)throw new Error("Missing CredentialsContext.Provider in the tree");return Wa(l,n,a)}const rs=m.createContext(null);function by(){const n=m.useContext(rs);if(n===null)throw new Error("useFunctionality must be used within a FunctionalityProvider");return n}function Kv(n){return e(rs.Provider,{value:{authenticationEnabled:window.Config.authenticationEnabled},children:n.children})}const Sy=T`
  display: flex;
  direction: row;
  height: 100vh;
  overflow: hidden;
`,vy=T`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  height: 100%;
  overflow: hidden;
  padding-left: var(--px-nav-collapsed-width);
`,Cy=T`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
`,Fy=T`
  display: flex;
  flex-direction: column;
  margin: 0;
  list-style: none;
  gap: var(--ac-global-dimension-size-50);
  padding-inline-start: 0;
`,Ky=T`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-50);
`;function Tv(){return s("div",{css:Sy,"data-testid":"layout",children:[e(Ty,{}),s("div",{css:vy,children:[e(Km,{children:e(Fm,{})}),e("div",{"data-testid":"content",css:Cy,children:e(m.Suspense,{fallback:e(Ce,{}),children:e(Oe,{})})})]})]})}function Ty(){const n=m.useMemo(()=>window.Config.hasInferences,[]),a=Te(),{authenticationEnabled:l}=by(),t=se(),i=m.useCallback(async()=>{const r=await fetch(Za("/auth/logout"),{method:"POST"});if(r.ok){t("/login");return}a({title:"Logout Failed",message:"Failed to log out: "+r.statusText})},[t,a]);return s(Em,{children:[e(Tm,{}),s(h,{direction:"column",justifyContent:"space-between",flex:"1 1 auto",children:[s("ul",{css:Ky,children:[n&&e("li",{children:e(vn,{to:"/model",text:"Model",leadingVisual:e(_,{svg:e(Pm,{})})})}),e("li",{children:e(vn,{to:"/projects",text:"Projects",leadingVisual:e(_,{svg:e(er,{})})})}),e("li",{children:e(vn,{to:"/datasets",text:"Datasets",leadingVisual:e(_,{svg:e(St,{})})})}),e("li",{children:e(vn,{to:"/playground",text:"Playground",leadingVisual:e(_,{svg:e(pa,{})})})}),e("li",{children:e(vn,{to:"/prompts",text:"Prompts",leadingVisual:e(_,{svg:e(nr,{})})})}),e("li",{children:e(vn,{to:"/apis",text:"APIs",leadingVisual:e(_,{svg:e(kl,{})})})})]}),s("ul",{css:Fy,children:[e("li",{children:e(vn,{to:"/settings",text:"Settings",leadingVisual:e(_,{svg:e(ar,{})})})}),e("li",{children:e(Im,{})}),e("li",{children:e(vn,{to:"/support",text:"Support",leadingVisual:e(_,{svg:e(xm,{})})})}),e("li",{children:e(Dm,{})}),l&&s(H,{children:[e("li",{children:e(vn,{to:"/profile",text:"Profile",leadingVisual:e(_,{svg:e(_m,{})})})}),e("li",{children:e(Lm,{text:"Log Out",leadingVisual:e(_,{svg:e(wm,{})}),onClick:i})})]})]})]})]})}const ss=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptConfigLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsConfigCard_data"}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptConfigLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"3b99248824fdc64b0a16632d83801a44",id:null,metadata:{},name:"promptConfigLoaderQuery",operationKind:"query",text:`query promptConfigLoaderQuery(
  $id: GlobalID!
) {
  prompt: node(id: $id) {
    __typename
    ... on Prompt {
      ...PromptVersionTagsConfigCard_data
    }
    __isNode: __typename
    id
  }
}

fragment PromptVersionTagsConfigCard_data on Prompt {
  id
  versionTags {
    id
    name
    description
    promptVersionId
  }
}
`}}}();ss.hash="2dcab1077c1d7e48736d23d95ce22331";const Pv=async({params:n})=>{const a=n.promptId;if(!a)throw new Error("Prompt ID is required");return await x.fetchQuery(be,ss,{id:a}).toPromise()},os={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptIndexPage__aside",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptLatestVersionsListFragment"},{args:null,kind:"FragmentSpread",name:"EditPromptButton_data"}],type:"Prompt",abstractKey:null};os.hash="a77263d84d9add47173ed2e3d0243952";const ds={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptIndexPage__main",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptChatMessagesCard__main"},{args:null,kind:"FragmentSpread",name:"PromptCodeExportCard__main"},{args:null,kind:"FragmentSpread",name:"PromptModelConfigurationCard__main"}],storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptIndexPage__aside"}],type:"Prompt",abstractKey:null};ds.hash="a883b83f574448623a2b02a60d899d41";const cs={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptModelConfigurationCard__main",selections:[{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptLLM__main"},{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptTools__main"},{args:null,kind:"FragmentSpread",name:"PromptResponseFormatFragment"}],type:"PromptVersion",abstractKey:null};cs.hash="1c4202299f1f881250b17b75244fac54";const us={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptInvocationParameters__main",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null}],type:"PromptVersion",abstractKey:null};us.hash="4f00ab4f0396fffb81a1b068e544cfcf";function Py({keyName:n,value:a}){const{json:l,stringifyError:t}=In(a);return t?null:e(C,{paddingStart:"size-100",paddingEnd:"size-100",children:s(h,{direction:"row",justifyContent:"space-between",children:[e(v,{size:"XS",color:"text-700",children:n}),e(v,{size:"XS",children:l})]})})}function Iy({promptVersion:n}){const{invocationParameters:a}=x.useFragment(us,n),l=m.useMemo(()=>_u(a)?Object.entries(a).map(([t,i])=>({key:t,value:i})):[],[a]);return l.length===0?e(C,{padding:"size-200",children:e(h,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No parameters saved for this prompt"})})}):e(pl,{listSize:"small",children:l.map(({key:t,value:i},r)=>e(ml,{children:e(Py,{keyName:t,value:i})},`${t}-${r}`))})}const ms={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLLM__main",selections:[{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null}],type:"PromptVersion",abstractKey:null};ms.hash="acc90da43126218472d2fc19cd8d0512";const bi=({keyName:n,children:a})=>e(ml,{listSize:"small",children:e(C,{paddingStart:"size-100",paddingEnd:"size-100",children:s(h,{direction:"row",justifyContent:"space-between",children:[e(v,{size:"XS",color:"text-700",children:n}),e(v,{size:"XS",children:a})]})})});function xy({promptVersion:n}){const a=x.useFragment(ms,n);return s(me,{id:"llm",children:[e(ce,{children:"LLM"}),e(ue,{children:s(pl,{listSize:"small",children:[e(bi,{keyName:"Model",children:a.model}),e(bi,{keyName:"Provider",children:at[a.provider]??a.provider})]})})]})}const ps={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptResponseFormatFragment",selections:[{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};ps.hash="154d745ec5e978e0dfc811ebfb9faa8c";function Dy({promptVersion:n}){const{responseFormat:a}=x.useFragment(ps,n),l=m.useMemo(()=>typeof(a==null?void 0:a.definition)=="string"?In(we(a==null?void 0:a.definition).json||"",null,2).json||"":In(a==null?void 0:a.definition,null,2).json||"",[a==null?void 0:a.definition]);return l?s(me,{id:"response-format",children:[e(ce,{children:"Response Format"}),e(ue,{children:e(Je,{value:l})})]}):s(me,{id:"response-format",children:[e(ce,{children:"Response Format"}),e(ue,{children:e(C,{padding:"size-200",children:e(h,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No response format specified for this prompt"})})})})]})}const gs={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptTools__main",selections:[{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};gs.hash="aa512d962d83a58b70ae0e17f01242b3";function _y({promptVersion:n}){const{tools:a}=x.useFragment(gs,n),l=m.useMemo(()=>a.map((t,i)=>{const r=t.definition;return{name:Mm(r)||`Tool ${i+1}`,description:Vm(r)||void 0,definition:In(r,null,2).json||"{}"}}),[a]);return l.length===0?s(me,{id:"tools",children:[e(ce,{children:"Tools"}),e(ue,{children:e(C,{padding:"size-200",children:e(h,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No tools specified for this prompt"})})})})]}):s(h,{direction:"column",children:[e(Rm,{bordered:!1,children:"Tools"}),e(Ye,{css:T`
          & {
            > .ac-disclosure:last-child {
              &[data-expanded="true"] {
                border-bottom: 1px solid var(--ac-global-border-color-default);
              }
            }
          }
        `,children:l.map((t,i)=>s(me,{id:`tool-${i}`,children:[s(ce,{arrowPosition:"start",justifyContent:"space-between",children:[e(v,{children:t.name}),e(v,{children:t.description})]}),e(ue,{children:e(Je,{value:t.definition})})]},`${t.name}-${i}`))})]})}function ys({promptVersion:n}){const a=x.useFragment(cs,n);return e(O,{title:"Model Configuration",variant:"compact",bodyStyle:{padding:0},collapsible:!0,children:s(Ye,{defaultExpandedKeys:["llm","invocation-parameters","tools","response-format"],children:[e(xy,{promptVersion:a}),s(me,{id:"invocation-parameters",children:[e(ce,{children:"Invocation Parameters"}),e(ue,{children:e(Iy,{promptVersion:a})})]}),e(_y,{promptVersion:a}),e(Dy,{promptVersion:a})]})})}const fs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditPromptButtonPatchPromptMutation",selections:[{alias:null,args:a,concreteType:"Prompt",kind:"LinkedField",name:"patchPrompt",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptIndexPage__main"}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditPromptButtonPatchPromptMutation",selections:[{alias:null,args:a,concreteType:"Prompt",kind:"LinkedField",name:"patchPrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[t,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},i],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:o,storageKey:null},{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},d,{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[r,d,{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[r,i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"},r],storageKey:null}]},params:{cacheID:"a0e00e13cb2441248615b9d8966a918f",id:null,metadata:{},name:"EditPromptButtonPatchPromptMutation",operationKind:"mutation",text:`mutation EditPromptButtonPatchPromptMutation(
  $input: PatchPromptInput!
) {
  patchPrompt(input: $input) {
    ...PromptIndexPage__main
  }
}

fragment EditPromptButton_data on Prompt {
  id
  description
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptIndexPage__aside on Prompt {
  description
  ...PromptLatestVersionsListFragment
  ...EditPromptButton_data
}

fragment PromptIndexPage__main on Prompt {
  promptVersions {
    edges {
      node {
        ...PromptInvocationParameters__main
        ...PromptChatMessagesCard__main
        ...PromptCodeExportCard__main
        ...PromptModelConfigurationCard__main
      }
    }
  }
  ...PromptIndexPage__aside
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptLatestVersionsListFragment on Prompt {
  latestVersions: promptVersions(first: 5) {
    edges {
      version: node {
        id
        description
        createdAt
        sequenceNumber
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();fs.hash="3ce25c8fbe5598ec1ee037a9778a6957";const hs={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EditPromptButton_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null}],type:"Prompt",abstractKey:null};hs.hash="24788aacf7830c0e5037befe576f4968";function Ly(n){const[a,l]=m.useState(!1),t=Se(),i=Te(),r=x.useFragment(hs,n.prompt),[o,d]=x.useMutation(fs),{control:c,handleSubmit:p}=Ae({defaultValues:{description:r.description??""}}),y=m.useCallback(u=>{o({variables:{input:{promptId:r.id,description:u.description}},onCompleted:()=>{l(!1),t({title:"Prompt updated",message:"The prompt has been updated successfully"})},onError:g=>{var f;i({title:"Error updating prompt",message:(f=Pe(g))==null?void 0:f[0]})}})},[r.id,o,i,t]);return s(dt,{isOpen:a,onOpenChange:l,children:[e(M,{size:"S",leadingVisual:e(_,{svg:e(ar,{})}),variant:"quiet","aria-label":"configure prompt",onPress:()=>l(!0)}),e(Am,{size:"S",isDismissable:!0,children:s(ot,{children:[e(te,{slot:"title",children:"Edit Prompt Details"}),s(Xe,{children:[e(C,{padding:"size-200",children:e(G,{name:"description",control:c,render:({field:u})=>s(J,{value:u.value,onChange:u.onChange,children:[e(W,{children:"Prompt Description"}),e(ca,{placeholder:"Enter a description for the prompt"}),e(v,{slot:"description",children:"A description of the prompt"})]})})}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",gap:"size-100",justifyContent:"end",children:[e(M,{slot:"close",size:"S",children:"Cancel"}),e(M,{variant:"primary",size:"S",isDisabled:d,onPress:()=>p(y)(),children:d?"Saving...":"Save"})]})})]})]})})]})}const ks=function(){var n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptChatMessagesCard__main",selections:[{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[a,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null}],type:"PromptVersion",abstractKey:null}}();ks.hash="e0d9c12926330e5e774cbc64de158a82";const $t=L.object({text:L.object({text:L.string()})}),Ot=L.object({toolCall:L.object({toolCallId:L.string(),toolCall:L.object({name:L.string(),arguments:L.string()})})}),Qt=L.object({toolResult:L.object({toolCallId:L.string(),result:ht})}),Vl=n=>{const a=$t.safeParse(n);return a.success?a.data:null},bs=n=>{const a={text:{text:n}},l=$t.safeParse(a);return l.success?l.data:null},jt=n=>{const a=Ot.safeParse(n);return a.success?a.data:null},Ss=n=>{const a=Nm(n),l=zm(n),t=$m(n);if(!a)return null;const i=In(t).json||"",r={toolCall:{toolCallId:a,toolCall:{name:l||a,arguments:i}}},o=Ot.safeParse(r);return o.success?o.data:null},qt=n=>{const a=Qt.safeParse(n);return a.success?a.data:null},vs=(n,a)=>{const l={toolResult:{toolCallId:n,result:a}},t=Qt.safeParse(l);return t.success?t.data:null};function nl(n){return m.useMemo(()=>{const a=n.toLowerCase();return a==="user"||a==="human"?{backgroundColor:"grey-200",borderColor:"grey-500"}:a==="assistant"||a==="ai"?{backgroundColor:"blue-100",borderColor:"blue-700"}:a==="system"||a==="developer"?{backgroundColor:"indigo-100",borderColor:"indigo-700"}:["function","tool"].includes(a)?{backgroundColor:"yellow-100",borderColor:"yellow-700"}:{backgroundColor:"grey-100",borderColor:"grey-700"}},[n])}const Ml={text:"Text",toolCall:"Tool Call",toolResult:"Tool Result"},wy=Object.values(Ml);function Ey({toolResult:n,isOnlyChild:a}){const l=m.useMemo(()=>{const t=n.toolResult.result;return El(t)},[n]);return e(Ut,{title:Ml.toolResult,isOnlyChild:a,children:s(h,{direction:"column",children:[e(C,{paddingX:"size-200",paddingTop:"size-100",children:s(h,{direction:"column",justifyContent:"start",gap:"size-100",children:[e(v,{weight:"heavy",size:"XS",children:"Tool ID"}),e(C,{paddingX:"size-300",children:e(v,{size:"XS",children:n.toolResult.toolCallId})})]})}),s(h,{direction:"column",children:[e(C,{paddingX:"size-200",paddingTop:"size-100",children:e(v,{weight:"heavy",size:"XS",children:"Tool Result"})}),e(bl,{readOnly:!0,children:e(Sl,{readOnly:!0,height:"100%",defaultValue:l,templateFormat:We.NONE})})]})]})})}function Vy({provider:n,toolCall:a,isOnlyChild:l}){const t=m.useMemo(()=>{const i=lr(a,n);return In(i,null,2).json||""},[n,a]);return e(Ut,{title:Ml.toolCall,isOnlyChild:l,children:e(bl,{readOnly:!0,children:e(Sl,{readOnly:!0,height:"100%",defaultValue:t,templateFormat:We.NONE})})})}function My(n){const{text:a,templateFormat:l,isOnlyChild:t}=n;return e(Ut,{title:Ml.text,isOnlyChild:t,children:e(bl,{readOnly:!0,children:e(Sl,{readOnly:!0,height:"100%",defaultValue:a,templateFormat:l})})})}function Ut({title:n,children:a,isOnlyChild:l}){return l?e(H,{children:a}):s(me,{id:n,children:[e(ce,{children:e(v,{weight:"heavy",size:"S",children:n})}),e(ue,{children:a})]})}function Ry(n){const{role:a,children:l}=n,t=nl(a);return e(O,{title:a,variant:"compact",...t,bodyStyle:{padding:0},collapsible:!0,children:e(Ye,{defaultExpandedKeys:wy,children:l})})}function Ay({promptVersion:n}){const{template:a,templateFormat:l,provider:t}=x.useFragment(ks,n);if(a.__typename==="PromptStringTemplate")return e(v,{children:a.template});if(a.__typename==="PromptChatTemplate")return e(zy,{template:a,templateFormat:l,provider:Yr(t)||Yi});if(a.__typename==="%other")throw new Error("Unknown template type"+a.__typename)}function Ny({part:n,templateFormat:a,provider:l,isOnlyChild:t}){let i=Vl(n);return i?e(My,{text:i.text.text,templateFormat:a,isOnlyChild:t}):(i=jt(n),i?e(Vy,{toolCall:i,provider:l,isOnlyChild:t}):(i=qt(n),i?e(Ey,{toolResult:i,isOnlyChild:t}):null))}function zy({template:n,templateFormat:a,provider:l}){const{messages:t}=n;return e(h,{direction:"column",gap:"size-100","data-testid":"chat-messages",children:t.map((i,r)=>{const o=i.content.length===1&&i.content.find(Vl)!=null;return e(Ry,{role:i.role,children:i.content.map((d,c)=>e(Ny,{part:d,templateFormat:a,provider:l,isOnlyChild:o},`${c}-${d.__typename}`))},r)})})}function Cs({title:n="Prompt",promptVersion:a}){return e(O,{title:n,variant:"compact",collapsible:!0,"data-testid":"prompt-chat-messages-card",children:e(Ay,{promptVersion:a})})}const Fs=function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptCodeExportCard__main",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:n,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[l,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null}],type:"PromptVersion",abstractKey:null}}();Fs.hash="3fa95713c234bb0cfa4c36e8e4f9cea0";const $y=L.enum(["system","user","assistant","developer","tool","function"]),Rl=L.object({role:$y,content:L.string().nullable(),name:L.string().optional(),tool_call_id:L.string().optional(),tool_calls:L.array(Om).optional()}).passthrough(),Oy=L.array(Rl);ul(Oy,{removeAdditionalStrategy:"passthrough"});const Qy=L.enum(["user","assistant","tool"]),jy=Qm.extend({type:L.string(),text:L.string().optional(),id:L.string().optional(),tool_use_id:L.string().optional(),name:L.string().optional(),input:L.record(L.unknown()).optional(),source:L.object({type:L.string(),media_type:L.string().optional(),data:L.string().optional()}).optional()}),Ks=L.object({role:Qy,content:L.union([L.string(),L.array(jy)])}),qy=L.array(Ks);ul(qy,{removeAdditionalStrategy:"passthrough"});const Uy=L.enum(["SYSTEM","USER","AI","TOOL"]),By=L.object({image:L.object({url:L.string()})}),Hy=L.discriminatedUnion("__typename",[$t.extend({__typename:L.literal("TextContentPart")}),By.extend({__typename:L.literal("ImageContentPart")}),Ot.extend({__typename:L.literal("ToolCallContentPart")}),Qt.extend({__typename:L.literal("ToolResultContentPart")})]),Al=L.object({role:Uy,content:L.array(Hy)}).passthrough(),Gy=L.array(Al);ul(Gy,{removeAdditionalStrategy:"passthrough"});const Ts=Rl.transform(n=>{const a={role:n.role==="assistant"?"assistant":"user",content:n.content?[{type:"text",text:n.content}]:[]};return n.tool_calls?{...a,content:[...a.content,...n.tool_calls.map(l=>jm.parse(l))]}:n.tool_call_id?{...a,content:[{type:"tool_result",tool_use_id:n.tool_call_id,content:n.content}]}:a}),Ps=Al.transform(n=>{if(n.role==="TOOL"){const t=n.content.map(i=>qt(i)).find(i=>!!i);if(!t)throw new Error("TOOL role message must have a ToolResultContentPart");return{role:"tool",content:El(t.toolResult.result),tool_call_id:t.toolResult.toolCallId}}const a={role:{SYSTEM:"system",USER:"user",AI:"assistant",TOOL:"tool"}[n.role],content:n.content.map(t=>Vl(t)).filter(t=>!!t).map(t=>t.text.text).join(`
`)},l=n.content.map(t=>jt(t)).filter(t=>!!t).map(t=>({id:t.toolCall.toolCallId,type:"function",function:{name:t.toolCall.toolCall.name,arguments:typeof t.toolCall.toolCall.arguments=="string"?JSON.parse(t.toolCall.toolCall.arguments):t.toolCall.toolCall.arguments}}));return l.length>0?{...a,tool_calls:l}:a});Rl.transform(n=>{const a=[];if(n.role==="tool"&&n.tool_call_id){const t=vs(n.tool_call_id,n.content);return t&&a.push({__typename:"ToolResultContentPart",...t}),{role:"TOOL",content:a}}if(n.content){const t=bs(n.content);t&&a.push({__typename:"TextContentPart",...t})}return n.tool_calls&&n.tool_calls.forEach(t=>{const i=Ss({id:t.id,name:t.function.name,arguments:t.function.arguments});i&&a.push({__typename:"ToolCallContentPart",...i})}),{role:{system:"SYSTEM",user:"USER",assistant:"AI",tool:"TOOL",developer:"SYSTEM",function:"TOOL"}[n.role],content:a}});const Wy=({message:n,targetProvider:a})=>{switch(a){case"AZURE_OPENAI":case"OPENAI":return n;case"ANTHROPIC":return Ts.parse(n);case"GOOGLE":return n;default:return ke()}};L.union([Rl,Ks,Al,ht]);Al.transform(n=>Ts.parse(Ps.parse(n)));const pn="  ",rl=({json:n,level:a,removeKeyQuotes:l=!1})=>{const t=pn.repeat(a);let i=JSON.stringify(n,null,pn);return i=i.split(`
`).map((r,o)=>o>0?t+r:r).join(`
`),l&&(i=i.replace(/"([a-zA-Z_$][a-zA-Z0-9_$]*)"\s*:/g,"$1:")),i},Jy=cn.template(`
from openai import OpenAI

client = OpenAI()

messages=<%= messages %>
# ^ apply additional templating to messages if needed

completion = client.chat.completions.create(
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>)

print(completion.choices[0].message)
`.trim()),Zy=cn.template(`
import OpenAI from "openai";

const openai = new OpenAI();

const messages = <%= messages %>;
// ^ apply additional templating to messages if needed

const response = openai.chat.completions.create({
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>});

response.then((completion) => console.log(completion.choices[0].message));
`.trim()),Xy=cn.template(`
from openai import OpenAI
from phoenix.client import Client

prompt = Client().prompts.get(prompt_version_id="<%= versionId %>")

# Format the prompt template with the appropriate variables
response = OpenAI().chat.completions.create(**prompt.format(variables={ "variable": "value" }))
print(response.choices[0].message.content)
  `.trim()),Yy=cn.template(`
from openai import OpenAI;
import { Client } from "@arizeai/phoenix-client";
import { toSDK, getPrompt } from "@arizeai/phoenix-client/prompts";

const client = new Client();
const openai = new OpenAI();

const prompt = await getPrompt({
  client,
  prompt: {
    versionId: "<%= versionId %>",
  },
});

const openAIParams = toSDK({
  prompt,
  sdk: "openai",
  // Apply the prompt template variables
  variables: {
    key: "value",
  },
});

const response = await openai.chat.completions.create({
  ...openAIParams,
});

console.log(response.choices[0]?.message.content);
`.trim()),ef=cn.template(`
from anthropic import Anthropic

client = Anthropic()

messages=<%= messages %>
# ^ apply additional templating to messages if needed

completion = client.messages.create(
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>)

print(completion.content)
`.trim()),nf=cn.template(`
import Anthropic from "@anthropic-ai/sdk";

const client = new Anthropic();

const messages = <%= messages %>;
// ^ apply additional templating to messages if needed

const response = await client.messages.create({
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>});

console.log(response.content);
`.trim()),af=cn.template(`
from anthropic import Anthropic
from phoenix.client import Client

prompt = Client().prompts.get(prompt_version_id="<%= versionId %>")
# Format the prompt template with the appropriate variables
resp = Anthropic().messages.create(**prompt.format(variables={ "variable": "value" }))
  `.trim()),lf=cn.template(`
import Anthropic from "@anthropic-ai/sdk";
import { Client } from "@arizeai/phoenix-client";
import { toSDK, getPrompt } from "@arizeai/phoenix-client/prompts";

const client = new Client();
const anthropic = new Anthropic();

const prompt = await getPrompt({
  client,
  prompt: {
    versionId: "<%= versionId %>",
  },
});

const anthropicParams = toSDK({
  prompt,
  sdk: "anthropic",
  // Apply the prompt template variables
  variables: {
    key: "value",
  },
});

const response = await anthropic.messages.create({
  ...anthropicParams,
});

console.log(response.content);
`.trim()),zn={python:{openai:{assignmentOperator:"=",removeKeyQuotes:!1,stringQuote:'"',sdkTemplate:Jy,clientTemplate:Xy},anthropic:{assignmentOperator:"=",removeKeyQuotes:!1,stringQuote:'"',sdkTemplate:ef,clientTemplate:af}},typescript:{openai:{assignmentOperator:": ",removeKeyQuotes:!0,stringQuote:'"',sdkTemplate:Zy,clientTemplate:Yy},anthropic:{assignmentOperator:": ",removeKeyQuotes:!0,stringQuote:'"',sdkTemplate:nf,clientTemplate:lf}}},sl=(n,a)=>{if(!("messages"in n.template))throw new Error("Prompt template does not contain messages");const l=[],{assignmentOperator:t,removeKeyQuotes:i,stringQuote:r}=a;if(n.modelName&&l.push(`model${t}${r}${n.modelName}${r}`),n.invocationParameters){const d=Object.entries(n.invocationParameters).map(([c,p])=>typeof p=="string"?`${c}${t}${r}${p}${r}`:kt(p)?`${c}${t}${rl({json:p,level:1,removeKeyQuotes:i})}`:`${c}${t}${p}`);l.push(...d)}let o="";if(n.template.messages.length>0&&(o=rl({json:n.template.messages,level:0,removeKeyQuotes:i}),l.push(t==="="?"messages=messages":"messages")),n.tools&&n.tools.length>0){const d=rl({json:n.tools.map(c=>c.definition),level:1,removeKeyQuotes:i});l.push(`tools${t}${d}`)}if(n.responseFormat&&"definition"in n.responseFormat){const d=rl({json:n.responseFormat.definition,level:1,removeKeyQuotes:i});l.push(`response_format${t}${d}`)}return{args:l,messages:o}},Si=n=>"tool_calls"in n&&n.tool_calls?{...n,tool_calls:n.tool_calls.map(a=>({...a,function:{...a.function,arguments:JSON.stringify(a.function.arguments)}}))}:n,tf={python:{openai:n=>{const a=zn.python.openai,l={...n,template:{...n.template,messages:n.template.messages.map(r=>Si(r))}},{args:t,messages:i}=sl(l,a);return a.sdkTemplate({tab:pn,args:t,messages:i})},anthropic:n=>{const a=zn.python.anthropic,{args:l,messages:t}=sl(n,a);return a.sdkTemplate({tab:pn,args:l,messages:t})}},typescript:{openai:n=>{const a=zn.typescript.openai,l={...n,template:{...n.template,messages:n.template.messages.map(r=>Si(r))}},{args:t,messages:i}=sl(l,a);return a.sdkTemplate({tab:pn,args:t,messages:i})},anthropic:n=>{const a=zn.typescript.anthropic,{args:l,messages:t}=sl(n,a);return a.sdkTemplate({tab:pn,args:l,messages:t})}}},rf={python:{openai:n=>zn.python.openai.clientTemplate({tab:pn,versionId:n.versionId}),anthropic:n=>zn.python.openai.clientTemplate({tab:pn,versionId:n.versionId})},typescript:{openai:n=>zn.typescript.openai.clientTemplate({tab:pn,versionId:n.versionId}),anthropic:n=>zn.typescript.anthropic.clientTemplate({tab:pn,versionId:n.versionId})}},sf=({promptVersion:n,language:a})=>{var i;const l=tf[a.toLocaleLowerCase()][(i=n.modelProvider)==null?void 0:i.toLocaleLowerCase()];if(!l||!("messages"in n.template))return null;const t={...n,template:{...n.template,messages:n.template.messages.map(r=>{try{return Wy({message:Ps.parse(r),targetProvider:n.modelProvider})}catch(o){return console.warn("Cannot convert message"),console.error(o),null}}).filter(Boolean)}};return l(t)};function of({promptVersion:n,language:a}){var i;const l=rf[a.toLocaleLowerCase()][(i=n.modelProvider)==null?void 0:i.toLocaleLowerCase()];if(!l)return null;const t={versionId:n.id};return l(t)}function Is({promptVersion:n}){const[a,l]=m.useState("Python"),t=x.useFragment(Fs,n),i=m.useMemo(()=>sf({promptVersion:t,language:a}),[t,a]),r=m.useMemo(()=>of({promptVersion:t,language:a}),[t,a]);return e(O,{title:"Code",variant:"compact",bodyStyle:{padding:0},extra:e(h,{gap:"size-100",alignItems:"center",children:e(vl,{language:a,onChange:l})}),children:s(Ye,{defaultExpandedKeys:["sdk-inline","client"],children:[s(me,{id:"sdk-inline",children:[e(ce,{arrowPosition:"start",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",width:"100%",children:[e(v,{children:"SDK Inline"}),i?e(re,{text:i}):null]})}),e(ue,{children:e(C,{padding:"size-100",children:i==null?e(C,{width:"100%",padding:"size-200",children:e(v,{color:"text-300",children:"No code snippet available for this prompt"})}):e(vi,{language:a,value:i})})})]}),s(me,{id:"client",children:[e(ce,{arrowPosition:"start",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",width:"100%",gap:"size-100",children:[e(v,{children:"Using the Client"}),r?e(re,{text:r}):null]})}),e(ue,{children:e(C,{padding:"size-100",children:r==null?e(C,{width:"100%",padding:"size-200",children:e(v,{color:"text-300",children:"No client code snippet available for this prompt"})}):e(vi,{language:a,value:r})})})]})]})})}function vi({language:n,value:a}){switch(n){case"Python":return e(tr,{value:a,basicSetup:{lineNumbers:!0}});case"TypeScript":return e(qm,{value:a,basicSetup:{lineNumbers:!0}});default:ke()}}const xs={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLatestVersionsListFragment",selections:[{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionSummaryFragment"}],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"}],type:"Prompt",abstractKey:null};xs.hash="a473a6f0d927379542694312449a4c63";const Ds=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionSummaryFragment",selections:[n,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"}],type:"PromptVersion",abstractKey:null}}();Ds.hash="80901eff49852a413f643ee876638174";const _s={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionTagsList_data",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};_s.hash="25265fbc7ea915534615a56b4331236e";function Ls({promptVersion:n}){const a=x.useFragment(_s,n);return e(h,{direction:"row",gap:"size-50",alignItems:"center",wrap:"wrap",children:a.tags.map(l=>e(df,{children:l.name},l.id))})}function df({children:n}){const a=m.useMemo(()=>{switch(n){case"production":return"green-1000";case"staging":return"yellow-1000";case"development":return"blue-1000";default:return"grey-900"}},[n]);return e(va,{color:a,children:n})}function ws(n){const a=x.useFragment(Ds,n.promptVersion);return s(h,{direction:"column",gap:"size-50",children:[e(C,{width:"100%",children:e(h,{direction:"row",justifyContent:"space-between",alignItems:"center",width:"100%",children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(va,{color:"blue-1000",children:a.sequenceNumber}),e("span",{children:a.id})]})})}),e(C,{"data-testid":"prompt-version-item-description",paddingStart:"size-400",children:s(h,{direction:"column",gap:"size-100",children:[e(ir,{maxWidth:"100%",children:e(v,{color:"text-700",size:"XS",children:a.description||"No Description"})}),s(h,{justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(Ls,{promptVersion:a}),s(h,{direction:"row",gap:"size-100",alignItems:"center",flex:"none",children:[a.user&&s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(vt,{size:14,name:a.user.username,profilePictureUrl:a.user.profilePictureUrl}),e(v,{size:"XS",children:a.user.username})]}),e(v,{color:"text-300",size:"XS",children:Lu(a.createdAt,Date.now())})]})]})]})})]})}const cf=5,uf=T`
  padding-bottom: var(--ac-global-dimension-size-200);
  position: relative;
`;function mf(n){const{prompt:a}=n,l=x.useFragment(xs,a),t=m.useMemo(()=>{var i,r;return(r=(i=l==null?void 0:l.latestVersions)==null?void 0:i.edges)==null?void 0:r.map(o=>o.version)},[l]);if(!t)throw new Error("Expected prompt versions to be defined");return s("div",{children:[e("ul",{children:t.map((i,r)=>{const o=r===cf-1;return s("li",{css:uf,children:[e(ws,{promptVersion:i}),i.sequenceNumber!=1?e(gf,{isLastConnector:o}):null]},i.id)})}),e(h,{direction:"row",justifyContent:"end",children:e(Qe,{to:"versions",children:"View all versions"})})]})}const pf=T`
  position: absolute;
  top: 25px;
  left: 11px;
  height: calc(100% - 32px);
  width: 2px;
  --connector-color: var(--ac-global-color-grey-400);
  background: repeating-linear-gradient(
      to bottom,
      transparent 0 4px,
      var(--ac-global-color-grey-50) 4px 8px
    ),
    var(--connector-color);
  background-size: 4px 100%;
  background-position: 80%;
  background-repeat: no-repeat;
  &[data-last="true"] {
    background: repeating-linear-gradient(
        to bottom,
        transparent 0 4px,
        var(--ac-global-color-grey-50) 4px 8px
      ),
      linear-gradient(to bottom, var(--connector-color), transparent);
  }
`;function gf({isLastConnector:n}){return e("div",{css:pf,"data-last":n})}const Bt=()=>{const a=wu().find(l=>l.pathname.split("/prompts/").length===2);if(!a)throw new Error("usePromptIdLoader must be used within a /prompts/:promptId route");return Eu(a.id)};function Iv(){const n=Bt();return e(yf,{prompt:n.prompt})}function yf({prompt:n}){var t,i,r;const a=x.useFragment(ds,n),l=(r=(i=(t=a==null?void 0:a.promptVersions)==null?void 0:t.edges)==null?void 0:i[0])==null?void 0:r.node;return s(h,{direction:"row",height:"100%",children:[e(C,{height:"100%",overflow:"auto",width:"100%","data-testid":"scroll-container",children:e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-200",marginStart:"auto",marginEnd:"auto",maxWidth:900,children:[e(Cs,{title:"Prompt Template",promptVersion:l}),e(ys,{promptVersion:l}),e(Is,{promptVersion:l})]})})}),e(ff,{prompt:a})]})}function ff({prompt:n}){const a=x.useFragment(os,n),l=!!(a!=null&&a.description);return e(C,{flex:"none",width:400,borderStartColor:"dark",borderStartWidth:"thin",children:s(C,{paddingStart:"size-200",paddingEnd:"size-200",children:[s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(li,{level:3,children:"Description"}),e(Ly,{prompt:a})]}),e(v,{color:l?"text-900":"text-700",children:a.description||"No Description"}),s("section",{children:[e(li,{level:3,children:"Latest Versions"}),e(mf,{prompt:a})]})]})})}const Es=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLayout__main",selections:[n,a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"sourcePrompt",plural:!1,selections:[n,a],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[n],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}}();Es.hash="3f2a7eb87a4a433362def455a9151d45";const Vs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"clonePrompt",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ClonePromptDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ClonePromptDialogMutation",selections:a},params:{cacheID:"6ad0382f6acd0f00125307c887c0f4f2",id:null,metadata:{},name:"ClonePromptDialogMutation",operationKind:"mutation",text:`mutation ClonePromptDialogMutation(
  $input: ClonePromptInput!
) {
  clonePrompt(input: $input) {
    id
  }
}
`}}}();Vs.hash="081b8cf05c35b46579fe5cbb85f7a761";const hf=({promptId:n,promptName:a,promptDescription:l,setDialog:t})=>{var b;const i=Se(),r=se(),[o,d]=x.useMutation(Vs),c=Ae({disabled:d,reValidateMode:"onBlur",mode:"onChange",defaultValues:{name:`${a}-clone`,description:l}}),{control:p,handleSubmit:y,formState:{isValid:u,errors:g},setError:f}=c,k=y(S=>{o({variables:{input:{promptId:n,name:S.name,description:S.description}},onCompleted:F=>{t(null),i({title:"Prompt cloned successfully",action:{text:"View Prompt",onClick:()=>{r(`/prompts/${F.clonePrompt.id}`)}}})},onError:F=>{var D;const P=Pe(F);(D=P==null?void 0:P[0])!=null&&D.includes("already exists")?f("name",{message:P==null?void 0:P[0]}):f("root",{message:P==null?void 0:P[0]})}})});return e(X,{title:"Clone Prompt",children:e(m.Suspense,{fallback:e(Ce,{}),children:e(C,{padding:"size-200",children:s("form",{onSubmit:k,children:[e(G,{control:p,name:"name",rules:{required:{message:"Name is required",value:!0},validate:{unique:S=>S.trim()===a.trim()?"Name must be different from the original prompt name":!0}},render:({field:{onChange:S,onBlur:F,value:P,disabled:D},fieldState:{error:w}})=>s(J,{isInvalid:!!(w!=null&&w.message),children:[e(W,{children:"Name"}),e(ae,{name:"name",type:"text",onChange:S,onBlur:F,value:P,disabled:D}),!w&&e(v,{slot:"description",children:"A name for the cloned prompt."}),e(Fe,{children:w==null?void 0:w.message})]})}),e(G,{control:p,name:"description",render:({field:{onChange:S,onBlur:F,value:P,disabled:D},fieldState:{error:w}})=>s(J,{isInvalid:!!(w!=null&&w.message),isDisabled:D,value:P,onChange:S,onBlur:F,children:[e(W,{children:"Description"}),e(ca,{name:"description"}),!w&&e(v,{slot:"description",children:"A description for the cloned prompt."}),e(Fe,{children:w==null?void 0:w.message})]})}),(g==null?void 0:g.root)&&e(v,{color:"danger",children:(b=g==null?void 0:g.root)==null?void 0:b.message}),s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{variant:"default",onPress:()=>t(null),isDisabled:d,children:"Cancel"}),e(M,{type:"submit",variant:"primary",isDisabled:!u,isPending:d,children:"Clone"})]})]})})})})},kf=T`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function xv(){const[n,a]=m.useState(null),l=Bt(),t=se(),{pathname:i}=Ui();let r=0;i.includes("versions")?r=1:i.includes("config")&&(r=2);const o=x.useFragment(Es,l.prompt);return s("main",{css:kf,children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[s(h,{direction:"column",children:[e(te,{level:1,children:l.prompt.name}),o.sourcePrompt&&s(v,{color:"text-700",children:["cloned from"," ",e(Qe,{to:`/prompts/${o.sourcePrompt.id}`,children:o.sourcePrompt.name})]})]}),s(h,{direction:"row",gap:"size-100",children:[e(M,{size:"S",leadingVisual:e(_,{svg:e(Um,{})}),onPress:()=>{a(e(hf,{promptId:o.id,promptName:o.name,promptDescription:o.description??void 0,setDialog:a}))},children:"Clone"}),e(M,{size:"S",leadingVisual:e(_,{svg:e(Ct,{})}),onPress:()=>{t(`/prompts/${l.prompt.id}/playground`)},children:"Edit in Playground"})]})]})}),s(He,{index:r,onChange:d=>{let c;d===1?c=`/prompts/${l.prompt.id}/versions`:d===2?c=`/prompts/${l.prompt.id}/config`:c=`/prompts/${l.prompt.id}`,t(c)},children:[e(ne,{name:"Prompt",children:e(Oe,{})}),e(ne,{name:"Versions",extra:e(un,{children:o.promptVersions.edges.length}),children:e(Oe,{})}),e(ne,{name:"Config",children:e(Oe,{})})]}),e(Y,{onDismiss:()=>a(null),children:n})]})}const Ms=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"modelsInput"}],a={alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null},l={alias:"floatDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"modelsInput"}],concreteType:null,kind:"LinkedField",name:"modelInvocationParameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"required",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:[{alias:"booleanDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a,{alias:null,args:null,kind:"ScalarField",name:"minValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxValue",storageKey:null}],type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a],type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"intDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"jsonDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringListDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringListInvocationParameter",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",selections:t},params:{cacheID:"530366c9a8cc3b47d685ca0600a39bb5",id:null,metadata:{},name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",operationKind:"query",text:`query fetchPlaygroundPromptSupportedInvocationParametersQuery(
  $modelsInput: ModelsInput!
) {
  modelInvocationParameters(input: $modelsInput) {
    __typename
    ... on InvocationParameterBase {
      __isInvocationParameterBase: __typename
      invocationName
      canonicalName
      required
      label
    }
    ... on BooleanInvocationParameter {
      booleanDefaultValue: defaultValue
      invocationInputField
    }
    ... on BoundedFloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
      minValue
      maxValue
    }
    ... on FloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
    }
    ... on IntInvocationParameter {
      intDefaultValue: defaultValue
      invocationInputField
    }
    ... on JSONInvocationParameter {
      jsonDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringInvocationParameter {
      stringDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringListInvocationParameter {
      stringListDefaultValue: defaultValue
      invocationInputField
    }
  }
}
`}}}();Ms.hash="1138fb98386e86196eaa52c12a6bb27c";const Rs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"id",variableName:"promptId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},p={alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[l,r,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[d,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[d,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[c,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[c,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:o,storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"fetchPlaygroundPromptQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t,i,r,p],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"fetchPlaygroundPromptQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[t,i,r,p],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"9beefbb59de3e9b98d785c3fd78b15d5",id:null,metadata:{},name:"fetchPlaygroundPromptQuery",operationKind:"query",text:`query fetchPlaygroundPromptQuery(
  $promptId: GlobalID!
) {
  prompt: node(id: $promptId) {
    __typename
    ... on Prompt {
      id
      name
      createdAt
      description
      version {
        id
        description
        modelName
        modelProvider
        invocationParameters
        templateType
        templateFormat
        responseFormat {
          definition
        }
        template {
          __typename
          ... on PromptChatTemplate {
            messages {
              role
              content {
                __typename
                ... on TextContentPart {
                  text {
                    text
                  }
                }
                ... on ToolCallContentPart {
                  toolCall {
                    toolCallId
                    toolCall {
                      name
                      arguments
                    }
                  }
                }
                ... on ToolResultContentPart {
                  toolResult {
                    toolCallId
                    result
                  }
                }
              }
            }
          }
        }
        tools {
          definition
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Rs.hash="84755f12352e245574192de304d654d5";const bf=n=>{switch(n){case"user":return"USER";case"ai":return"AI";case"system":return"SYSTEM";case"tool":return"TOOL";default:return"USER"}},Sf=(n,a)=>{const l=a.length>0?a.reduce((t,i)=>(i.invocationName&&(t[i.invocationName]=i),t),{}):{};return Object.entries(n).map(([t,i])=>{const r=l[t];return!r||!r.invocationInputField?{invocationName:t,valueJson:i}:{invocationName:t,canonicalName:r.canonicalName,[Va(r.invocationInputField)]:i}})},vf=({promptId:n,promptName:a,promptVersion:l,supportedInvocationParameters:t})=>{var c,p;const i={...Bm(),prompt:{id:n,name:a}},r=l.modelName,o=l.modelProvider,d=bt({toolChoice:(c=l.invocationParameters)==null?void 0:c.tool_choice,targetProvider:o})??void 0;return{...i,model:{...i.model,modelName:r,provider:o,supportedInvocationParameters:t||[],invocationParameters:Sf({...l.invocationParameters,...(p=l.responseFormat)!=null&&p.definition?{response_format:l.responseFormat.definition}:{}},t||[])},template:{__type:"chat",messages:"messages"in l.template?l.template.messages.map(y=>{const u=y.content.map(Vl).filter(Boolean).map(S=>S.text.text).join(""),g=y.content.filter(jt).filter(Boolean),k=y.content.filter(qt).filter(Boolean).at(0),b=Nn(y.role);return b==="tool"&&k?{id:$n(),role:Nn(y.role),content:typeof k.toolResult.result=="string"?k.toolResult.result:In(k.toolResult.result,null,2).json||"",toolCallId:k.toolResult.toolCallId}:b==="ai"&&g.length>0?{id:$n(),role:Nn(y.role),toolCalls:g.map(S=>lr(S,o))}:{id:$n(),role:Nn(y.role),content:u}}):[]},tools:l.tools.map(y=>({id:ja(),definition:y.definition})),toolChoice:d}},Cf=(n,a)=>{const l=a.length>0?a.reduce((t,i)=>((i.canonicalName||i.invocationName)&&(t[i.canonicalName||i.invocationName]=i),t),{}):{};return n.reduce((t,i)=>{const r=l[i.canonicalName||i.invocationName];return r&&(t[i.invocationName]=i[Va(r.invocationInputField)]),t},{})},Ff=[{invocationName:Ka,canonicalName:ra},{invocationName:Kn,canonicalName:Dn}],Kf=n=>{if(n.template.__type==="text_completion")return console.warn("Instance to prompt version conversion not supported for text completion"),null;const a=n.template.messages.map(t=>{var d;let i=[t.content?bs(t.content):null];const r=((d=t.toolCalls)==null?void 0:d.map(Ss))||[],o=t.toolCallId?[vs(t.toolCallId,t.content)]:[];return(r.length>0||o.length>0)&&(i=[]),{content:[...i,...r,...o].filter(c=>c!==null),role:bf(t.role)}});return{modelName:n.model.modelName||Hm,modelProvider:n.model.provider,template:{messages:a},tools:n.tools.map(t=>({definition:t.definition})),responseFormat:n.model.invocationParameters.filter(t=>t.canonicalName===Dn||t.invocationName===Kn).map(t=>({definition:t.valueJson})).at(0)||void 0,invocationParameters:Cf(n.model.invocationParameters.filter(t=>!Ff.some(i=>jn(i,t))).concat(n.toolChoice?[{invocationName:Ka,valueJson:n.toolChoice,canonicalName:ra}]:[]),n.model.supportedInvocationParameters)}},Tf=Rs,Pf=Ms,If=async({modelName:n,providerKey:a})=>{const l=await x.fetchQuery(be,Pf,{modelsInput:{modelName:n,providerKey:a}}).toPromise();return l==null?void 0:l.modelInvocationParameters},xf=async n=>x.fetchQuery(be,Tf,{promptId:n}).toPromise(),Df=n=>n?n==null?void 0:n.version:null,As=async n=>{var t;if(!n)return null;const a=await xf(n),l=Df(a==null?void 0:a.prompt);if(l&&l.templateType==="CHAT"){const i=await If({modelName:l.modelName,providerKey:l.modelProvider}),r=(t=a==null?void 0:a.prompt)==null?void 0:t.name;if(!r)throw new Error("Prompt name is required");return{instance:vf({promptId:n,promptName:r,promptVersion:l,supportedInvocationParameters:i}),promptVersion:l}}return null},Dv=async({params:n})=>{const{promptId:a}=n;if(!a)throw new Error("Prompt ID is required");const l=await As(a);if(!l)throw new Error("Prompt not found");return{instanceWithPrompt:l.instance,templateFormat:l.promptVersion.templateFormat}},Ns=function(){var n=[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PlaygroundQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PlaygroundQuery",selections:n},params:{cacheID:"f19ebe151a3a9794fa2566c66751d259",id:null,metadata:{},name:"PlaygroundQuery",operationKind:"query",text:`query PlaygroundQuery {
  modelProviders {
    name
    dependenciesInstalled
    dependencies
  }
}
`}}}();Ns.hash="9802d9d44657ca300abc1be4d0938560";const Ht=m.createContext(null);function _f({children:n,...a}){const[l]=m.useState(()=>Gm(a));return e(Ht.Provider,{value:l,children:n})}function z(n,a){const l=Ie.useContext(Ht);if(!l)throw new Error("Missing PlaygroundContext.Provider in the tree");return Wa(l,n,a)}function Gt(){const n=Ie.useContext(Ht);if(!n)throw new Error("Missing PlaygroundContext.Provider in the tree");return n}const zs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"exampleId"}],a=[{kind:"Variable",name:"id",variableName:"exampleId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},i={alias:"latestRevision",args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},o={alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[l,{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[r],storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null}],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c=[{kind:"Literal",name:"first",value:100}],p={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,i,o],type:"DatasetExample",abstractKey:null},{args:null,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,o,{alias:null,args:c,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},t,p,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},p],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[d],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experimentRuns(first:100)"},{alias:null,args:c,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"6fa23dc80c23ecdf48e57d139d76a721",id:null,metadata:{},name:"ExampleDetailsDialogQuery",operationKind:"query",text:`query ExampleDetailsDialogQuery(
  $exampleId: GlobalID!
) {
  example: node(id: $exampleId) {
    __typename
    ... on DatasetExample {
      id
      latestRevision: revision {
        input
        output
        metadata
      }
      span {
        id
        context {
          traceId
        }
        project {
          id
        }
      }
    }
    ...ExampleExperimentRunsTableFragment
    __isNode: __typename
    id
  }
}

fragment ExampleExperimentRunsTableFragment on DatasetExample {
  experimentRuns(first: 100) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              annotatorKind
              trace {
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();zs.hash="65b1c049bacc1ef8739c61af32a9414c";const $s=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"patchDatasetExamples",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditExampleDialogMutation",selections:a},params:{cacheID:"7217082d3d3796ecb60481d17133c351",id:null,metadata:{},name:"EditExampleDialogMutation",operationKind:"mutation",text:`mutation EditExampleDialogMutation(
  $input: PatchDatasetExamplesInput!
) {
  patchDatasetExamples(input: $input) {
    __typename
  }
}
`}}}();$s.hash="a5e0e601ed24ffaa37a99ba358f960d3";const Bl={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function Lf(n){const{exampleId:a,onCompleted:l}=n,[t,i]=m.useState(null),[r,o]=x.useMutation($s),{control:d,setError:c,handleSubmit:p,formState:{isValid:y}}=Ae({defaultValues:n.currentRevision}),u=m.useCallback(g=>{if(i(null),!Fn(g==null?void 0:g.input))return c("input",{message:"Input must be a valid JSON object"});if(!Fn(g==null?void 0:g.output))return c("output",{message:"Output must be a valid JSON object"});if(!Fn(g==null?void 0:g.metadata))return c("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{patches:[{exampleId:a,input:JSON.parse(g.input),output:JSON.parse(g.output),metadata:JSON.parse(g.metadata)}],versionDescription:g.description}},onCompleted:()=>{l()},onError:f=>{i(f.message)}})},[r,a,c,l]);return e(X,{size:"fullscreen",title:`Edit Example: ${a}`,extra:e(M,{variant:"primary",size:"S",isDisabled:!y||o,leadingVisual:e(_,{svg:o?e(ln,{}):e(rr,{})}),onPress:()=>p(u)(),children:"Save Changes"}),children:e("div",{css:T`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
          /* Make widths configurable */
          .dataset-picker {
            width: 100%;
            .ac-dropdown--picker,
            .ac-dropdown-button {
              width: 100%;
            }
          }
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:s(h,{direction:"column",gap:"size-200",children:[t?e(ye,{variant:"danger",children:t}):null,e(G,{control:d,name:"input",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(O,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...Bl,children:[b?e(ye,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(je,{value:k,onChange:g,onBlur:f})]})}),e(G,{control:d,name:"output",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(O,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...Bl,backgroundColor:"green-100",borderColor:"green-700",children:[b?e(ye,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(je,{value:k,onChange:g,onBlur:f})]})}),e(G,{control:d,name:"metadata",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(O,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...Bl,children:[b?e(ye,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(je,{value:k,onChange:g,onBlur:f})]})}),e(G,{control:d,name:"description",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(J,{value:k,onChange:g,onBlur:f,isInvalid:b,children:[e(W,{children:"Revision Description"}),e(ca,{}),S?e(Fe,{children:S==null?void 0:S.message}):e(v,{slot:"description",children:"A description of the changes made in this revision. Will be displayed in the version history."})]})})]})})})})})}function wf(n){const{onCompleted:a,...l}=n,[t,i]=m.useState(null);return s(H,{children:[e(M,{size:"S",leadingVisual:e(_,{svg:e(Cl,{})}),onPress:()=>i(e(Lf,{...l,onCompleted:()=>{i(null),a()}})),children:"Edit Example"}),e(Y,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:t})]})}const Os=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},r,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"2ec7ead16e6df0877bc47db0ed7c7553",id:null,metadata:{},name:"ExampleExperimentRunsTableQuery",operationKind:"query",text:`query ExampleExperimentRunsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExampleExperimentRunsTableFragment_2HEEH6
    __isNode: __typename
    id
  }
}

fragment ExampleExperimentRunsTableFragment_2HEEH6 on DatasetExample {
  experimentRuns(first: $first, after: $after) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              annotatorKind
              trace {
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Os.hash="6ca0f938b309407e8c184a1c13d1c52d";const Qs=function(){var n=["experimentRuns"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Os,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExampleExperimentRunsTableFragment",selections:[{alias:"experimentRuns",args:null,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"__ExampleExperimentRunsTable_experimentRuns_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},l,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},l],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"DatasetExample",abstractKey:null}}();Qs.hash="6ca0f938b309407e8c184a1c13d1c52d";const Ef=100;function Vf(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:T`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:"No experiments have been run for this example."})})})}const Mf=T`
  display: flex;
  flex-direction: row;
  align-items: center;
  color: var(--ac-global-color-primary);
  gap: var(--ac-global-dimension-size-50);
`;function Rf({example:n}){const a=m.useRef(null),l=se(),{data:t,loadNext:i,hasNext:r,isLoadingNext:o}=x.usePaginationFragment(Qs,n),d=m.useMemo(()=>t.experimentRuns.edges.map(f=>{let k=null;return f.run.startTime&&f.run.endTime&&(k=new Date(f.run.endTime).getTime()-new Date(f.run.startTime).getTime()),{...f.run,output:JSON.stringify(f.run.output),latencyMs:k}}),[t]),p=xe({columns:[{header:"start time",accessorKey:"startTime",cell:Me},{header:"output",accessorKey:"output",cell:f=>{var b;const k=(b=f.row.original)==null?void 0:b.error;return k!==null?e(v,{color:"danger",children:k}):e(Ke,{...f})}},{header:"latency",accessorKey:"latencyMs",cell:({getValue:f})=>{const k=f();return k===null||typeof k!="number"?"--":e(Re,{latencyMs:k})}},{header:"evaluations",accessorKey:"annotations",cell:({row:f})=>e(h,{direction:"row",gap:"size-50",wrap:"wrap",children:f.original.annotations.edges.map((k,b)=>{const S=k.annotation;return e(Da,{annotation:S,extra:S.trace&&e(C,{paddingTop:"size-100",children:s("div",{css:Mf,children:[e(_,{svg:e(xn,{})}),e("span",{children:"Click to view evaluator trace"})]})}),children:e(wn,{annotation:S,onClick:()=>{S.trace&&l(`/projects/${S.trace.projectId}/traces/${S.trace.traceId}`)}},b)},b)})})},{id:"actions",cell:({row:f})=>{const k=f.original.trace;if(k)return e(M,{size:"S",leadingVisual:e(_,{svg:e(Fl,{})}),onPress:()=>{l(`/projects/${k.projectId}/traces/${k.traceId}`)},"aria-label":"view trace"})}}],data:d,getCoreRowModel:De()}),y=p.getRowModel().rows,u=y.length===0,g=m.useCallback(f=>{if(f){const{scrollHeight:k,scrollTop:b,clientHeight:S}=f;k-b-S<300&&!o&&r&&i(Ef)}},[r,o,i]);return e("div",{css:T`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:a,onScroll:f=>g(f.target),children:s("table",{css:Gn,children:[e("thead",{children:p.getHeaderGroups().map(f=>e("tr",{children:f.headers.map(k=>e("th",{children:e("div",{children:Z(k.column.columnDef.header,k.getContext())})},k.id))},f.id))}),u?e(Vf,{}):e("tbody",{children:y.map(f=>e("tr",{children:f.getVisibleCells().map(k=>e("td",{children:Z(k.column.columnDef.cell,k.getContext())},k.id))},f.id))})]})})}function Wt({exampleId:n,onDismiss:a}){const[l,t]=m.useState(0),i=x.useLazyLoadQuery(zs,{exampleId:n},{fetchKey:l,fetchPolicy:"store-and-network"}),r=m.useMemo(()=>{const u=i.example.latestRevision;return{input:JSON.stringify(u==null?void 0:u.input,null,2),output:JSON.stringify(u==null?void 0:u.output,null,2),metadata:JSON.stringify(u==null?void 0:u.metadata,null,2)}},[i]),o=m.useMemo(()=>{const u=i.example.span;return u?{id:u.id,traceId:u.context.traceId,projectId:u.project.id}:null},[i]),{input:d,output:c,metadata:p}=r,y=Se();return e(Y,{type:"slideOver",isDismissable:!0,onDismiss:a,children:e(X,{size:"XL",title:`Example: ${n}`,extra:s(h,{direction:"row",gap:"size-100",children:[o?e(Kl,{size:"S",to:`/projects/${o.projectId}/traces/${o.traceId}?selectedSpanNodeId=${o.id}`,children:"View Source Span"}):null,e(wf,{exampleId:n,currentRevision:r,onCompleted:()=>{y({title:"Example updated",message:`Example ${n} has been updated.`}),t(u=>u+1)}})]}),children:s(Pn,{direction:"vertical",autoSaveId:"example-panel-group",children:[e(Le,{defaultSize:65,children:e("div",{css:T`
                overflow-y: auto;
                height: 100%;
              `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",paddingTop:"size-200",paddingBottom:"size-200",children:s(h,{direction:"column",gap:"size-200",children:[e(O,{title:"Input",...Hl,extra:e(re,{text:d}),children:e(Je,{value:d})}),e(O,{title:"Output",...Hl,extra:e(re,{text:c}),children:e(Je,{value:c})}),e(O,{title:"Metadata",...Hl,extra:e(re,{text:p}),children:e(Je,{value:p})})]})})})})}),e(Tn,{css:Wn}),e(Le,{defaultSize:35,children:s(h,{direction:"column",height:"100%",children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(te,{level:3,children:"Experiment Runs"})}),e(Rf,{example:i.example})]})})]})})})}const Hl={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}};function Af(){const[n,a]=hn(),l=n.get("exampleId"),t=n.get("datasetId");return!l||!t?null:e(Wt,{exampleId:l,onDismiss:()=>{a(i=>(i.delete("exampleId"),i))}})}const Nf=`
The playground is not available until an LLM provider client is installed on the server.
`,zf=n=>`
# Installing one or more of the clients will enable the playground
${Array.from(n.reduce((a,l)=>(l.dependencies.forEach(t=>a.add(t)),a),new Set)).map(a=>`pip install ${a}`).join(`
`)}
`,$f=n=>e(C,{height:"100%",width:"100%",children:s(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:[e(sr,{message:Nf,graphicKey:"not found",size:"L"}),e(v,{children:"The following clients are supported:"}),e(tr,{value:zf(n.availableProviders)})]})}),Of={OPENAI:"OPENAI_API_KEY",ANTHROPIC:"ANTHROPIC_API_KEY",AZURE_OPENAI:"AZURE_OPENAI_API_KEY",GOOGLE:"GEMINI_API_KEY"};function Qf(){const n=z(o=>Array.from(new Set(o.instances.map(d=>d.model.provider)))),a=z(o=>o.instances.some(d=>d.activeRunId!=null)),l=Pa(o=>o.setCredential),t=Pa(o=>o),[i,r]=m.useState(!1);return e("div",{css:T`
        .ac-dropdown-button {
          min-width: 0px;
        }
      `,children:s(ua,{placement:"bottom",isOpen:i,onOpenChange:o=>{r(o)},children:[e(mt,{size:"compact",isDisabled:a,children:"API Keys"}),e(gl,{children:e(C,{padding:"size-200",children:s(Xe,{onSubmit:o=>{o.preventDefault(),r(!1)},children:[e(te,{level:2,weight:"heavy",children:"API Keys"}),e(C,{paddingY:"size-50",children:e(v,{color:"text-700",size:"XS",children:"API keys are stored in your browser and used to communicate with their respective API's."})}),e(h,{direction:"column",gap:"size-100",children:n.map(o=>{const d=Of[o];return s(J,{size:"S",type:"password",isRequired:!0,onChange:c=>{l({provider:o,value:c})},value:t[o],children:[e(W,{children:d}),e(ae,{}),e(v,{slot:"description",children:`Alternatively, you can set the "${d}" environment variable on the phoenix server.`})]},o)})}),e(C,{paddingTop:"size-100",children:e(h,{direction:"row",gap:"size-100",width:"100%",justifyContent:"end",children:e(en,{href:"/settings",children:"View all AI provider configurations"})})})]})})})]})})}const Ci=30,jf=T`
  display: flex;
  direction: row;
  align-items: center;
  .ac-dropdown > button {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    height: ${Ci}px;
  }
  & > button {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-left: none;
    height: ${Ci}px;
  }
`;function qf(){const[n,a]=hn(),l=n.get("datasetId")??"";return s("div",{css:jf,children:[e(or,{size:"compact",placeholder:"Test over a dataset",selectedKey:l,onSelectionChange:t=>{if(l!==null&&t===l){a(i=>(i.delete("datasetId"),i));return}a(i=>(i.set("datasetId",String(t)),i))}}),e(M,{size:"S",leadingVisual:e(_,{svg:e(Wm,{})}),onPress:()=>{a(t=>(t.delete("datasetId"),t))}})]})}const js=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],l={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetSectionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetSectionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"c36833ac260163836d9810cf8e137380",id:null,metadata:{},name:"PlaygroundDatasetSectionQuery",operationKind:"query",text:`query PlaygroundDatasetSectionQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      name
      exampleCount
    }
    __isNode: __typename
    id
  }
}
`}}}();js.hash="38aaf5a39c06500e51a82c91a9e27408";const qs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionOverDatasetMutationPayload",kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionOverDatasetMutationExamplePayload",kind:"LinkedField",name:"examples",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentRunId",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionMutationError",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[l,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ChatCompletionMutationPayload",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableMutation",selections:t},params:{cacheID:"4697f7aaa22729dbf83970ce9ae6475b",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableMutation",operationKind:"mutation",text:`mutation PlaygroundDatasetExamplesTableMutation(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    __typename
    experimentId
    examples {
      datasetExampleId
      experimentRunId
      result {
        __typename
        ... on ChatCompletionMutationError {
          message
        }
        ... on ChatCompletionMutationPayload {
          content
          errorMessage
          span {
            id
            tokenCountCompletion
            tokenCountPrompt
            tokenCountTotal
            latencyMs
            project {
              id
            }
            context {
              traceId
            }
          }
          toolCalls {
            id
            function {
              name
              arguments
            }
          }
        }
      }
    }
  }
}
`}}}();qs.hash="c15f93fe1380986536971620c3bf3a11";const Us=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[l],i=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},a],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[l,a,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"experiment",plural:!1,selections:t,storageKey:null}],type:"ChatCompletionSubscriptionExperiment",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"experimentRun",plural:!1,selections:t,storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableSubscription",selections:i,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableSubscription",selections:i},params:{cacheID:"3759bfb17a93aa0cf227c4ef7fa6cd30",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableSubscription",operationKind:"subscription",text:`subscription PlaygroundDatasetExamplesTableSubscription(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    __typename
    ... on TextChunk {
      content
      datasetExampleId
    }
    ... on ToolCallChunk {
      id
      datasetExampleId
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionExperiment {
      experiment {
        id
      }
    }
    ... on ChatCompletionSubscriptionResult {
      datasetExampleId
      span {
        id
        tokenCountCompletion
        tokenCountPrompt
        tokenCountTotal
        latencyMs
        project {
          id
        }
        context {
          traceId
        }
      }
      experimentRun {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      datasetExampleId
      message
    }
  }
}
`}}}();Us.hash="f1df5c75f1a62acde69f3f5d676f9213";const Bs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:20,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:["datasetVersionId"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"fc176d05790f6c690eead96a6ece1c50",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableRefetchQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableRefetchQuery(
  $after: String = null
  $datasetVersionId: GlobalID
  $first: Int = 20
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment_4a6F8Z
    __isNode: __typename
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment_4a6F8Z on Dataset {
  examples(datasetVersionId: $datasetVersionId, first: $first, after: $after) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Bs.hash="ae68770500a29b14f7108d56c146fb99";const Hs=function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:20,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Bs,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"PlaygroundDatasetExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__PlaygroundDatasetExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();Hs.hash="ae68770500a29b14f7108d56c146fb99";const Gs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:20}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"examples(first:20)"},{alias:null,args:i,filters:["datasetVersionId"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"795ea41682593e1fedd5ced3252f7602",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment
    __isNode: __typename
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment on Dataset {
  examples(first: 20) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Gs.hash="f809b3d539d0032d9681a4a4450b1d6f";const Uf=()=>{const n=(a,l)=>({exampleResponsesMap:{},updateExampleData:({instanceId:t,exampleId:i,patch:r})=>{const o=l().exampleResponsesMap,d=o[t]??{},c=d[i]??{};a({exampleResponsesMap:{...o,[t]:{...d,[i]:{...c,...r}}}})},appendExampleDataTextChunk:({instanceId:t,exampleId:i,textChunk:r})=>{const o=l().exampleResponsesMap,d=o[t]??{},c=d[i]??{},p=c.content??"";a({exampleResponsesMap:{...o,[t]:{...d,[i]:{...c,content:p+r}}}})},appendExampleDataToolCallChunk:({instanceId:t,exampleId:i,toolCallChunk:r})=>{var k;const o=l().exampleResponsesMap,d=o[t]??{},c=d[i]??{},p=c.toolCalls??{},{id:y,function:u}=r,g=p[y],f={...g,id:y,function:{name:((k=g==null?void 0:g.function)==null?void 0:k.name)??u.name,arguments:(g==null?void 0:g.function.arguments)!=null?g.function.arguments+u.arguments:u.arguments}};a({exampleResponsesMap:{...o,[t]:{...d,[i]:{...c,toolCalls:{...p,[y]:f}}}}})},setExampleDataForInstance:({instanceId:t,data:i})=>{const r=l().exampleResponsesMap;a({exampleResponsesMap:{...r,[t]:i}})},resetExampleData:()=>{a({exampleResponsesMap:{}})}});return Bi()(n)},Ws=Ie.createContext(null);function Bf({children:n}){const[a]=m.useState(()=>Uf());return e(Ws.Provider,{value:a,children:n})}function ka(n,a){const l=Ie.useContext(Ws);if(!l)throw new Error("Missing PlaygroundDatasetExamplesTableContext.Provider in the tree");return Wa(l,n,a)}function Jt({children:n}){return s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(_,{svg:e(Ft,{}),color:"danger"}),e(v,{color:"danger",children:n})]})}const Js=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"runId"}],a=[{kind:"Variable",name:"id",variableName:"runId"}],l={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={kind:"InlineFragment",selections:[l,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[t,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ExperimentRun",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundExperimentRunDetailsDialogQuery",selections:[{alias:"run",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundExperimentRunDetailsDialogQuery",selections:[{alias:"run",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t],storageKey:null}]},params:{cacheID:"1e3277995e47da369d84557def1a62bf",id:null,metadata:{},name:"PlaygroundExperimentRunDetailsDialogQuery",operationKind:"query",text:`query PlaygroundExperimentRunDetailsDialogQuery(
  $runId: GlobalID!
) {
  run: node(id: $runId) {
    __typename
    ... on ExperimentRun {
      output
      startTime
      endTime
      error
      example {
        id
        revision {
          input
          output
        }
      }
      annotations {
        edges {
          annotation: node {
            id
            name
            label
            score
            explanation
            annotatorKind
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Js.hash="2eee337b0f8c4e738dd6580efa1e3c96";function Hf({runId:n}){var d,c,p;const l=x.useLazyLoadQuery(Js,{runId:n}).run,t=(d=l.example)==null?void 0:d.id,i=(c=l.example)==null?void 0:c.revision,r=i==null?void 0:i.input,o=i==null?void 0:i.output;return e(X,{title:`Experiment Run for Example: ${t}`,size:"fullscreen",children:s(Pn,{direction:"vertical",autoSaveId:"example-compare-panel-group",children:[e(Le,{defaultSize:33,children:e(C,{overflow:"auto",height:"100%",padding:"size-200",children:s(h,{direction:"row",gap:"size-200",flex:"1 1 auto",children:[e(C,{width:"50%",children:e(O,{title:"Input",...Fi,bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},extra:e(re,{text:JSON.stringify(r)}),children:e(Je,{value:JSON.stringify(r,null,2)})})}),e(C,{width:"50%",children:e(O,{title:"Reference Output",...Fi,extra:e(re,{text:JSON.stringify(o)}),bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},children:e(Je,{value:JSON.stringify(o,null,2)})})})]})})}),e(Tn,{css:Wn}),e(Le,{defaultSize:67,children:s(h,{direction:"column",height:"100%",children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(te,{level:2,children:"Experiment Run Output"})}),e("div",{css:T`
                overflow-y: auto;
                height: 100%;
                padding: var(--ac-global-dimension-static-size-200);
              `,children:s(h,{direction:"row",children:[e(C,{flex:!0,children:l.error?e(C,{padding:"size-200",children:e(Wf,{error:l.error})}):e(Je,{value:JSON.stringify(l.output,null,2)})}),s(ia,{width:"size-3000",children:[l.startTime&&l.endTime&&e(Gf,{startTime:l.startTime,endTime:l.endTime}),e("ul",{css:T`
                      margin-top: var(--ac-global-dimension-static-size-100);
                      display: flex;
                      flex-direction: column;
                      justify-content: flex-start;
                      align-items: flex-end;
                      gap: var(--ac-global-dimension-static-size-100);
                    `,children:(p=l.annotations)==null?void 0:p.edges.map(y=>e("li",{children:e(wn,{annotation:y.annotation})},y.annotation.id))})]})]})})]})})]})})}function Gf({startTime:n,endTime:a}){const l=m.useMemo(()=>{let t=null;return n&&a&&(t=new Date(a).getTime()-new Date(n).getTime()),t},[n,a]);return l===null?null:e(Re,{latencyMs:l})}function Wf({error:n}){return s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(_,{svg:e(Ft,{}),color:"danger"}),e(v,{color:"danger",children:n})]})}const Fi={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}},Zs=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"traceId"},l=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},o={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"traceId",variableName:"traceId"}],concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"projectSessionId",storageKey:null},{alias:null,args:[{kind:"Literal",name:"first",value:1e3}],concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"spans(first:1000)"},r],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"TraceDetailsQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[o],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"TraceDetailsQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},o,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t],storageKey:null}]},params:{cacheID:"e49f79cc2ed4e3975425c66bfa0c9952",id:null,metadata:{},name:"TraceDetailsQuery",operationKind:"query",text:`query TraceDetailsQuery(
  $traceId: ID!
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      trace(traceId: $traceId) {
        projectSessionId
        spans(first: 1000) {
          edges {
            span: node {
              id
              context {
                spanId
                traceId
              }
              name
              spanKind
              statusCode: propagatedStatusCode
              startTime
              parentId
              latencyMs
              tokenCountTotal
              tokenCountPrompt
              tokenCountCompletion
              spanAnnotations {
                id
                name
                label
                score
                annotatorKind
              }
            }
          }
        }
        latencyMs
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Zs.hash="5fb4b5eb8dbfa378e4e293ec414bb1aa";const Xs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},d={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},b=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}],S={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:b,storageKey:null},F={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:b,storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},D={alias:null,args:null,concreteType:"SpanEvent",kind:"LinkedField",name:"events",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null},w={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},K={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},E={alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},V={alias:null,args:null,concreteType:"DocumentEvaluation",kind:"LinkedField",name:"documentEvaluations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"documentPosition",storageKey:null},r,K,I,E],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[t,i,r,o,d,c,p,y,u,g,f,k,S,F,P,{kind:"RequiredField",field:D,action:"THROW",path:"span.events"},w,V,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,r],storageKey:null},{args:null,kind:"FragmentSpread",name:"SpanFeedback_annotations"},{args:null,kind:"FragmentSpread",name:"SpanAside_span"}],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[i,r,o,d,c,p,y,u,g,f,k,S,F,P,D,w,V,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,r,K,I,E,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"479a50647c756ee04606202151df1785",id:null,metadata:{},name:"SpanDetailsQuery",operationKind:"query",text:`query SpanDetailsQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      id
      context {
        spanId
        traceId
      }
      name
      spanKind
      statusCode: propagatedStatusCode
      statusMessage
      startTime
      parentId
      latencyMs
      tokenCountTotal
      tokenCountPrompt
      tokenCountCompletion
      input {
        value
        mimeType
      }
      output {
        value
        mimeType
      }
      attributes
      events {
        name
        message
        timestamp
      }
      documentRetrievalMetrics {
        evaluationName
        ndcg
        precision
        hit
      }
      documentEvaluations {
        documentPosition
        name
        label
        score
        explanation
      }
      spanAnnotations {
        id
        name
      }
      ...SpanFeedback_annotations
      ...SpanAside_span
    }
    __isNode: __typename
    id
  }
}

fragment SpanAside_span on Span {
  id
  code: statusCode
  startTime
  endTime
  tokenCountTotal
  tokenCountPrompt
  tokenCountCompletion
  spanAnnotations {
    id
    name
    label
    annotatorKind
    score
  }
}

fragment SpanFeedback_annotations on Span {
  spanAnnotations {
    id
    name
    label
    score
    explanation
    annotatorKind
  }
}
`}}}();Xs.hash="61b3b53936cae27a4193ff07fac1cc9f";function Ki(n){return Array.isArray(n)&&n.every(a=>typeof a=="object"&&pe.message in a&&Jf(a[pe.message]))}function Jf(n){return typeof n=="object"&&n!==null&&Ne.role in n}const Gl=T`
  display: flex;
  align-items: center;
  .ac-text {
    display: inline-block;
    max-width: 9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`;function Ze(n){const{name:a,metric:l,k:t,score:i}=n,r=typeof t=="number"?`${l}@${t}`:l,o=m.useMemo(()=>l==="hit"?i?"true":"false":typeof i=="number"&&An(i)||"--",[i,l]);return s(fe,{delay:500,offset:3,children:[e(qe,{children:e("div",{css:Jm,children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Zm,{color:"var(--ac-global-color-seafoam-1000)"}),a?e("div",{css:Gl,children:e(v,{weight:"heavy",size:"XS",color:"inherit",children:a})}):null,e("div",{css:Gl,children:e(v,{size:"XS",color:"inherit",children:r})}),e("div",{css:Gl,children:e(v,{size:"XS",children:o})})]})})}),e(ma,{children:s(h,{direction:"row",gap:"size-100",children:[s(v,{weight:"heavy",color:"inherit",children:[a," ",r]}),e(v,{color:"inherit",children:o})]})})]})}function Ys({spanNodeId:n,projectId:a,size:l="M"}){const[t,i]=m.useState(null);return s(H,{children:[e(M,{size:l,leadingVisual:e(_,{svg:e(Cl,{})}),onPress:()=>i(e(dr,{spanNodeId:n,projectId:a})),children:"Annotate"}),e(Y,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:t})]})}const eo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanAsideSpanQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SpanAside_span"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanAsideSpanQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"878027b90513af8f947e6aa408450057",id:null,metadata:{},name:"SpanAsideSpanQuery",operationKind:"query",text:`query SpanAsideSpanQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SpanAside_span
    __isNode: __typename
    id
  }
}

fragment SpanAside_span on Span {
  id
  code: statusCode
  startTime
  endTime
  tokenCountTotal
  tokenCountPrompt
  tokenCountCompletion
  spanAnnotations {
    id
    name
    label
    annotatorKind
    score
  }
}
`}}}();eo.hash="cb5cab60889623d77ad0c96c98b3f8ac";const no=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:eo,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SpanAside_span",selections:[n,{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}}();no.hash="cb5cab60889623d77ad0c96c98b3f8ac";const Zf=T`
  display: flex;
  padding-top: var(--ac-global-dimension-size-50);
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  align-items: flex-start;
`;function Xf(n){const[a]=x.useRefetchableFragment(no,n.span),{startTime:l,endTime:t,code:i,tokenCountCompletion:r,tokenCountPrompt:o,tokenCountTotal:d}=a,c=m.useMemo(()=>new Date(l),[l]),p=m.useMemo(()=>t?new Date(t):null,[t]),y=m.useMemo(()=>p?p.getTime()-c.getTime():null,[p,c]),u=cr(i),g=a.spanAnnotations,f=g.length>0;return e(C,{padding:"size-200",borderColor:"dark",backgroundColor:"dark",borderLeftWidth:"thin",width:"230px",flex:"none",minHeight:"100%",children:s(h,{direction:"column",gap:"size-200",children:[e(fa,{label:"Status",children:s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(Tl,{statusCode:i}),e(v,{color:u,children:i})]})}),e(fa,{label:"Start Time",children:e(v,{children:gn(c)})}),p&&e(fa,{label:"End Time",children:e(v,{size:"M",children:gn(p)})}),e(fa,{label:"Latency",children:e(v,{children:typeof y=="number"?e(Re,{latencyMs:y}):"--"})}),d?e(fa,{label:"Total Tokens",children:e(Jn,{tokenCountTotal:d,tokenCountPrompt:o??0,tokenCountCompletion:r??0,size:"L"})},"tokens"):null,f&&e(fa,{label:"Feedback",children:e("ul",{css:Zf,children:g.map(k=>e("li",{children:e(wn,{annotation:k,annotationDisplayPreference:"label"})},k.id))})})]})})}function fa({label:n,children:a}){return s(h,{direction:"column",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:n}),a]})}function Yf(n){const{spanId:a,traceId:l}=n;return e("div",{css:T`
        button.ac-dropdown-button {
          min-width: 50px;
          .ac-dropdown-button__text {
            padding-right: 10px;
          }
        }
      `,children:s(ua,{placement:"bottom right",children:[e(mt,{addonBefore:e(_,{svg:e(kl,{})}),children:"Code"}),e(gl,{children:e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-100",children:[s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{value:a,isReadOnly:!0,size:"L",children:[e(W,{children:"Span ID"}),e(ae,{})]}),e(re,{text:a,size:"M"})]}),s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{value:l,isReadOnly:!0,size:"L",children:[e(W,{children:"Trace ID"}),e(ae,{})]}),e(re,{text:l,size:"M"})]})]})})})]})})}const ao={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanFeedback_annotations",selections:[{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};ao.hash="6cde9ca22bfc99084304e3e817be01dc";function eh(){const[n,a]=m.useState(null);return s(C,{padding:"size-200",children:[s(h,{direction:"column",gap:"size-100",alignItems:"center",children:[e(yl,{graphicKey:"documents"}),e(v,{children:"No annotations for this span"}),e(M,{variant:"default",size:"S",onPress:()=>{a(e(X,{title:"Span Annotations",isDismissable:!0,children:s(C,{padding:"size-200",children:[e("p",{css:T`
              margin: 0 0 var(--ac-global-dimension-size-100) 0;
            `,children:"Annotations are pivotal for tracking and improving the performance of your application. Phoenix allows for both LLM and HUMAN annotations."}),e(en,{href:"https://docs.arize.com/phoenix/tracing/concepts-tracing/how-to-evaluate-traces",children:"View annotation documentation"})]})}))},leadingVisual:e(_,{svg:e(Ct,{})}),children:"How to Annotate"})]}),e(Y,{onDismiss:()=>a(null),isDismissable:!0,children:n})]})}const nh=[{header:"name",accessorKey:"name",size:100},{header:"label",accessorKey:"label",size:100},{header:"score",accessorKey:"score",size:100},{header:"explanation",accessorKey:"explanation",cell:Xm,size:400}];function Ti({annotations:n}){const a=m.useMemo(()=>[...n],[n]),l=xe({columns:nh,data:a,getCoreRowModel:De()}),i=l.getRowModel().rows.length===0;return s("table",{css:tn,children:[e("thead",{children:l.getHeaderGroups().map(r=>e("tr",{children:r.headers.map(o=>e("th",{colSpan:o.colSpan,children:o.isPlaceholder?null:e(H,{children:Z(o.column.columnDef.header,o.getContext())})},o.id))},r.id))}),i?e(rn,{}):e("tbody",{children:l.getRowModel().rows.map(r=>e("tr",{children:r.getVisibleCells().map(o=>e("td",{style:{width:o.column.getSize()},children:Z(o.column.columnDef.cell,o.getContext())},o.id))},r.id))})]})}function ah({span:n}){const a=x.useFragment(ao,n),l=m.useMemo(()=>a.spanAnnotations.filter(r=>r.annotatorKind==="HUMAN"),[a.spanAnnotations]),t=m.useMemo(()=>a.spanAnnotations.filter(r=>r.annotatorKind==="LLM"),[a.spanAnnotations]);return a.spanAnnotations.length>0?s(Ye,{defaultExpandedKeys:["evaluations","human"],children:[s(me,{id:"evaluations",children:[e(ce,{children:"Evaluations"}),e(ue,{children:e(Ti,{annotations:t})})]}),s(me,{id:"human",children:[e(ce,{children:"Human Annotations"}),e(ue,{children:e(Ti,{annotations:l})})]})]}):e(eh,{})}function lh(n){return n==="__REDACTED__"}const th=T`
  position: relative;
  overflow: hidden;
  width: 200px;
  height: 200px;
  border-radius: var(--ac-global-rounding-small);
  border: 1px solid var(--ac-global-color-grey-500);
  background-color: var(--ac-global-color-grey-200);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  transition:
    width 0.1s ease-in-out,
    height 0.1s ease-in-out opacity 0.1s ease-in-out;
  button {
    position: absolute;
    right: var(--ac-global-dimension-size-100);
    top: var(--ac-global-dimension-size-100);
    z-index: 1;
    opacity: 0;
  }
  &:hover button {
    opacity: 1;
  }
  img {
    width: inherit;
    height: inherit;
    object-fit: contain;
  }

  &.is-expanded {
    width: 100%;
    height: 100%;
    img {
      object-fit: cover;
    }
  }
`;function ih(n){const[a,l]=m.useState(!1);let t;const i=lh(n.url);return i?t=e(rh,{}):t=e("img",{src:n.url}),s("div",{className:Vu({"is-expanded":a}),css:th,children:[!i&&e(M,{variant:"default",size:"S",onPress:()=>l(!a),leadingVisual:e(_,{svg:a?e(Ym,{}):e(Ba,{})}),"aria-label":"Expand / Collapse Image"}),t]})}const rh=()=>s("svg",{width:"130",height:"130",viewBox:"0 0 130 130",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("rect",{x:"1.5",y:"1.5",width:"127",height:"127",rx:"6.5",strokeOpacity:"0.8",strokeWidth:"3"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M40 27.5H90C96.8917 27.5 102.5 33.1083 102.5 40V90C102.5 96.8917 96.8917 102.5 90 102.5H40C33.1083 102.5 27.5 96.8917 27.5 90V40C27.5 33.1083 33.1083 27.5 40 27.5ZM40 35.8333H90C92.3 35.8333 94.1667 37.7 94.1667 40V74.85L80.8208 63.4667C76.6958 59.9583 70.2417 59.9583 66.1542 63.4417L35.8333 88.7417V40C35.8333 37.7 37.7 35.8333 40 35.8333ZM54.5833 50.4167C54.5833 53.8667 51.7833 56.6667 48.3333 56.6667C44.8833 56.6667 42.0833 53.8667 42.0833 50.4167C42.0833 46.9667 44.8833 44.1667 48.3333 44.1667C51.7833 44.1667 54.5833 46.9667 54.5833 50.4167ZM42.3375 94.1667H90C92.3 94.1667 94.1667 92.3 94.1667 90V85.8083L75.4125 69.8083C74.4083 68.9458 72.55 68.9417 71.525 69.8125L42.3375 94.1667Z",fill:"var(--ac-global-color-grey-300)"})]}),lo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a},params:{cacheID:"d93c9d47668fc266ba09ecb14c2b72ae",id:null,metadata:{},name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",operationKind:"mutation",text:`mutation SpanToDatasetExampleDialogAddExampleToDatasetMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();lo.hash="75120065d239f28304e9dd91fc34bec9";const to=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={kind:"InlineFragment",selections:[{alias:"revision",args:null,concreteType:"SpanAsExampleRevision",kind:"LinkedField",name:"asExampleRevision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"68887dda2ffa7793e66ff83d472c72f8",id:null,metadata:{},name:"SpanToDatasetExampleDialogQuery",operationKind:"query",text:`query SpanToDatasetExampleDialogQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      revision: asExampleRevision {
        input
        output
        metadata
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();to.hash="647a1865dacf40ce9bbb255b572a9a68";const Wl={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function sh({spanId:n,onCompleted:a}){const[l,t]=m.useState(null),i=x.useLazyLoadQuery(to,{spanId:n},{fetchPolicy:"store-and-network"}),{span:{revision:r}}=i,[o,d]=x.useMutation(lo),{control:c,setError:p,handleSubmit:y,formState:{isValid:u}}=Ae({defaultValues:{input:JSON.stringify(r==null?void 0:r.input,null,2),output:JSON.stringify(r==null?void 0:r.output,null,2),metadata:JSON.stringify(r==null?void 0:r.metadata,null,2),datasetId:""}}),g=m.useCallback(f=>{if(t(null),!Fn(f==null?void 0:f.input))return p("input",{message:"Input must be a valid JSON object"});if(!Fn(f==null?void 0:f.output))return p("output",{message:"Output must be a valid JSON object"});if(!Fn(f==null?void 0:f.metadata))return p("metadata",{message:"Metadata must be a valid JSON object"});if(!(f!=null&&f.datasetId))return p("datasetId",{message:"Dataset is required"});o({variables:{input:{datasetId:f.datasetId,examples:[{input:JSON.parse(f.input),output:JSON.parse(f.output),metadata:JSON.parse(f.metadata),spanId:n}]}},onCompleted:()=>{a(f.datasetId)},onError:k=>{const b=Pe(k);t((b==null?void 0:b[0])??k.message)}})},[o,p,n,a]);return e(X,{size:"fullscreen",title:"Add Example to Dataset",extra:e(M,{variant:"primary",size:"S",isDisabled:!u||d,onPress:()=>y(g)(),leadingVisual:e(_,{svg:d?e(ln,{}):e(Ca,{})}),children:"Add Example"}),children:e("div",{css:T`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
          /* Make widths configurable */
          .dataset-picker {
            width: 100%;
            .ac-dropdown--picker,
            .ac-dropdown-button {
              width: 100%;
            }
          }
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:s(h,{direction:"column",gap:"size-200",children:[l?e(ye,{variant:"danger",children:l}):null,e(G,{control:c,name:"datasetId",render:({field:{onChange:f,onBlur:k},fieldState:{invalid:b,error:S}})=>s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[e(or,{onSelectionChange:f,onBlur:k,validationState:b?"invalid":"valid",errorMessage:S==null?void 0:S.message,label:"Dataset"}),e(ep,{})]})}),e(G,{control:c,name:"input",render:({field:{onChange:f,onBlur:k,value:b},fieldState:{invalid:S,error:F}})=>s(O,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...Wl,children:[S?e(ye,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(je,{value:b,onChange:f,onBlur:k})]})}),e(G,{control:c,name:"output",render:({field:{onChange:f,onBlur:k,value:b},fieldState:{invalid:S,error:F}})=>s(O,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...Wl,backgroundColor:"green-100",borderColor:"green-700",children:[S?e(ye,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(je,{value:b,onChange:f,onBlur:k})]})}),e(G,{control:c,name:"metadata",render:({field:{onChange:f,onBlur:k,value:b},fieldState:{invalid:S,error:F}})=>s(O,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...Wl,children:[S?e(ye,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(je,{value:b,onChange:f,onBlur:k})]})})]})})})})})}const oh=n=>m.useMemo(()=>we(n),[n]),dh=n=>n.events.some(a=>a.name==="exception"),ve={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0};function ch({spanNodeId:n,projectId:a}){const l=se(),{span:t}=x.useLazyLoadQuery(Xs,{spanId:n});if(t.__typename!=="Span")throw new Error("Expected a span, but got a different type"+t.__typename);const i=m.useMemo(()=>dh(t),[t]),r=Ge(d=>d.showSpanAside),o=Ge(d=>d.setShowSpanAside);return s(h,{direction:"column",flex:"1 1 auto",height:"100%",children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-150",paddingEnd:"size-200",flex:"none",children:s(h,{direction:"row",gap:"size-200",alignItems:"center",children:[s(h,{direction:"row",gap:"size-100",width:"100%",height:"100%",alignItems:"center",children:[e(Kt,{spanKind:t.spanKind}),e(v,{children:t.name})]}),s(h,{flex:"none",direction:"row",alignItems:"center",gap:"size-100",children:[e(M,{variant:"default",leadingVisual:e(_,{svg:e(pa,{})}),isDisabled:t.spanKind!=="llm",onPress:()=>{l(`/playground/spans/${t.id}`)},children:"Playground"}),e(Yf,{traceId:t.context.traceId,spanId:t.context.spanId}),e(ph,{span:t}),e(Ys,{spanNodeId:t.id,projectId:a}),s(fe,{placement:"top",offset:5,children:[e(M,{variant:"default","aria-label":"Toggle showing span details",onPress:()=>{o(!r)},leadingVisual:e(_,{svg:r?e(np,{}):e(ap,{})})}),e(Ve,{children:r?"Hide Span Details":"Show Span Details"})]})]})]})}),s(He,{children:[e(ne,{name:"Info",children:s(h,{direction:"row",height:"100%",children:[e(mh,{children:e(Pl,{children:e(gh,{span:t})})}),r?e(Xf,{span:t}):null]})}),e(ne,{name:"Feedback",extra:e(un,{variant:"light",children:t.spanAnnotations.length}),children:d=>d?e(ah,{span:t}):null}),e(ne,{name:"Attributes",title:"Attributes",children:e(C,{padding:"size-200",children:e(O,{title:"All Attributes",...ve,titleExtra:so,extra:e(re,{text:t.attributes}),children:e(qn,{children:t.attributes})})})}),e(ne,{name:"Events",extra:e(un,{variant:i?"danger":"light",children:t.events.length}),children:e(Lh,{events:t.events})})]})]})}const uh=T`
  flex: 1 1 auto;
  overflow-y: auto;
  // Overflow fails to take into account padding
  & > *:after {
    content: "";
    display: block;
    height: var(--ac-global-dimension-static-size-400);
  }
`;function mh({children:n}){return e("div",{css:uh,"data-testid":"span-info-wrap",children:n})}function ph({span:n}){const[a,l]=m.useState(null),t=Se(),i=se(),r=m.useCallback(()=>{l(e(sh,{spanId:n.id,onCompleted:o=>{l(null),t({title:"Span Added to Dataset",message:"Successfully added span to dataset",action:{text:"View Dataset",onClick:()=>{i(`/datasets/${o}/examples`)}}})}}))},[n.id,t,i]);return s(H,{children:[e(M,{variant:"default",leadingVisual:e(_,{svg:e(St,{})}),onPress:r,children:"Add to Dataset"}),e(m.Suspense,{children:e(Y,{type:"slideOver",isDismissable:!0,onDismiss:()=>l(null),children:a})})]})}function gh({span:n}){const{spanKind:a,attributes:l}=n,{json:t,parseError:i}=oh(l),r=m.useMemo(()=>n.statusMessage?e(ye,{variant:"danger",title:"Status Description",children:n.statusMessage}):null,[n]);if(i||!t)return e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-200",children:[r,e(ye,{variant:"warning",title:"Un-parsable attributes",children:`Failed to parse span attributes. ${i instanceof Error?i.message:""}`}),e(O,{...ve,title:"Attributes",children:e(C,{padding:"size-100",children:l})})]})});let o;switch(a){case"llm":{o=e(yh,{span:n,spanAttributes:t});break}case"retriever":{o=e(fh,{span:n,spanAttributes:t});break}case"reranker":{o=e(hh,{span:n,spanAttributes:t});break}case"embedding":{o=e(kh,{span:n,spanAttributes:t});break}case"tool":{o=e(bh,{span:n,spanAttributes:t});break}default:o=e(io,{span:n})}return e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-200",children:[r,o,t!=null&&t.metadata?e(O,{...ve,title:"Metadata",children:e(qn,{children:JSON.stringify(t.metadata)})}):null]})})}function yh(n){const{spanAttributes:a,span:l}=n,{input:t,output:i}=l,r=m.useMemo(()=>a[pe.llm]||null,[a]),o=m.useMemo(()=>{if(r==null)return null;const E=r[ze.model_name];return typeof E=="string"?E:null},[r]),d=m.useMemo(()=>{if(r==null)return[];const E=r[ze.input_messages];return Ki(E)?(E==null?void 0:E.map(V=>V[pe.message]).filter(Boolean))||[]:[]},[r]),c=m.useMemo(()=>{if(r==null)return[];const E=r[ze.tools];return Array.isArray(E)?E==null?void 0:E.map(Q=>Q[pe.tool]).filter(Boolean):[]},[r]),p=m.useMemo(()=>c.reduce((E,V)=>(V!=null&&V.json_schema&&E.push(V.json_schema),E),[]),[c]),y=m.useMemo(()=>{if(r==null)return[];const E=r[ze.output_messages];return Ki(E)?E.map(V=>V[pe.message]).filter(Boolean)||[]:[]},[r]),u=m.useMemo(()=>{if(r==null)return[];const E=r[ze.prompts];return tp(E)?E:[]},[r]),g=m.useMemo(()=>{if(r==null)return null;const E=r[ze.prompt_template];return E??null},[r]),f=m.useMemo(()=>r==null?"{}":r[ze.invocation_parameters]||"{}",[r]),k=m.useMemo(()=>o==null?null:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Tt,{spanKind:"llm"}),e(v,{size:"M",weight:"heavy",children:o})]}),[o]),b=t!=null&&t.value!=null,S=d.length>0,F=p.length>0,P=i!=null&&i.value!=null,D=y.length>0,w=u.length>0,K=Object.keys(we(f).json||{}).length>0,I=g!=null;return s(h,{direction:"column",gap:"size-200",children:[e(O,{collapsible:!0,backgroundColor:"light",borderColor:"light",bodyStyle:{padding:0},titleSeparator:!1,variant:"compact",title:k,children:s(He,{children:[S?e(ne,{name:"Input Messages",hidden:!S,children:e(Pi,{messages:d})}):null,F?e(ne,{name:"Tools",hidden:!F,children:e(Fh,{toolSchemas:p})}):null,b?e(ne,{name:"Input",hidden:!b,children:e(C,{padding:"size-200",children:e(nn,{children:e(O,{...ve,title:"LLM Input",extra:s(h,{direction:"row",gap:"size-100",children:[e(yn,{}),e(re,{text:t.value})]}),children:e(_n,{...t})})})})}):null,I?e(ne,{name:"Prompt Template",hidden:!I,children:e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-100",children:[e(C,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:s(dl,{text:g.template,children:[e(v,{color:"text-700",fontStyle:"italic",children:"prompt template"}),e(ro,{children:g.template})]})}),e(C,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:s(dl,{text:JSON.stringify(g.variables),children:[e(v,{color:"text-700",fontStyle:"italic",children:"template variables"}),e(qn,{children:JSON.stringify(g.variables)})]})})]})})}):null,e(ne,{name:"Prompts",hidden:!w,children:e(Kh,{prompts:u})}),e(ne,{name:"Invocation Params",hidden:!K,children:e(dl,{text:f,padding:"size-100",children:e(qn,{children:f})})})]})}),P||D?e(pt,{...ve,children:s(He,{children:[D?e(ne,{name:"Output Messages",hidden:!D,children:e(Pi,{messages:y})}):null,P?e(ne,{name:"Output",hidden:!P,children:e(C,{padding:"size-200",children:e(nn,{children:e(O,{...ve,title:"LLM Output",extra:s(h,{direction:"row",gap:"size-100",children:[e(yn,{}),e(re,{text:i.value})]}),children:e(_n,{...i})})})})}):null]})}):null]})}function fh(n){const{spanAttributes:a,span:l}=n,{input:t}=l,i=m.useMemo(()=>a[pe.retrieval]||null,[a]),r=m.useMemo(()=>{var y;return i==null?[]:((y=i[Mu.documents])==null?void 0:y.map(u=>u[pe.document]).filter(Boolean))||[]},[i]),o=m.useMemo(()=>l.documentEvaluations.reduce((u,g)=>{const f=g.documentPosition,k=u[f]||[];return{...u,[f]:[...k,g]}},{}),[l.documentEvaluations]),d=t!=null&&t.value!=null,c=r.length>0,p=l.documentRetrievalMetrics.length>0;return s(h,{direction:"column",gap:"size-200",children:[d?e(nn,{children:e(O,{title:"Input",...ve,extra:s(h,{direction:"row",gap:"size-100",children:[e(yn,{}),e(re,{text:t.value})]}),children:e(_n,{...t})})}):null,c?e(nn,{children:e(O,{title:"Documents",...ve,titleExtra:p&&e(h,{direction:"row",alignItems:"center",gap:"size-100",children:l.documentRetrievalMetrics.map(y=>s(H,{children:[e(Ze,{name:y.evaluationName,metric:"ndcg",score:y.ndcg},"ndcg"),e(Ze,{name:y.evaluationName,metric:"precision",score:y.precision},"precision"),e(Ze,{name:y.evaluationName,metric:"hit",score:y.hit},"hit")]}))}),extra:e(yn,{}),children:e("ul",{css:T`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
              `,children:r.map((y,u)=>e("li",{children:e(st,{document:y,documentEvaluations:o[u],borderColor:"seafoam-700",backgroundColor:"seafoam-100",labelColor:"seafoam-1000"})},u))})})}):null]})}function hh(n){const{spanAttributes:a}=n,l=m.useMemo(()=>a[pe.reranker]||null,[a]),t=m.useMemo(()=>l==null?null:l[jl.query]||null,[l]),i=m.useMemo(()=>{var c;return l==null?[]:((c=l[jl.input_documents])==null?void 0:c.map(p=>p[pe.document]).filter(Boolean))||[]},[l]),r=m.useMemo(()=>{var c;return l==null?[]:((c=l[jl.output_documents])==null?void 0:c.map(p=>p[pe.document]).filter(Boolean))||[]},[l]),o=i.length,d=r.length;return s(h,{direction:"column",gap:"size-200",children:[e(nn,{children:t&&e(O,{title:"Query",...ve,children:e(_a,{children:t})})}),e(O,{title:"Input Documents",titleExtra:e(un,{variant:"light",children:o}),...ve,defaultOpen:!1,bodyStyle:{padding:0},children:e("ul",{css:T`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:i.map((c,p)=>e("li",{children:e(st,{document:c,borderColor:"seafoam-700",backgroundColor:"seafoam-100",labelColor:"seafoam-1000"})},p))})}),e(O,{title:"Output Documents",titleExtra:e(un,{variant:"light",children:d}),...ve,bodyStyle:{padding:0},children:e("ul",{css:T`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:r.map((c,p)=>e("li",{children:e(st,{document:c,borderColor:"celery-700",backgroundColor:"celery-100",labelColor:"celery-1000"})},p))})})]})}function kh(n){const{spanAttributes:a}=n,l=m.useMemo(()=>a[pe.embedding]||null,[a]),t=m.useMemo(()=>{var o;return l==null?[]:((o=l[ql.embeddings])==null?void 0:o.map(d=>d[pe.embedding]).filter(Boolean))||[]},[l]),i=t.length>0,r=l==null?void 0:l[ql.model_name];return e(h,{direction:"column",gap:"size-200",children:i?e(O,{title:"Embeddings"+(typeof r=="string"?`: ${r}`:""),...ve,children:e("ul",{css:T`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
              `,children:t.map((o,d)=>e("li",{children:e(nn,{children:e(O,{...ve,backgroundColor:"purple-100",borderColor:"purple-700",title:"Embedded Text",children:e(_a,{children:o[ql.text]||""})})})},d))})}):e(io,{span:n.span})})}function bh(n){const{span:a,spanAttributes:l}=n,{input:t,output:i}=a,r=typeof(t==null?void 0:t.value)=="string",o=typeof(i==null?void 0:i.value)=="string",d=(t==null?void 0:t.mimeType)==="text",c=(i==null?void 0:i.mimeType)==="text",p=m.useMemo(()=>l[pe.tool]||{},[l]),y=Object.keys(p).length>0,u=p[ol.name],g=p[ol.description],f=p[ol.parameters];return!r&&!o&&!y?null:s(h,{direction:"column",gap:"size-200",children:[r?e(nn,{children:e(O,{title:"Input",...ve,extra:s(h,{direction:"row",gap:"size-100",children:[d?e(yn,{}):null,e(re,{text:t.value})]}),children:e(_n,{...t})})}):null,o?e(nn,{children:e(O,{title:"Output",...ve,backgroundColor:"green-100",borderColor:"green-700",extra:s(h,{direction:"row",gap:"size-100",children:[c?e(yn,{}):null,e(re,{text:i.value})]}),children:e(_n,{...i})})}):null,y?e(O,{title:"Tool"+(typeof u=="string"?`: ${u}`:""),...ve,children:s(h,{direction:"column",children:[g!=null?e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"light",children:s(h,{direction:"column",alignItems:"start",gap:"size-50",children:[e(v,{color:"text-700",fontStyle:"italic",children:"Description"}),e(v,{children:g})]})}):null,f!=null?e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",children:s(h,{direction:"column",alignItems:"start",width:"100%",children:[e(v,{color:"text-700",fontStyle:"italic",children:"Parameters"}),e(qn,{children:JSON.stringify(f)})]})}):null]})}):null]})}const Sh=["irrelevant","unrelated"];function st({document:n,documentEvaluations:a,backgroundColor:l,borderColor:t,labelColor:i}){const r=n[Ma.metadata],o=a&&a.length,d=n[Ma.content];return e(O,{...ve,backgroundColor:l,borderColor:t,bodyStyle:{padding:0},title:s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(_,{svg:e(ur,{})}),s(te,{level:4,children:["document ",n[Ma.id]]})]}),extra:typeof n[Ma.score]=="number"&&e(va,{color:i,children:`score ${Pt(n[Ma.score])}`}),children:s(h,{direction:"column",children:[d&&e(C,{padding:"size-200",children:e(_a,{children:d})}),r&&e(H,{children:e(C,{borderColor:t,borderTopWidth:"thin",children:e(qn,{children:JSON.stringify(r)})})}),o&&e(C,{borderColor:t,borderTopWidth:"thin",padding:"size-200",children:s(h,{direction:"column",gap:"size-100",children:[e(te,{level:3,weight:"heavy",children:"Evaluations"}),e("ul",{children:a.map((c,p)=>{const y=c.label&&Sh.includes(c.label)?"danger":i;return e("li",{children:e(C,{padding:"size-200",borderWidth:"thin",borderColor:t,borderRadius:"medium",children:s(h,{direction:"column",gap:"size-50",children:[s(h,{direction:"row",gap:"size-100",children:[e(v,{weight:"heavy",elementType:"h5",children:c.name}),c.label&&e(va,{color:y,shape:"badge",children:c.label}),typeof c.score=="number"&&e(va,{color:y,shape:"badge",children:s(h,{direction:"row",gap:"size-50",children:[e(v,{size:"XS",weight:"heavy",color:"inherit",children:"score"}),e(v,{size:"XS",children:An(c.score)})]})})]}),typeof c.explanation&&e("p",{css:T`
                                margin-top: var(
                                  --ac-global-dimension-static-size-100
                                );
                                margin-bottom: 0;
                              `,children:c.explanation})]})})},p)})})]})})]})})}function vh({message:n}){var d;const a=n[Ne.content],l=n[Ne.contents],t=((d=n[Ne.tool_calls])==null?void 0:d.map(c=>c[pe.tool_call]).filter(Boolean))||[],i=n[Ne.function_call_arguments_json]&&n[Ne.function_call_name],r=n[Ne.role]||"unknown",o=nl(r);return e(nn,{children:s(O,{...ve,...o,title:r+(n[Ne.name]?`: ${n[Ne.name]}`:""),extra:s(h,{direction:"row",gap:"size-100",children:[e(yn,{}),e(re,{text:a||JSON.stringify(n)})]}),children:[e(Pl,{children:l?e(Ph,{messageContents:l}):null}),s(h,{direction:"column",alignItems:"start",children:[a?e(_a,{children:a}):null,t.length>0?t.map((c,p)=>{var u,g,f;const y=we((u=c==null?void 0:c.function)==null?void 0:u.arguments);return s("pre",{css:T`
                      text-wrap: wrap;
                      margin: var(--ac-global-dimension-static-size-100) 0;
                    `,children:[(g=c==null?void 0:c.function)==null?void 0:g.name,"(",y.json?JSON.stringify(y.json,null,2):`${(f=c==null?void 0:c.function)==null?void 0:f.arguments}`,")"]},p)}):null,i?s("pre",{css:T`
                text-wrap: wrap;
                margin: var(--ac-global-dimension-static-size-100) 0;
              `,children:[n[Ne.function_call_name],"(",JSON.stringify(JSON.parse(n[Ne.function_call_arguments_json]),null,2),")"]}):null]})]})})}function Ch({toolSchema:n,index:a}){return e(O,{title:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Tt,{spanKind:"tool"}),e(v,{weight:"heavy",children:"Tool"})]}),titleExtra:s(un,{variant:"light",children:["#",a+1]}),...ve,backgroundColor:"yellow-100",borderColor:"yellow-700",bodyStyle:{padding:0},extra:e(re,{text:n}),children:e(_n,{value:n,mimeType:"json"})})}function Pi({messages:n}){return e("ul",{css:T`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,l)=>e("li",{children:e(vh,{message:a})},l))})}function Fh({toolSchemas:n}){return e("ul",{css:T`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,l)=>e("li",{children:e(Ch,{toolSchema:a,index:l})},l))})}function Kh({prompts:n}){return e("ul",{"data-testid":"llm-prompts-list",css:T`
        padding: var(--ac-global-dimension-size-200);
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-size-100);
      `,children:n.map((a,l)=>e("li",{children:e(C,{backgroundColor:"grey-100",borderColor:"grey-500",borderWidth:"thin",borderRadius:"medium",padding:"size-100",children:e(dl,{text:a,children:e(_n,{value:a,mimeType:"text"})})})},l))})}const Th=T`
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-size-200);
  flex-wrap: wrap;
`;function Ph({messageContents:n}){return e("ul",{css:Th,"data-testid":"message-content-list",children:n.map((a,l)=>e(xh,{messageContentAttribute:a},l))})}const Ih=T`
  flex: 1 1 100%;
`;function xh({messageContentAttribute:n}){var r;const{message_content:a}=n,l=a==null?void 0:a.text,t=a==null?void 0:a.image,i=(r=t==null?void 0:t.image)==null?void 0:r.url;return s("li",{css:l?Ih:null,children:[l?e("pre",{css:T`
            white-space: pre-wrap;
            padding: 0;
            margin: 0;
          `,children:l}):null,i?e(ih,{url:i}):null]})}function io({span:n}){const{input:a,output:l}=n,t=a==null&&l==null,i=(a==null?void 0:a.mimeType)==="text",r=(l==null?void 0:l.mimeType)==="text";return s(h,{direction:"column",gap:"size-200",children:[a&&a.value!=null?e(nn,{children:e(O,{title:"Input",...ve,extra:s(h,{direction:"row",gap:"size-100",children:[i?e(yn,{}):null,e(re,{text:a.value})]}),children:e(_n,{...a})})}):null,l&&l.value!=null?e(nn,{children:e(O,{title:"Output",...ve,backgroundColor:"green-100",borderColor:"green-700",extra:s(h,{direction:"row",gap:"size-100",children:[r?e(yn,{}):null,e(re,{text:l.value})]}),children:e(_n,{...l})})}):null,t?e(O,{title:"All Attributes",titleExtra:so,...ve,extra:e(re,{text:n.attributes}),children:e(qn,{children:n.attributes})}):null]})}const Dh=T`
  .cm-editor,
  .cm-gutters {
    background-color: transparent;
  }
`;function dl({text:n,children:a,padding:l}){const t=l?`var(--ac-global-dimension-${l})`:"0";return s("div",{css:T`
        position: relative;
        .copy-to-clipboard-button {
          transition: opacity 0.2s ease-in-out;
          opacity: 0;
          position: absolute;
          right: ${t};
          top: ${t};
          z-index: 1;
        }
        &:hover .copy-to-clipboard-button {
          opacity: 1;
        }
      `,children:[e(re,{text:n}),a]})}function qn({children:n}){const{theme:a}=En(),l=a==="light"?void 0:Xn,{value:t,mimeType:i}=m.useMemo(()=>{try{return{value:JSON.stringify(JSON.parse(n),null,2),mimeType:"json"}}catch{return{value:n,mimeType:"text"}}},[n]);return i==="json"?e(Yn,{value:t,basicSetup:{lineNumbers:!0,foldGutter:!0,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[fg(),jr.lineWrapping],editable:!1,theme:l,css:Dh}):e(ro,{children:t})}function ro({children:n}){return e("pre",{css:T`
        white-space: pre-wrap;
        padding: 0;
      `,children:n})}function _n({value:n,mimeType:a}){let l;switch(a){case"json":l=e(qn,{children:n});break;case"text":l=e(_a,{children:n});break;default:ke()}return l}function _h({text:n}){return s(h,{direction:"column",alignItems:"center",flex:"1 1 auto",height:"size-2400",justifyContent:"center",gap:"size-100",children:[e(yl,{graphicKey:"documents"}),e(v,{children:n})]})}function Lh({events:n}){return n.length===0?e(_h,{text:"No events"}):e(pl,{children:n.map((a,l)=>{const t=a.name==="exception";return e(ml,{children:s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(C,{flex:"none",children:e("div",{"data-event-type":t?"exception":"info",css:T`
                    &[data-event-type="exception"] {
                      --px-event-icon-color: var(--ac-global-color-danger);
                    }
                    &[data-event-type="info"] {
                      --px-event-icon-color: var(--ac-global-color-info);
                    }
                    .ac-icon-wrap {
                      color: var(--px-event-icon-color);
                    }
                  `,children:e(_,{svg:t?e(lp,{}):e(xn,{})})})}),s(h,{direction:"column",gap:"size-25",flex:"1 1 auto",children:[e(v,{weight:"heavy",children:a.name}),e(v,{color:"text-700",children:a.message})]}),e(C,{children:e(v,{color:"text-700",children:new Date(a.timestamp).toLocaleString()})})]})},l)})})}const so=e(h,{alignItems:"center",justifyContent:"center",children:e(C,{marginStart:"size-100",children:s(Ia,{children:[e(te,{weight:"heavy",level:4,children:"Span Attributes"}),e(Un,{children:e(v,{children:"Attributes are key-value pairs that represent metadata associated with a span. For detailed descriptions of specific attributes, consult the semantic conventions section of the OpenInference tracing specification."})}),e("footer",{children:e(en,{href:"https://github.com/Arize-ai/openinference/blob/main/spec/semantic_conventions.md",children:"Semantic Conventions"})})]})})}),Jl="selectedSpanNodeId";function wh(n){const a=n.find(i=>i.parentId==null);if(a)return a;const l=new Set(n.map(i=>i.context.spanId)),t=n.filter(i=>i.parentId!=null&&!l.has(i.parentId));return t.length===1?t[0]:null}function Zt(n){var u,g;const{traceId:a,projectId:l}=n,[t,i]=hn(),r=x.useLazyLoadQuery(Zs,{traceId:a,id:l},{fetchPolicy:"store-and-network"}),o=((u=r.project.trace)==null?void 0:u.latencyMs)!=null?r.project.trace.latencyMs:null,d=m.useMemo(()=>{var k;return(((k=r.project.trace)==null?void 0:k.spans.edges)||[]).map(b=>b.span)},[r]),p=t.get(Jl)??d[0].id,y=m.useMemo(()=>wh(d),[d]);return m.useEffect(()=>()=>{i(f=>(f.delete(Jl),f),{replace:!0})},[]),s("main",{css:T`
        flex: 1 1 auto;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      `,children:[e(Eh,{rootSpan:y,latencyMs:o,sessionId:(g=r.project.trace)==null?void 0:g.projectSessionId}),s(Pn,{direction:"horizontal",autoSaveId:"trace-panel-group",css:T`
          flex: 1 1 auto;
          overflow: hidden;
        `,children:[e(Le,{defaultSize:30,minSize:10,maxSize:70,children:e(Mh,{children:e(ip,{spans:d,selectedSpanNodeId:p,onSpanClick:f=>{i(k=>(k.set(Jl,f.id),k),{replace:!0})}})})}),e(Tn,{css:Wn}),e(Le,{children:e(Vh,{children:p?e(m.Suspense,{fallback:e(Ce,{}),children:e(ch,{spanNodeId:p,projectId:l})}):null})})]})]})}function Eh({rootSpan:n,latencyMs:a,sessionId:l}){const{projectId:t}=an(),{statusCode:i,spanAnnotations:r}=n??{statusCode:"UNSET",spanAnnotations:[]},o=r.length>0,d=cr(i);return e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:s(h,{direction:"row",gap:"size-400",alignItems:"center",children:[s(h,{direction:"column",children:[e(v,{elementType:"h3",size:"M",color:"text-700",children:"Trace Status"}),e(v,{size:"XL",children:s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(Tl,{statusCode:i}),e(v,{size:"L",color:d,children:i})]})})]}),s(h,{direction:"column",children:[e(v,{elementType:"h3",size:"M",color:"text-700",children:"Latency"}),e(v,{size:"XL",children:typeof a=="number"?e(Re,{latencyMs:a,size:"L"}):"--"})]}),o?s(h,{direction:"column",gap:"size-50",children:[e(v,{elementType:"h3",size:"M",color:"text-700",children:"Feedback"}),e(h,{direction:"row",gap:"size-50",children:r.map(c=>e(Da,{annotation:c,children:e(wn,{annotation:c,annotationDisplayPreference:"label"})},c.name))})]}):null,l&&e("span",{css:T`
              margin-left: auto;
            `,children:e(Qe,{to:`/projects/${t}/sessions/${l}`,children:s(h,{alignItems:"center",children:["View Session ",e(_,{svg:e(mr,{})})]})})})]})})}function Vh({children:n}){return e("div",{"data-testid":"scrolling-tabs-wrapper",css:T`
        height: 100%;
        overflow: hidden;
        .ac-tabs {
          height: 100%;
          overflow: hidden;
          .ac-tabs__extra {
            width: 100%;
            padding-right: var(--ac-global-dimension-size-200);
            padding-bottom: var(--ac-global-dimension-size-50);
          }
          .ac-tabs__pane-container {
            min-height: 100%;
            height: 100%;
            overflow-y: auto;
            div[role="tabpanel"] {
              height: 100%;
            }
          }
        }
      `,children:n})}function Mh({children:n}){return e("div",{"data-testid":"scrolling-panel-content",css:T`
        height: 100%;
        overflow-y: auto;
      `,children:n})}function _v(){const{traceId:n,projectId:a}=an(),l=se();return e(Y,{type:"slideOver",isDismissable:!0,onDismiss:()=>l(`/projects/${a}`),children:e(X,{size:"fullscreen",title:"Trace Details",children:e(Zt,{traceId:n,projectId:a})})})}function oo({traceId:n,projectId:a,title:l}){const t=se();return e(X,{title:l,size:"fullscreen",extra:e(M,{onPress:()=>t(`/projects/${a}/traces/${n}`),children:"View Trace in Project"}),children:e(Zt,{traceId:n,projectId:a})})}const Rh=n=>{const a=n;return On(a.function)?typeof a.function.arguments=="string":!1};function co({toolCall:n}){const a=m.useMemo(()=>{const{provider:l,validatedToolCall:t}=rp(n);switch(l){case"OPENAI":case"AZURE_OPENAI":return{name:t.function.name,input:t.function.arguments};case"ANTHROPIC":return{name:t.name,input:t.input};case"UNKNOWN":{if(!Rh(n))return null;const{json:i}=we(n.function.arguments);return{name:n.function.name??"",input:On(i)?i:n.function.arguments}}default:return ke()}},[n]);return a==null?s(v,{children:["Invalid tool call format: ",JSON.stringify(n)]}):s("pre",{css:T`
        text-wrap: wrap;
        margin: var(--ac-global-dimension-static-size-100) 0;
      `,children:[a.name,"(",typeof a.input=="string"?a.input:JSON.stringify(a.input,null,2),")"]})}const Ah=10,Nh=n=>n.examples.reduce((a,l)=>{const{datasetExampleId:t,result:i,experimentRunId:r}=l,o={experimentRunId:r};switch(i.__typename){case"ChatCompletionMutationError":return{...a,[t]:{...o,errorMessage:i.message}};case"ChatCompletionMutationPayload":{const{errorMessage:d,content:c,span:p,toolCalls:y}=i;return{...a,[t]:{...o,span:p,content:c,errorMessage:d,toolCalls:y.reduce((u,g)=>(u[g.id]=g,u),{})}}}case"%other":return a;default:ke()}},{}),zh=T`
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: center;
  height: 100%;
  min-height: 75px;
  padding: var(--ac-global-dimension-static-size-200);
  .controls {
    transition: opacity 0.2s ease-in-out;
    opacity: 0;
    display: none;
    z-index: 1;
  }
  &:hover .controls {
    opacity: 1;
    display: flex;
    // make them stand out
    button {
      border-color: var(--ac-global-color-primary);
    }
  }
`,$h=T`
  position: absolute;
  top: -4px;
  right: var(--ac-global-dimension-static-size-100);
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-static-size-100);
`;function uo(n){return s("div",{css:zh,children:[n.children,e("div",{css:$h,className:"controls",children:n.controls})]})}function mo({children:n}){return e("div",{css:T`
        max-height: 300px;
        overflow-y: auto;
        padding: var(--ac-global-dimension-static-size-100)
          var(--ac-global-dimension-static-size-200);
      `,children:n})}function Oh({getValue:n,collapseSingleKey:a}){const l=n();return e(mo,{children:e(Xa,{json:l,space:2,collapseSingleKey:a})})}function Qh({isRunning:n,instanceVariables:a,datasetExampleInput:l}){const t=m.useMemo(()=>{const i=On(l)?l:{};return a.filter(r=>i[r]==null)},[l,a]);return n?e(Ce,{}):t.length===0?null:e(Jt,{children:`Missing input for variable${t.length>1?"s":""}: ${t.join(", ")}`})}function jh({exampleData:n,setDialog:a}){const{span:l,content:t,toolCalls:i,errorMessage:r,experimentRunId:o}=n,d=l!=null,c=o!=null,p=m.useMemo(()=>{if(d||c)return s(H,{children:[c&&s(fe,{children:[e(M,{size:"S","aria-label":"View experiment run details",leadingVisual:e(_,{svg:e(Ba,{})}),onPress:()=>{m.startTransition(()=>{a(e(Hf,{runId:o}))})}}),e(Ve,{children:"View run details"})]}),d&&e(H,{children:s(fe,{children:[e(M,{size:"S","aria-label":"View run trace",leadingVisual:e(_,{svg:e(Fl,{})}),onPress:()=>{m.startTransition(()=>{a(e(oo,{traceId:l.context.traceId,projectId:l.project.id,title:"Experiment Run Trace"}))})}}),e(Ve,{children:"View Trace"})]})})]})},[o,c,d,a,l]);return e(uo,{controls:p,children:s(h,{direction:"column",gap:"size-200",children:[r!=null?e(Jt,{children:r}):null,e(v,{children:t}),i!=null?Object.values(i).map(y=>y==null?null:e(co,{toolCall:y},y.id)):null,d?e(Uh,{span:l}):null]})})}const qh=m.memo(function({isRunning:a,instanceId:l,exampleId:t,setDialog:i,instanceVariables:r,datasetExampleInput:o}){const d=ka(c=>{var p;return(p=c.exampleResponsesMap[l])==null?void 0:p[t]});return d==null?e(Qh,{isRunning:a,instanceVariables:r,datasetExampleInput:o}):e(jh,{exampleData:d,setDialog:i})});function Uh({span:n}){return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Jn,{tokenCountTotal:n.tokenCountTotal||0,tokenCountPrompt:n.tokenCountPrompt||0,tokenCountCompletion:n.tokenCountCompletion||0}),e(Re,{latencyMs:n.latencyMs||0})]})}function po({table:n}){return e("tbody",{children:n.getRowModel().rows.map(a=>e("tr",{children:a.getVisibleCells().map(l=>e("td",{style:{padding:0,height:1,width:`calc(var(--col-${l.column.id}-size) * 1px)`,wordBreak:"break-all"},children:Z(l.column.columnDef.cell,l.getContext())},l.id))},a.id))})}const Bh=Ie.memo(po,(n,a)=>n.table.options.data===a.table.options.data);function Hh({datasetId:n}){const a=x.useRelayEnvironment(),l=z($=>$.instances),t=z($=>$.allInstanceMessages),i=z($=>$.templateFormat),r=z($=>$.updateInstance),o=ka($=>$.updateExampleData),d=ka($=>$.setExampleDataForInstance),c=ka($=>$.resetExampleData),p=ka($=>$.appendExampleDataToolCallChunk),y=ka($=>$.appendExampleDataTextChunk),[u,g]=m.useState(null),[,f]=hn(),k=l.some($=>$.activeRunId!==null),b=Pa($=>$),S=z($=>$.markPlaygroundInstanceComplete),F=Gt(),P=Te(),D=m.useCallback($=>ie=>{var Ee;if(ie==null)return;const le=ie.chatCompletionOverDataset;switch(le.__typename){case"ChatCompletionSubscriptionExperiment":r({instanceId:$,patch:{experimentId:le.experiment.id},dirty:null});break;case"ChatCompletionSubscriptionResult":if(le.datasetExampleId==null)return;o({instanceId:$,exampleId:le.datasetExampleId,patch:{span:le.span,experimentRunId:(Ee=le.experimentRun)==null?void 0:Ee.id}});break;case"ChatCompletionSubscriptionError":if(le.datasetExampleId==null)return;o({instanceId:$,exampleId:le.datasetExampleId,patch:{errorMessage:le.message}});break;case"TextChunk":if(le.datasetExampleId==null)return;y({instanceId:$,exampleId:le.datasetExampleId,textChunk:le.content});break;case"ToolCallChunk":{if(le.datasetExampleId==null)return;p({instanceId:$,exampleId:le.datasetExampleId,toolCallChunk:le});break}case"%other":return;default:return ke()}},[y,p,o,r]),[w]=x.useMutation(qs),K=m.useCallback($=>(ie,le)=>{if(S($),le){P({title:"Chat completion failed",message:le[0].message});return}r({instanceId:$,patch:{experimentId:ie.chatCompletionOverDataset.experimentId},dirty:null}),d({instanceId:$,data:Nh(ie.chatCompletionOverDataset)})},[S,P,d,r]);m.useEffect(()=>{if(!k)return;const{instances:$,streaming:ie,updateInstance:le}=F.getState();if(c(),ie){const Ee=[];for(const _e of $){const{activeRunId:zl}=_e;if(le({instanceId:_e.id,patch:{experimentId:null},dirty:null}),zl===null)continue;const $l={input:ki({credentials:b,instanceId:_e.id,playgroundStore:F,datasetId:n})},Ol={subscription:Us,variables:$l,onNext:D(_e.id),onCompleted:()=>{S(_e.id)},onError:ya=>{S(_e.id);const Ql=gr(ya);Ql!=null&&Ql.length>0?P({title:"Failed to get output",message:Ql.join(`
`),expireMs:1e4}):P({title:"Failed to get output",message:ya.message,expireMs:1e4})}},ll=Ja.requestSubscription(a,Ol);Ee.push(ll)}return()=>{for(const _e of Ee)_e.dispose()}}else{const Ee=[];for(const _e of $){const{activeRunId:zl}=_e;if(zl===null)continue;le({instanceId:_e.id,patch:{experimentId:null},dirty:null});const $l={input:ki({credentials:b,instanceId:_e.id,playgroundStore:F,datasetId:n})},Ol=w({variables:$l,onCompleted:K(_e.id),onError(ll){S(_e.id);const ya=Pe(ll);ya!=null&&ya.length>0?P({title:"Failed to get output",message:ya.join(`
`),expireMs:1e4}):P({title:"Failed to get output",message:ll.message,expireMs:1e4})}});Ee.push(Ol)}return()=>{for(const _e of Ee)_e.dispose()}}},[b,n,a,w,k,S,P,K,D,F,c]);const{dataset:I}=x.useLazyLoadQuery(Gs,{datasetId:n}),E=m.useRef(null),{data:V,loadNext:Q,hasNext:R,isLoadingNext:q}=x.usePaginationFragment(Hs,I),ee=m.useMemo(()=>V.examples.edges.map($=>{const ie=$.example,le=ie.revision;return{id:ie.id,input:le.input,output:le.output}}),[V]),ge=m.useMemo(()=>l.map(($,ie)=>{const le=wl($,t),Ee=es({instance:le,templateFormat:i});return{id:`instance-${$.id}`,header:()=>s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(It,{index:ie}),e("span",{children:"Output"})]}),cell:({row:_e})=>e(qh,{instanceId:$.id,exampleId:_e.original.id,isRunning:k,setDialog:g,instanceVariables:Ee,datasetExampleInput:_e.original.input}),size:500}}),[k,l,i,t]),he=[{header:"input",accessorKey:"input",cell:({row:$})=>e(uo,{controls:s(fe,{children:[e(M,{size:"S","aria-label":"View example details",leadingVisual:e(_,{svg:e(Ba,{})}),onPress:()=>{f(ie=>(ie.set("exampleId",$.original.id),ie))}}),e(Ve,{children:"View Example"})]}),children:e(mo,{children:e(Xa,{json:$.original.input,disableTitle:!0,space:2,collapseSingleKey:!1})})}),size:200},{header:"reference output",accessorKey:"output",cell:$=>Oh({...$,collapseSingleKey:!0}),size:200},...ge],N=xe({columns:he,data:ee,getCoreRowModel:De(),columnResizeMode:"onChange"}),A=N.getRowModel().rows.length===0,U=m.useCallback($=>{if($){const{scrollHeight:ie,scrollTop:le,clientHeight:Ee}=$;ie-le-Ee<300&&!q&&R&&Q(Ah)}},[R,q,Q]),oe=Ie.useMemo(()=>{const $=N.getFlatHeaders(),ie={};for(let le=0;le<$.length;le++){const Ee=$[le];ie[`--header-${Ee.id}-size`]=Ee.getSize(),ie[`--col-${Ee.column.id}-size`]=Ee.column.getSize()}return ie},[N.getState().columnSizingInfo,N.getState().columnSizing,he.length]);return s("div",{css:T`
        flex: 1 1 auto;
        overflow: auto;
        height: 100%;
      `,ref:E,onScroll:$=>U($.target),children:[s("table",{css:T(tn,pr),style:{...oe,width:N.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:N.getHeaderGroups().map($=>e("tr",{children:$.headers.map(ie=>s("th",{style:{width:`calc(var(--header-${ie==null?void 0:ie.id}-size) * 1px)`},children:[e("div",{children:Z(ie.column.columnDef.header,ie.getContext())}),e("div",{onMouseDown:ie.getResizeHandler(),onTouchStart:ie.getResizeHandler(),className:`resizer ${ie.column.getIsResizing()?"isResizing":""}`})]},ie.id))},$.id))}),A?e(rn,{}):N.getState().columnSizingInfo.isResizingColumn?e(Bh,{table:N}):e(po,{table:N})]}),e(Y,{isDismissable:!0,type:"slideOver",onDismiss:()=>{g(null)},children:u})]})}function Gh({datasetId:n}){const a=z(o=>o.instances),l=a.some(o=>o.activeRunId!=null),t=m.useMemo(()=>a.map(o=>o.experimentId).filter(o=>o!=null),[a]),i=se(),r=x.useLazyLoadQuery(js,{datasetId:n});return s(h,{direction:"column",height:"100%",children:[e(C,{flex:"none",backgroundColor:"dark",paddingX:"size-200",paddingY:"size-100",borderBottomColor:"light",borderBottomWidth:"thin",height:50,children:s(h,{justifyContent:"space-between",alignItems:"center",height:"100%",children:[s(h,{gap:"size-100",children:[s(v,{children:[r.dataset.name??"Dataset"," results"]}),r.dataset.exampleCount!=null?s(v,{fontStyle:"italic",color:"text-700",children:[r.dataset.exampleCount," examples"]}):null]}),t.length>0&&s(M,{size:"S",isDisabled:l,leadingVisual:e(_,{svg:l?e(ln,{}):e(yr,{})}),onPress:()=>{i(`/datasets/${n}/compare?experimentId=${t.join("&experimentId=")}`)},children:["View Experiment",a.length>1?"s":""]})]})}),e(Bf,{children:e(Hh,{datasetId:n})})]})}const Wh=()=>{const n=z(d=>d.input),a=z(d=>d.instances),l=z(d=>d.allInstanceMessages),t=z(d=>d.templateFormat),i=m.useMemo(()=>a.map(d=>wl(d,l)),[a,l]),{variableKeys:r,variablesMap:o}=m.useMemo(()=>ns({instances:i,templateFormat:t,input:n}),[n,i,t]);return{variableKeys:r,variablesMap:o}},Jh={lineNumbers:!1,highlightActiveLine:!1,foldGutter:!1,highlightActiveLineGutter:!1,bracketMatching:!1,syntaxHighlighting:!1,defaultKeymap:!1},Zh=[jr.lineWrapping,At.of([...hg.filter(n=>n.key!=="Mod-Enter")])],Xh=({label:n,defaultValue:a,onChange:l})=>{const{theme:t}=En(),i=m.useRef(a),[r,o]=m.useState(0),[d,c]=m.useState(()=>a);return m.useEffect(()=>{a==null&&(c(""),o(y=>y+1)),i.current=a},[a]),m.useEffect(()=>{c(i.current),o(y=>y+1)},[n]),e(Bn,{label:n,children:e(Be,{width:"100%",children:e(Yn,{theme:t==="light"?kg:Xn,basicSetup:Jh,value:d,extensions:Zh,onChange:l},r)})})};function Yh(){const{variableKeys:n,variablesMap:a}=Wh(),l=z(i=>i.setVariableValue),t=z(i=>i.templateFormat);if(n.length===0){let i="";switch(t){case We.FString:{i="{input name}";break}case We.Mustache:{i="{{input name}}";break}case We.NONE:return null;default:ke()}return e(C,{padding:"size-100",children:e(h,{direction:"column",justifyContent:"center",alignItems:"center",children:s(v,{color:"text-700",children:["Add variable inputs to your prompt using"," ",e(v,{color:"text-900",children:i})," within your prompt template."]})})})}return e(h,{direction:"column",gap:"size-200",width:"100%",children:n.map((i,r)=>e(Xh,{label:i,defaultValue:a[i]??"",onChange:o=>l(i,o)},r))})}const go=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionMutationPayload",kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[a,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputMutation",selections:l},params:{cacheID:"9dc63d3e40081b276c1cbd5f21405c6f",id:null,metadata:{},name:"PlaygroundOutputMutation",operationKind:"mutation",text:`mutation PlaygroundOutputMutation(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    content
    errorMessage
    span {
      id
    }
    toolCalls {
      id
      function {
        name
        arguments
      }
    }
  }
}
`}}}();go.hash="085e7cb2bebd2c6c6e44b511364c6dd9";const yo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null}],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputSubscription",selections:l,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputSubscription",selections:l},params:{cacheID:"aca7bf342ad2dc5db66b07e236a68268",id:null,metadata:{},name:"PlaygroundOutputSubscription",operationKind:"subscription",text:`subscription PlaygroundOutputSubscription(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    ... on TextChunk {
      content
    }
    ... on ToolCallChunk {
      id
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionResult {
      span {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      message
    }
  }
}
`}}}();yo.hash="bb5936a61a0e99dbb4a298a6e552a01c";const e0=({instance:n,outputContent:a,toolCalls:l,cleanupOutput:t})=>{const i=n.id,r=z(o=>o.addMessage);return s(fe,{delay:500,offset:10,children:[e(M,{size:"S",leadingVisual:e(_,{svg:e(bn,{})}),"aria-label":"Move the output message to the end of the prompt",onPress:()=>{if(n.template.__type!=="chat")return;const o=Array.isArray(a)?a:a?[{id:$n(),role:Nn("ai"),content:a}]:[];l.length>0&&o.push({id:$n(),role:Nn("ai"),toolCalls:fr({provider:n.model.provider,toolCalls:l.map(d=>{var c;return{...d,function:{...d.function,arguments:((c=we(d.function.arguments))==null?void 0:c.json)??d.function.arguments}}})})}),r({playgroundInstanceId:i,messages:o}),t()},children:"Prompt"}),e(Ve,{children:"Move the output message to the end of the prompt"})]})},fo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"bee4b51bd781a58c87fd283a966776f6",id:null,metadata:{},name:"RunMetadataFooterQuery",operationKind:"query",text:`query RunMetadataFooterQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    id
    ... on Span {
      project {
        id
      }
      context {
        traceId
        spanId
      }
      tokenCountCompletion
      tokenCountPrompt
      tokenCountTotal
      latencyMs
    }
  }
}
`}}}();fo.hash="c89cb87e785645bbf42e3eadbacc4fc0";function n0({spanId:n}){const[a,l]=m.useState(null),t=x.useLazyLoadQuery(fo,{spanId:n});if(!t.span||!t.span.project||!t.span.context)return null;const{project:i,context:{traceId:r}}=t.span;return s(C,{borderTopColor:"light",borderTopWidth:"thin",paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",children:[s(h,{direction:"row",gap:"size-200",justifyContent:"space-between",children:[s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Jn,{tokenCountTotal:t.span.tokenCountTotal||0,tokenCountPrompt:t.span.tokenCountPrompt||0,tokenCountCompletion:t.span.tokenCountCompletion||0}),e(Re,{latencyMs:t.span.latencyMs||0})]}),s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(M,{size:"S",leadingVisual:e(_,{svg:e(Cl,{})}),onPress:()=>l(e(dr,{spanNodeId:n,projectId:i.id})),children:"Annotate"}),e(M,{size:"S",leadingVisual:e(_,{svg:e(Fl,{})}),onPress:()=>{m.startTransition(()=>{l(e(m.Suspense,{children:e(oo,{traceId:r,projectId:i.id,title:"Playground Trace"})}))})},children:"View Trace"})]})]}),e(Y,{type:"slideOver",isDismissable:!0,onDismiss:()=>l(null),children:a})]})}function a0({index:n,title:a}){return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(It,{index:n}),e("span",{children:a})]})}const l0=n=>On(n)&&(typeof n.id=="string"||typeof n.id=="number")?n.id:JSON.stringify(n);function Ii({message:n}){const{role:a,content:l,toolCalls:t}=n,i=nl(a);return s(O,{title:a,...i,variant:"compact",extra:e(yn,{}),children:[l!=null&&!Array.isArray(l)&&e(_a,{children:l}),t&&t.length>0?t.map(r=>e(co,{toolCall:r},l0(r))):null]})}function t0({content:n,partialToolCalls:a}){return dy(n)?n.map((l,t)=>e(Ii,{message:l},t)):typeof n=="string"||a.length>0?e(Ii,{message:{id:$n(),content:n,role:"ai",toolCalls:a}}):"click run to see output"}function i0(n){const a=n.playgroundInstanceId,l=z(R=>R.instances),t=z(R=>R.streaming),i=Pa(R=>R),r=z(R=>R.instances.findIndex(q=>q.id===a)),o=l.find(R=>R.id===a),d=z(R=>R.updateInstance),[c,p]=m.useState(null),y=z(R=>R.markPlaygroundInstanceComplete),u=x.useRelayEnvironment(),g=Gt();if(!o)throw new Error(`No instance found for id ${a}`);if(o.template.__type!=="chat")throw new Error("We only support chat templates for now");const[f,k]=m.useState(!1),[b]=x.useMutation(go),S=(o==null?void 0:o.activeRunId)!=null,F=Te(),P=m.useCallback(({title:R,message:q,...ee})=>{p({title:R,message:q}),F({title:R,message:q,...ee})},[F]),[D,w]=m.useState(o.output),[K,I]=m.useState([]),E=m.useCallback(({chatCompletion:R})=>{if(k(!1),R.__typename==="TextChunk"){const q=R.content;w(ee=>ee!=null?ee+q:q);return}else if(R.__typename==="ToolCallChunk"){I(q=>{let ee=!1;const ge=q.map(he=>he.id===R.id?(ee=!0,{...he,function:{...he.function,arguments:he.function.arguments+R.function.arguments}}):he);return ee||ge.push({id:R.id,function:{name:R.function.name,arguments:R.function.arguments}}),ge});return}if(R.__typename==="ChatCompletionSubscriptionResult"&&R.span!=null){d({instanceId:a,patch:{spanId:R.span.id},dirty:null});return}R.__typename==="ChatCompletionSubscriptionError"&&(y(n.playgroundInstanceId),R.message!=null&&P({title:"Chat completion failed",message:R.message}))},[a,y,P,n.playgroundInstanceId,d]),V=m.useCallback((R,q)=>{if(k(!1),y(n.playgroundInstanceId),d({instanceId:a,patch:{spanId:R.chatCompletion.span.id},dirty:null}),q){P({title:"Chat completion failed",message:q[0].message});return}if(R.chatCompletion.errorMessage!=null){P({title:"Chat completion failed",message:R.chatCompletion.errorMessage});return}w(R.chatCompletion.content??void 0),I(R.chatCompletion.toolCalls)},[a,y,P,n.playgroundInstanceId,d]),Q=m.useCallback(()=>{w(void 0),I([]),p(null),d({instanceId:a,patch:{spanId:null},dirty:null})},[a,d]);return m.useEffect(()=>{if(!S){k(!1);return}k(!0),Q();const R=hy({playgroundStore:g,instanceId:a,credentials:i});if(t){const ee={subscription:yo,variables:{input:R},onNext:he=>{he&&E(he)},onCompleted:()=>{k(!1),y(n.playgroundInstanceId)},onError:he=>{k(!1),y(n.playgroundInstanceId);const N=gr(he);N!=null&&N.length>0?P({title:"Failed to get output",message:N.join(`
`)}):P({title:"Failed to get output",message:he.message})}};return Ja.requestSubscription(u,ee).dispose}return b({variables:{input:R},onCompleted:V,onError(ee){k(!1),y(n.playgroundInstanceId);const ge=Pe(ee);ge!=null&&ge.length>0?P({title:"Failed to get output",message:ge.join(`
`)}):P({title:"Failed to get output",message:ee.message})}}).dispose},[Q,i,u,b,S,a,y,P,V,E,g,n.playgroundInstanceId,t,d]),e(O,{title:e(a0,{index:r,title:"Output"}),extra:D!=null||(K==null?void 0:K.length)>0?e(e0,{outputContent:D,toolCalls:K,instance:o,cleanupOutput:Q}):null,titleSeparator:!0,collapsible:!0,variant:"compact",bodyStyle:{padding:0},children:f?e(C,{padding:"size-200",children:e(Ce,{message:"Running..."})}):c?e(C,{padding:"size-200",children:e(Jt,{children:c.message})}):s(H,{children:[e(C,{padding:"size-200",children:e(nn,{children:e(t0,{content:D,partialToolCalls:K})})}),e(m.Suspense,{children:o.spanId?e(n0,{spanId:o.spanId}):null})]})})}function r0(){return m.useMemo(()=>window.navigator.userAgent.toLowerCase().includes("mac")?"Cmd":"Ctrl",[])}function s0(){const n=r0(),a=z(r=>r.runPlaygroundInstances),l=z(r=>r.cancelPlaygroundInstances),t=z(r=>r.instances.some(o=>o.activeRunId!=null)),i=m.useCallback(()=>{t?l():a()},[t,l,a]);return Ru("mod+enter",r=>{r.preventDefault(),r.stopPropagation(),i()},{enableOnFormTags:!0,enableOnContentEditable:!0,preventDefault:!0}),e(M,{variant:"primary",leadingVisual:e(_,{svg:t?e(ln,{}):e(pa,{})}),size:"S",onPress:()=>{i()},trailingVisual:s(sp,{children:[e(lt,{children:n}),e("span",{"aria-hidden":"true",children:n==="Cmd"?"⌘":"Ctrl"}),e(lt,{children:"enter"}),e("span",{"aria-hidden":"true",children:"⏎"})]}),children:t?"Cancel":"Run"})}function o0(){const n=z(i=>i.streaming),a=z(i=>i.setStreaming),l=Ge(i=>i.setPlaygroundStreamingEnabled),t=z(i=>i.instances.some(r=>r.activeRunId!=null));return window.Config.websocketsEnabled===!1?null:e(xa,{labelPlacement:"start",isSelected:n,onChange:()=>{a(!n),l(!n)},isDisabled:t,children:"Stream"})}const ho=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"createChatPromptVersion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UpsertPromptFromTemplateDialogUpdateMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UpsertPromptFromTemplateDialogUpdateMutation",selections:a},params:{cacheID:"5560d38314208ef482b716e9817358fe",id:null,metadata:{},name:"UpsertPromptFromTemplateDialogUpdateMutation",operationKind:"mutation",text:`mutation UpsertPromptFromTemplateDialogUpdateMutation(
  $input: CreateChatPromptVersionInput!
) {
  createChatPromptVersion(input: $input) {
    id
    name
  }
}
`}}}();ho.hash="96205130072396cb213f4fa790a7a6b1";const ko=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"createChatPrompt",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UpsertPromptFromTemplateDialogCreateMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UpsertPromptFromTemplateDialogCreateMutation",selections:a},params:{cacheID:"73d9d27e0df3bc27e4af4dd3d77f41fb",id:null,metadata:{},name:"UpsertPromptFromTemplateDialogCreateMutation",operationKind:"mutation",text:`mutation UpsertPromptFromTemplateDialogCreateMutation(
  $input: CreateChatPromptInput!
) {
  createChatPrompt(input: $input) {
    id
    name
  }
}
`}}}();ko.hash="fa52cba6c2bfaa6298a5360253dc9bc5";const bo=function(){var n=[{alias:null,args:null,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SavePromptFormQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SavePromptFormQuery",selections:n},params:{cacheID:"654725a48bf8fb568b8e05fd37696920",id:null,metadata:{},name:"SavePromptFormQuery",operationKind:"query",text:`query SavePromptFormQuery {
  prompts {
    edges {
      prompt: node {
        id
        name
      }
    }
  }
}
`}}}();bo.hash="a9d184ea6bad7c7ff3b15460ce72b9fd";const So=function(){var n=[{alias:null,args:null,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptComboBoxQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PromptComboBoxQuery",selections:n},params:{cacheID:"72f4804265380881fdc62b5d8e66bb8b",id:null,metadata:{},name:"PromptComboBoxQuery",operationKind:"query",text:`query PromptComboBoxQuery {
  prompts {
    edges {
      prompt: node {
        __typename
        id
        name
      }
    }
  }
}
`}}}();So.hash="1acc413e40da1ea527fb431f10b46cf2";function vo({onChange:n,container:a,promptId:l,...t}){const r=x.useLazyLoadQuery(So,{},{fetchPolicy:"store-and-network",fetchKey:l??void 0}).prompts.edges,o=m.useMemo(()=>r.map(d=>d.prompt),[r]);return e(Dt,{size:"M","data-testid":"prompt-picker",selectedKey:l??null,"aria-label":"prompt picker",width:"100%",menuTrigger:"focus",stopPropagation:!0,container:a,defaultItems:o,placeholder:"Select a prompt...",renderEmptyState:()=>e("div",{children:"No prompts found"}),onSelectionChange:d=>{if(!(typeof d!="string"&&d!=null)){if(d===l){n(null);return}n(d)}},...t,children:d=>e(xt,{textValue:d.name,id:d.id,children:d.name},d.id)})}const d0=/^[a-z0-9]([_a-z0-9-]*[a-z0-9])?$/,Co={value:d0,message:"Invalid identifier. Must be alphanumeric and with dashes or underscores"};function c0({onCreate:n,onUpdate:a,isSubmitting:l=!1,defaultSelectedPromptId:t}){var D,w,K,I;const i=m.useRef(null),r=x.useLazyLoadQuery(bo,{},{fetchPolicy:"network-only"}),[o,d]=m.useState(t??null),c=(w=(D=r==null?void 0:r.prompts)==null?void 0:D.edges)==null?void 0:w.find(E=>{var V;return((V=E==null?void 0:E.prompt)==null?void 0:V.id)===o}),[p,y]=m.useState(((K=c==null?void 0:c.prompt)==null?void 0:K.name)??""),u=c?"update":"create",g=u==="create"?"Create Prompt":"Update Prompt",{control:f,handleSubmit:k,formState:{isDirty:b,isValid:S},trigger:F}=Ae({values:{promptId:o??void 0,name:u==="update"&&c?(I=c==null?void 0:c.prompt)==null?void 0:I.name:p},defaultValues:{description:""},reValidateMode:"onChange",resetOptions:{keepDefaultValues:!0}}),P=m.useCallback(E=>{u==="create"?n(E):a(E)},[n,a,u]);return s(h,{direction:"column",gap:"size-100",ref:i,children:[e(C,{paddingX:"size-200",paddingTop:"size-200",children:e(G,{name:"name",control:f,rules:{required:{message:"Prompt is required",value:!0},pattern:Co},render:({field:{onBlur:E,onChange:V},fieldState:Q})=>{var R;return e(vo,{label:"Prompt",description:"The prompt to update, or prompt name to create",placeholder:"Select or enter new prompt name",isRequired:!0,onBlur:E,defaultInputValue:p,onInputChange:q=>{y(q),V(q),F("name")},container:i.current??void 0,errorMessage:(R=Q.error)==null?void 0:R.message,allowsCustomValue:!0,onChange:q=>{V(q),d(q)},promptId:o})}})}),s(Xe,{onSubmit:k(P),children:[e(C,{paddingX:"size-200",paddingBottom:"size-200",children:e(G,{name:"description",control:f,render:({field:{onChange:E,onBlur:V,value:Q},fieldState:{invalid:R,error:q}})=>s(J,{isInvalid:R,onChange:E,onBlur:V,value:Q,size:"S",children:[e(W,{children:u==="create"?"Prompt Description":"Change Description"}),e(ca,{}),q?e(Fe,{children:q.message}):e(v,{slot:"description",children:u==="create"?"A description of your prompt (optional)":"A description of your changes to the prompt (optional)"})]})})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{variant:b?"primary":"default",size:"S",isDisabled:l||!S,type:"submit",children:g})})})]})]})}const xi=(n,a)=>{const l=a.getState(),t=l.allInstanceMessages,i=l.instances.find(c=>c.id===n);if(!i)throw new Error(`Instance ${n} not found`);const r=wl(i,t),o=Kf(r);if(!o)throw new Error(`Could not convert instance ${n} to prompt`);const d=l.templateFormat;return{promptInput:o,templateFormat:d}},u0=({instanceId:n,setDialog:a,selectedPromptId:l})=>{const t=se(),i=Se(),r=Te(),o=Gt(),[d,c]=x.useMutation(ko),[p,y]=x.useMutation(ho),u=m.useCallback((k,b)=>{const S=o.getState();S.instances.find(P=>P.id===n)&&S.updateInstance({instanceId:n,patch:{prompt:{id:k,name:b}},dirty:!1})},[o,n]),g=m.useCallback(k=>{const{promptInput:b,templateFormat:S}=xi(n,o);d({variables:{input:{name:k.name,description:k.description,promptVersion:{...b,templateFormat:S}}},onCompleted:F=>{i({title:"Prompt successfully created",action:{text:"View Prompt",onClick:()=>{t(`/prompts/${F.createChatPrompt.id}`)}}}),u(F.createChatPrompt.id,F.createChatPrompt.name),a(null)},onError:F=>{const P=Pe(F);r({title:"Error creating prompt",message:P==null?void 0:P[0]}),a(null)}})},[d,n,t,r,i,u,a,o]),f=m.useCallback(k=>{if(!k.promptId)throw new Error("Prompt ID is required");const{promptInput:b,templateFormat:S}=xi(n,o);p({variables:{input:{promptId:k.promptId,promptVersion:{...b,templateFormat:S,description:k.description}}},onCompleted:F=>{i({title:"Prompt successfully updated",action:{text:"View Prompt",onClick:()=>{t(`/prompts/${F.createChatPromptVersion.id}`)}}}),u(F.createChatPromptVersion.id,F.createChatPromptVersion.name),a(null)},onError:F=>{const P=Pe(F);r({title:"Error updating prompt",message:P==null?void 0:P[0]}),a(null)}})},[n,t,r,i,a,o,p,u]);return e(X,{title:"Create Prompt from Template",children:e(m.Suspense,{fallback:e(Ce,{}),children:e(c0,{onCreate:g,onUpdate:f,isSubmitting:c||y,defaultSelectedPromptId:l})})})},Fo={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelConfigButtonDialogQuery",selections:[{args:null,kind:"FragmentSpread",name:"ModelProviderPickerFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ModelConfigButtonDialogQuery",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}]},params:{cacheID:"64ad561d3ca07bdded6af274c73eb18a",id:null,metadata:{},name:"ModelConfigButtonDialogQuery",operationKind:"query",text:`query ModelConfigButtonDialogQuery {
  ...ModelProviderPickerFragment
}

fragment ModelProviderPickerFragment on Query {
  modelProviders {
    key
    name
    dependenciesInstalled
    dependencies
  }
}
`}};Fo.hash="4b1b96842c19ea5721b7fcf1cdb86426";function m0({defaultValue:n,onChange:a,label:l,errorMessage:t}){const[i,r]=m.useState(n==null?"":In(n).json??""),o=m.useCallback(d=>{r(d);const{json:c}=we(d);c==null&&d!==""||a(c)},[a]);return e("div",{css:T`
        & .ac-view {
          width: 100%;
        }
      `,children:e(Bn,{label:l,errorMessage:t,validationState:t?"invalid":void 0,children:e(Be,{children:e(je,{value:i,onChange:o,optionalLint:!0})})})})}const p0=({field:n,value:a,onChange:l,errors:t,control:i})=>{var u;const r=n.invocationName;if(!r)throw new Error("Invocation name is required");const o=(u=t[r])==null?void 0:u.message,d=n.required?`${n.label||r} is required`:void 0,c=n.minValue!=null?`${n.label||r} must be at least ${n.minValue}`:void 0,p=n.maxValue!=null?`${n.label||r} must be at most ${n.maxValue}`:void 0,{__typename:y}=n;switch(y){case"InvocationParameterBase":return null;case"BoundedFloatInvocationParameter":return typeof a!="number"&&a!==void 0?null:e(lm,{label:n.label,isRequired:n.required,defaultValue:a,step:.1,minValue:n.minValue,maxValue:n.maxValue,onChange:g=>l(g)});case"FloatInvocationParameter":case"IntInvocationParameter":return e(G,{control:i,name:r,rules:{required:d,min:c,max:p},render:({field:{onBlur:g}})=>s(J,{isRequired:n.required,value:(a==null?void 0:a.toString())||"",type:"number",onBlur:g,onChange:f=>{if(f===""){l(void 0);return}l(Number(f))},children:[e(W,{children:n.label}),e(ae,{}),o?e(Fe,{children:o}):null]})});case"StringListInvocationParameter":return!Array.isArray(a)&&a!==void 0?null:e(G,{control:i,name:r,rules:{required:d},render:({field:{onBlur:g}})=>s(J,{isRequired:n.required,defaultValue:(a==null?void 0:a.join(", "))??"",onBlur:g,onChange:f=>{if(f===""){l(void 0);return}l(f.split(/, */g))},children:[e(W,{children:n.label}),e(ae,{}),o?e(Fe,{children:o}):e(v,{slot:"description",children:"A comma separated list of strings"})]})});case"StringInvocationParameter":return e(G,{control:i,name:r,rules:{required:d},render:({field:{onBlur:g}})=>s(J,{isRequired:n.required,defaultValue:(a==null?void 0:a.toString())||"",type:"text",onBlur:g,onChange:f=>{if(f===""){l(void 0);return}l(f)},children:[e(W,{children:n.label}),e(ae,{}),o?e(Fe,{children:o}):null]})});case"BooleanInvocationParameter":return e(xa,{onChange:l,defaultSelected:!!a,children:n.label});case"JSONInvocationParameter":return e(G,{control:i,name:r,rules:{required:d},render:()=>e(m0,{defaultValue:a,onChange:l,label:n.label??n.invocationName??"",errorMessage:o})});default:return null}},g0=(n,a)=>{if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return a[Va(n.invocationInputField)]},y0=(n,a)=>{if(n.invocationName===void 0)throw new Error("Invocation name is required");if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return{invocationName:n.invocationName,canonicalName:n.canonicalName,[Va(n.invocationInputField)]:a}},f0=({instanceId:n})=>{const a=z(f=>f.instances.find(k=>k.id===n));if(!a)throw new Error("Instance not found");const{model:l}=a,t=z(f=>f.upsertInvocationParameterInput),i=z(f=>f.deleteInvocationParameterInput),r=a.model.supportedInvocationParameters,o=a.model.invocationParameters,d=m.useCallback((f,k)=>{if(!f.invocationName)throw new Error("Invocation name is required");k===void 0?i({instanceId:n,invocationParameterInputInvocationName:f.invocationName}):t({instanceId:n,invocationParameterInput:y0(f,k)})},[n,t,i]),c=m.useMemo(()=>r.filter(f=>!(f.canonicalName!=null&&Vg.includes(f.canonicalName))).reduce((f,k)=>{const b=o.find(F=>jn(F,k)),S=b?g0(k,b):void 0;return{...f,[k.invocationName]:S??null}},{}),[o,r]),p=Ae({values:c,mode:"onBlur",delayError:0,shouldFocusError:!1,resetOptions:{keepErrors:!0}}),y=p.trigger,u=m.useMemo(()=>cn.debounce(y,250),[y]);return m.useEffect(()=>{u()},[c,u]),l.provider!=="AZURE_OPENAI"&&l.modelName===null?null:Object.entries(c).map(([f,k])=>{const b=r.find(F=>F.invocationName===f);if(!b)return null;const S=`${l.provider??"model"}-${b.invocationName}`;return e(p0,{field:b,value:k,onChange:F=>d(b,F),control:p.control,errors:p.formState.errors},S)})},Xt=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"providerKey"}],a=[{alias:null,args:[{fields:[{kind:"Variable",name:"providerKey",variableName:"providerKey"}],kind:"ObjectValue",name:"input"}],concreteType:"GenerativeModel",kind:"LinkedField",name:"models",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelComboBoxQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelComboBoxQuery",selections:a},params:{cacheID:"a3417a3b2ae9ad193a5fd68335cfd660",id:null,metadata:{},name:"ModelComboBoxQuery",operationKind:"query",text:`query ModelComboBoxQuery(
  $providerKey: GenerativeProviderKey!
) {
  models(input: {providerKey: $providerKey}) {
    name
  }
}
`}}}();Xt.hash="fc5563c6dca10fdeda807cd7061e275a";function h0({onChange:n,container:a,modelName:l,queryReference:t,...i}){const r=x.usePreloadedQuery(Xt,t),o=m.useMemo(()=>r.models.map(u=>({name:u.name,id:u.name})),[r.models]),[d,c]=m.useState({selectedKey:l??null,inputValue:l??""}),p=u=>{if(typeof u=="string"){const g=o.find(f=>f.id===u);(g==null?void 0:g.name)!=null&&n(g.name)}},y=u=>{c(g=>({inputValue:u,selectedKey:g.selectedKey}))};return m.useEffect(()=>{c({selectedKey:l??null,inputValue:l??""})},[l]),e(Dt,{size:"L",label:"Model",isRequired:!0,"data-testid":"model-picker",selectedKey:d.selectedKey,"aria-label":"model picker",onInputChange:y,inputValue:d.inputValue,onSelectionChange:p,width:"100%",allowsCustomValue:!0,onBlur:()=>{d.inputValue!==""&&n(d.inputValue)},onKeyUp:u=>{u.key==="Enter"&&n(d.inputValue)},menuTrigger:"focus",container:a,description:"Choose a model from the list, or enter a custom model name",defaultItems:o,...i,children:u=>e(xt,{textValue:u.name,id:u.id,children:u.name},u.id)})}function Ko(n){const[a,l,t]=x.useQueryLoader(Xt);return m.useEffect(()=>(l({providerKey:n.provider}),()=>t()),[t,l,n.provider]),a!=null?e(h0,{queryReference:a,...n}):null}const To={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelProviderPickerFragment",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};To.hash="1d4ba7f81a958c9a17bd45dce0456ddb";function k0(n){return n==="OPENAI"||n==="AZURE_OPENAI"||n==="ANTHROPIC"||n==="GOOGLE"}function b0({onChange:n,query:a,...l}){var d,c;const t=x.useFragment(To,a),i=t.modelProviders.filter(p=>p.dependenciesInstalled),r=i.length!==t.modelProviders.length,o=l.provider&&!i.some(p=>p.key===l.provider);return s(h,{direction:"row",gap:"size-100",children:[e(gt,{label:"Provider","data-testid":"model-provider-picker",selectedKey:l.provider??void 0,"aria-label":"Model Provider",placeholder:"Select a provider",onSelectionChange:p=>{const y=p;k0(y)&&n(y)},width:"100%",...l,children:t.modelProviders.map(p=>e(de,{children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(_t,{provider:p.key,height:16}),p.name]})},p.key))}),o?s(fe,{delay:0,offset:5,children:[e("span",{children:e(qe,{children:e(_,{color:"red-700",svg:e(xn,{})})})}),s(Ve,{children:["The selected provider is not installed. Install"," ",((c=(d=t.modelProviders.find(p=>p.key===l.provider))==null?void 0:d.dependencies)==null?void 0:c.join(", "))??"the dependencies"," ","to use its models in Playground."]})]}):r?s(fe,{delay:0,offset:5,children:[e("span",{children:e(qe,{children:e(_,{svg:e(xn,{})})})}),s(Ve,{children:["Some providers are missing dependencies. Install them to use their models in Playground.",e("br",{}),e("br",{}),"Missing providers:",e("br",{}),t.modelProviders.filter(p=>!p.dependenciesInstalled).map(p=>{var y;return s(H,{children:[((y=p.dependencies)==null?void 0:y.join(", "))??p.name,e("br",{})]})})]})]}):null]})}const S0=150,v0=T`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-200);
  .ac-field,
  .ac-dropdown,
  .ac-dropdown-button,
  .ac-slider {
    width: 100%;
  }
  // Makes the filled slider track blue
  .ac-slider-controls > .ac-slider-track:first-child::before {
    background: var(--ac-global-color-primary);
  }
  padding: var(--ac-global-dimension-size-200);
  overflow: auto;
`;function C0({instance:n,container:a}){const l=z(r=>r.updateModel),t=m.useCallback(({configKey:r,value:o})=>{l({instanceId:n.id,patch:{...n.model,[r]:o}})},[n.id,n.model,l]),i=m.useMemo(()=>Hi(r=>{t({configKey:"modelName",value:r})},250),[t]);return s(H,{children:[e(Ko,{modelName:n.model.modelName,provider:n.model.provider,onChange:r=>{i(r)},container:a??void 0}),s(J,{defaultValue:n.model.baseUrl??"",onChange:r=>{t({configKey:"baseUrl",value:r})},children:[e(W,{children:"Base URL"}),e(ae,{placeholder:"e.x. https://my-llm.com/v1"})]})]})}function F0({instance:n}){const a=z(i=>i.updateModel),l=m.useCallback(({configKey:i,value:r})=>{a({instanceId:n.id,patch:{...n.model,[i]:r}})},[n.id,n.model,a]),t=m.useMemo(()=>Hi(i=>{l({configKey:"modelName",value:i})},250),[l]);return s(H,{children:[s(J,{defaultValue:n.model.modelName??"",onChange:i=>{t(i)},children:[e(W,{children:"Deployment Name"}),e(ae,{placeholder:"e.x. azure-openai-deployment-name"})]}),s(J,{defaultValue:n.model.endpoint??"",onChange:i=>{l({configKey:"endpoint",value:i})},children:[e(W,{children:"Endpoint"}),e(ae,{placeholder:"e.x. https://my.openai.azure.com"})]}),e(Dt,{size:"L",label:"API Version","data-testid":"azure-api-version-combobox",selectedKey:n.model.apiVersion??void 0,"aria-label":"api version picker",placeholder:"Select an AzureOpenAI API Version",inputValue:n.model.apiVersion??"",onInputChange:i=>{l({configKey:"apiVersion",value:i})},onSelectionChange:i=>{typeof i=="string"&&l({configKey:"apiVersion",value:i})},allowsCustomValue:!0,children:op.map(i=>e(xt,{textValue:i,id:i,children:i},i))})]})}function K0(n){const[a,l]=m.useState(null),t=z(d=>d.instances.find(c=>c.id===n.playgroundInstanceId));if(!t)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const i=t.model.supportedInvocationParameters,r=t.model.invocationParameters,o=ts(r,i);return s(m.Fragment,{children:[e(M,{size:"S",onPress:()=>{m.startTransition(()=>{l(e(T0,{...n}))})},leadingVisual:e(_t,{provider:t.model.provider,height:16}),children:s(h,{direction:"row",gap:"size-100",alignItems:"center",height:"100%",children:[e(ir,{maxWidth:S0,children:e(v,{children:t.model.modelName||"--"})}),o?null:s(fe,{delay:0,offset:5,children:[e("span",{children:e(qe,{children:e(_,{color:"danger",svg:e(xn,{})})})}),e(Ve,{children:"Some required invocation parameters are not configured."})]})]})}),e(Y,{type:"slideOver",isDismissable:!0,onDismiss:()=>{l(null)},children:a})]})}function T0(n){const a=z(r=>r.instances.find(o=>o.id===n.playgroundInstanceId));if(!a)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const l=Ge(r=>r.setModelConfigForProvider),t=Se(),i=m.useCallback(()=>{const{supportedInvocationParameters:r,...o}=a.model;l({provider:a.model.provider,modelConfig:o}),t({title:"Model Configuration Saved",message:`${at[a.model.provider]} model configuration saved as default for later use.`,expireMs:3e3})},[a.model,t,l]);return e(X,{title:"Model Configuration",size:"M",extra:s(fe,{delay:0,offset:5,children:[e(M,{size:"S",variant:"default",onPress:i,leadingVisual:e(_,{svg:e(rr,{})}),children:"Save as Default"}),s(Ve,{children:["Saves the current configuration as the default for"," ",at[a.model.provider]??"this provider","."]})]}),children:e(m.Suspense,{children:e(P0,{...n})})})}function P0(n){const{playgroundInstanceId:a}=n,l=z(f=>f.instances.find(k=>k.id===a));if(!l)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const t=Ge(f=>f.modelConfigByProvider),i=z(f=>f.updateProvider),r=z(f=>f.updateModel),o=l.model.supportedInvocationParameters,d=l.model.invocationParameters,c=ts(d,o),p=x.useLazyLoadQuery(Fo,{}),y=m.useCallback(f=>{r({instanceId:a,patch:{modelName:f}})},[a,r]),[u,g]=m.useState();return s("form",{css:v0,children:[c?null:s(h,{direction:"row",gap:"size-100",children:[e(_,{color:"danger",svg:e(xn,{})}),e(v,{color:"danger",children:"Some required invocation parameters are not configured."})]}),e(b0,{provider:l.model.provider,query:p,onChange:f=>{i({instanceId:a,provider:f,modelConfigByProvider:t})}}),l.model.provider==="OPENAI"?e(C0,{instance:l,container:u??null}):l.model.provider==="AZURE_OPENAI"?e(F0,{instance:l}):e(Ko,{modelName:l.model.modelName,provider:l.model.provider,onChange:y,container:u??void 0}),e(m.Suspense,{children:e(f0,{instanceId:a})}),e("div",{ref:g})]})}const Po=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null},l={alias:"floatDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"modelInvocationParameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"required",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:[{alias:"booleanDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a,{alias:null,args:null,kind:"ScalarField",name:"minValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxValue",storageKey:null}],type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a],type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"intDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"jsonDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringListDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringListInvocationParameter",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelSupportedParamsFetcherQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelSupportedParamsFetcherQuery",selections:t},params:{cacheID:"8f18509b17f3f97c2413ef8b6557d972",id:null,metadata:{},name:"ModelSupportedParamsFetcherQuery",operationKind:"query",text:`query ModelSupportedParamsFetcherQuery(
  $input: ModelsInput!
) {
  modelInvocationParameters(input: $input) {
    __typename
    ... on InvocationParameterBase {
      __isInvocationParameterBase: __typename
      invocationName
      canonicalName
      required
      label
    }
    ... on BooleanInvocationParameter {
      booleanDefaultValue: defaultValue
      invocationInputField
    }
    ... on BoundedFloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
      minValue
      maxValue
    }
    ... on FloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
    }
    ... on IntInvocationParameter {
      intDefaultValue: defaultValue
      invocationInputField
    }
    ... on JSONInvocationParameter {
      jsonDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringInvocationParameter {
      stringDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringListInvocationParameter {
      stringListDefaultValue: defaultValue
      invocationInputField
    }
  }
}
`}}}();Po.hash="8bf1a32724929bdc4a02d32809ba59d7";const I0=({instanceId:n})=>{var p;const l=z(y=>y.instances).find(y=>y.id===n);if(!l)throw new Error("Instance not found");const t=l.model.provider,i=l.model.modelName,r=Ge(y=>y.modelConfigByProvider),o=z(y=>y.updateModelSupportedInvocationParameters),{modelInvocationParameters:d}=x.useLazyLoadQuery(Po,{input:{providerKey:t,modelName:i}}),c=(p=l.prompt)==null?void 0:p.id;return m.useEffect(()=>{o({instanceId:n,supportedInvocationParameters:d,modelConfigByProvider:r})},[d,n,o,r,c]),null},Io=n=>a=>a.instances.find(l=>l.id===n),xo=n=>a=>a.allInstanceMessages[n];function x0({playgroundInstanceId:n,messageId:a}){const l=m.useMemo(()=>Io(n),[n]),t=z(l);if(t==null)throw new Error(`Instance ${n} not found`);const i=m.useMemo(()=>xo(a),[a]),r=z(i);if(r==null)throw new Error(`Message ${a} not found`);const o=r.toolCalls,d=z(k=>k.updateMessage),[c,p]=m.useState(()=>JSON.stringify(o,null,2)),[y,u]=m.useState(o);m.useEffect(()=>{JSON.stringify(o)!==JSON.stringify(y)&&(p(JSON.stringify(o,null,2)),u(o))},[y,o]);const g=m.useCallback(k=>{p(k);const{json:b}=we(k);if(b==null)return;const{success:S}=dp.safeParse(b);S&&(u(b),d({instanceId:n,messageId:a,patch:{toolCalls:b}}))},[n,a,d]),f=m.useMemo(()=>{switch(t.model.provider){case"OPENAI":case"AZURE_OPENAI":return up;case"ANTHROPIC":return cp;case"GOOGLE":return null}},[t.model.provider]);return e(je,{value:c,jsonSchema:f,onChange:g})}function D0(n){return n==="text"||n==="toolCalls"}function _0({messageMode:n,onChange:a}){return s(hr,{selectedKeys:[n],"aria-label":"Message Mode",onSelectionChange:l=>{if(l.size===0)return;const t=l.keys().next().value;D0(t)&&a(t)},children:[s(fe,{placement:"top",delay:0,offset:10,children:[e(qa,{"aria-label":"text input",id:"text",children:e(_,{svg:e(nr,{})})}),e(Ve,{children:"Text input"})]}),s(fe,{placement:"top",delay:0,offset:10,children:[e(qa,{"aria-label":"tool calling",id:"toolCalls",children:e(_,{svg:e(kl,{})})}),e(Ve,{children:"Tool calling"})]})]})}const L0=T`
  .ac-field-label {
    display: none;
  }
`;function w0({role:n,includeLabel:a=!0,onChange:l}){return s(gt,{selectedKey:n,css:a?void 0:L0,label:"Role","data-testid":"messages-role-picker","aria-label":"Role for the chat message",size:"compact",onSelectionChange:t=>{if(!Zr(t))throw new Error(`Invalid chat message role: ${t}`);l(t)},children:[e(de,{children:"System"},"system"),e(de,{children:"User"},"user"),e(de,{children:"AI"},"ai"),e(de,{children:"Tool"},"tool")]})}const E0=32;function V0({instanceId:n,hasResponseFormat:a}){const l=z(u=>u.instances),t=z(u=>u.updateInstance),i=z(u=>u.addMessage),r=z(u=>u.upsertInvocationParameterInput),o=l.find(u=>u.id===n);if(!o)throw new Error(`Playground instance ${n} not found`);const{template:d}=o;if(d.__type!=="chat")throw new Error(`Invalid template type ${d.__type}`);const c=o.model.supportedInvocationParameters,p=c==null?void 0:c.some(u=>jn(u,{canonicalName:Dn,invocationName:Kn})),y=c==null?void 0:c.some(u=>jn(u,{canonicalName:ra,invocationName:Ka}));return s(h,{direction:"row",justifyContent:"end",gap:"size-100",minHeight:E0,children:[p?e(M,{size:"S","aria-label":"response format",leadingVisual:e(_,{svg:e(Ca,{})}),isDisabled:a,onPress:()=>{r({instanceId:n,invocationParameterInput:{valueJson:mp(),invocationName:Kn,canonicalName:Dn}})},children:"Response Format"}):null,y?e(M,{"aria-label":"add tool",size:"S",leadingVisual:e(_,{svg:e(Ca,{})}),onPress:()=>{const u={tools:[...o.tools,py({provider:o.model.provider,toolNumber:o.tools.length+1})]};if(o.tools.length===0){const g=bt({toolChoice:"auto",targetProvider:o.model.provider});g&&(u.toolChoice=g)}t({instanceId:n,patch:u,dirty:!0})},children:"Tool"}):null,e(M,{"aria-label":"add message",size:"S",leadingVisual:e(_,{svg:e(Ca,{})}),onPress:()=>{i({playgroundInstanceId:n,messages:[{id:$n(),role:"user",content:""}]})},children:"Message"})]})}const M0=400;function R0({playgroundInstanceId:n}){const a=z(c=>c.deleteInvocationParameterInput),l=z(c=>c.instances.find(p=>p.id===n)),t=z(c=>c.upsertInvocationParameterInput);if(!l)throw new Error(`Instance ${n} not found`);const i=l.model.invocationParameters.find(c=>c.invocationName===Kn||c.canonicalName===Dn),[r]=m.useState(JSON.stringify((i==null?void 0:i.valueJson)??{},null,2)),o=m.useRef(r),d=m.useCallback(c=>{o.current=c;const{json:p}=we(c);if(p==null)return;const{success:y}=zt.safeParse(p);y&&t({instanceId:n,invocationParameterInput:{invocationName:Kn,valueJson:p,canonicalName:Dn}})},[n,t]);return s(me,{id:"response-format",children:[e(ce,{arrowPosition:"start",children:"Response Format"}),e(ue,{children:e(C,{padding:"size-200",children:e(O,{variant:"compact",title:"Schema",bodyStyle:{padding:0},extra:s(h,{direction:"row",gap:"size-100",children:[e(re,{text:o}),e(M,{"aria-label":"Delete Response Format",leadingVisual:e(_,{svg:e(sn,{})}),size:"S",onPress:()=>{a({instanceId:n,invocationParameterInputInvocationName:Kn})}})]}),children:e(kr,{preInitializationMinHeight:M0,children:e(je,{value:r,onChange:d,jsonSchema:Gg})})})})})]})}const A0=400;function N0({playgroundInstanceId:n,toolId:a}){const[l,t]=m.useState(0),i=z(S=>S.updateInstance),r=z(S=>S.instances.find(F=>F.id===n));if(r==null)throw new Error(`Playground instance ${n} not found`);const o=r.tools,d=o.find(S=>S.id===a);if(d==null)throw new Error(`Tool ${a} not found`);const[c,p]=m.useState(JSON.stringify(d.definition,null,2)),y=m.useRef(c),[u,g]=m.useState(d.definition);m.useEffect(()=>{JSON.stringify(d.definition)!==JSON.stringify(u)&&(g(d.definition),p(JSON.stringify(d.definition,null,2)),t(S=>S+1))},[d.definition,u]);const f=m.useCallback(S=>{y.current=S;const{json:F}=we(S);if(F==null)return;const{success:P}=Zi.safeParse(F);P&&(g(F),i({instanceId:n,patch:{tools:o.map(D=>D.id===d.id?{...D,definition:F}:D)},dirty:!0}))},[o,n,d.id,i]),k=m.useMemo(()=>as(d),[d]),b=m.useMemo(()=>{switch(r.model.provider){case"OPENAI":case"AZURE_OPENAI":return gp;case"ANTHROPIC":return pp;case"GOOGLE":return null}},[r.model.provider]);return e(O,{collapsible:!0,backgroundColor:"yellow-100",borderColor:"yellow-700",variant:"compact",title:s(h,{direction:"row",gap:"size-100",children:[e(Tt,{spanKind:"tool"}),e(v,{children:k??"Tool"})]}),bodyStyle:{padding:0},extra:s(h,{direction:"row",gap:"size-100",children:[e(re,{text:y}),e(M,{"aria-label":"Delete tool",leadingVisual:e(_,{svg:e(sn,{})}),size:"S",onPress:()=>{const S=o.filter(D=>D.id!==d.id),F=typeof r.toolChoice=="object"&&k!=null&&yp(r.toolChoice)===k;let P=r.toolChoice;S.length===0?P=void 0:F&&(P="auto"),i({instanceId:n,patch:{tools:S,toolChoice:P},dirty:!0})}})]}),children:e(kr,{preInitializationMinHeight:A0,children:e(je,{value:c,onChange:f,jsonSchema:b},l)})})}function z0(n){const a=n.playgroundInstanceId,l=z(d=>d.instances.find(c=>c.id===n.playgroundInstanceId)),t=z(d=>d.updateInstance);if(l==null)throw new Error(`Playground instance ${a} not found`);const{tools:i}=l;if(i==null)throw new Error(`Playground instance ${a} does not have tools`);const r=m.useMemo(()=>i.map(d=>as(d)).filter(d=>d!=null),[i]),o=l.model.provider;return fp(o)?s(me,{id:"tools",children:[s(ce,{arrowPosition:"start",children:["Tools",e(un,{variant:"light",children:i.length})]}),e(ue,{children:e(C,{padding:"size-200",children:s(h,{direction:"column",children:[e(fl,{children:e(hp,{provider:o,choice:l.toolChoice,onChange:d=>{t({instanceId:a,patch:{toolChoice:d},dirty:!0})},toolNames:r})}),e(h,{direction:"column",gap:"size-200",children:i.map(d=>e(N0,{playgroundInstanceId:a,toolId:d.id},d.id))})]})})})]}):null}const Do=1,$0=Do+1;function O0(n){const a=n.playgroundInstanceId,l=z(u=>u.templateFormat),t=z(u=>u.updateInstance),i=m.useMemo(()=>Io(a),[a]),r=z(i);if(!r)throw new Error(`Playground instance ${a} not found`);const o=r.tools.length>0,d=r.model.invocationParameters.find(u=>jn(u,{canonicalName:Dn,invocationName:Kn}))!=null,{template:c}=r;if(c.__type!=="chat")throw new Error(`Invalid template type ${c.__type}`);const p=c.messageIds,y=Au(ti(ju),ti(Qu,{coordinateGetter:Ou}));return s($u,{sensors:y,onDragEnd:({active:u,over:g})=>{if(!g||u.id===g.id)return;const f=p.findIndex(S=>S===u.id),k=p.findIndex(S=>S===g.id),b=zu(p,f,k);t({instanceId:a,patch:{template:{__type:"chat",messageIds:b}},dirty:!0})},children:[e(Nu,{items:p,children:e("ul",{css:T`
            display: flex;
            flex-direction: column;
            gap: var(--ac-global-dimension-size-200);
            padding: var(--ac-global-dimension-size-200);
          `,children:p.map(u=>e(j0,{playgroundInstanceId:a,templateFormat:l,messageId:u},u))})}),e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderColor:"dark",borderTopWidth:"thin",borderBottomWidth:o||d?"thin":void 0,children:e(V0,{instanceId:a,hasResponseFormat:d})}),o||d?s(Ye,{defaultExpandedKeys:["tools","response-format"],children:[o?e(z0,{...n}):null,d?e(R0,{...n}):null]}):null]})}function Q0({message:n,updateMessage:a,templateFormat:l,playgroundInstanceId:t,messageMode:i}){const r=m.useCallback(o=>{a({content:o})},[a]);if(i==="toolCalls")return e(C,{paddingTop:"size-100",paddingStart:"size-250",paddingEnd:"size-250",paddingBottom:"size-200",children:e(Bn,{label:"Tool Calls",children:e(Be,{width:"100%",children:e(x0,{playgroundInstanceId:t,messageId:n.id})})})});if(n.role==="tool"){const o=El(n.content);return s(fl,{onSubmit:d=>{d.preventDefault()},children:[e(C,{paddingX:"size-200",paddingY:"size-100",borderColor:"yellow-700",borderBottomWidth:"thin",children:e(J,{value:n.toolCallId,onChange:d=>a({toolCallId:d}),"aria-label":"Tool Call ID",size:"S",children:e(ae,{placeholder:"Tool Call ID"})})}),e(je,{value:o,"aria-label":"tool message content",height:"100%",onChange:d=>a({content:d}),onBlur:()=>{if(n.content!=null&&typeof n.content=="string"){const{json:d}=we(n.content);a({content:JSON.stringify(d,null,2)})}}})]})}return e(bl,{children:e(Sl,{height:"100%",defaultValue:n.content||"","aria-label":"Message content",templateFormat:l,onChange:r,placeholder:n.role==="system"?"You are a helpful assistant":n.role==="ai"?"Hello, how can I help you today?":"What is the weather in San Francisco?"})})}function j0({playgroundInstanceId:n,templateFormat:a,messageId:l}){const t=z(R=>R.updateMessage),i=z(R=>R.deleteMessage),{attributes:r,listeners:o,setNodeRef:d,transform:c,transition:p,setActivatorNodeRef:y,isDragging:u}=qu({id:l}),g=m.useMemo(()=>R=>{var q;return(q=R.instances.find(ee=>ee.id===n))==null?void 0:q.model},[n]),f=z(g);if(!f)throw new Error(`Instance model not found for instance ${n}`);const k=m.useMemo(()=>xo(l),[l]),b=z(k),S=nl(b.role),F={transform:Uu.Translate.toString(c),transition:p,zIndex:u?$0:Do},P=b.toolCalls!=null&&b.toolCalls.length>0,[D,w]=m.useState(P?"toolCalls":"text"),[K,I]=m.useState(b.content),[E,V]=m.useState(b.toolCalls),Q=m.useCallback(R=>{t({instanceId:n,messageId:l,patch:R})},[n,l,t]);return e("li",{ref:d,style:F,children:e(O,{collapsible:!0,variant:"compact",bodyStyle:{padding:0},...S,title:e("div",{css:T`
              // Align the role picker with the prompt picker in PlaygroundTemplate header
              margin-left: var(--ac-global-dimension-size-150);
            `,children:e(w0,{includeLabel:!1,role:b.role,onChange:R=>{let q=b.toolCalls;R!=="ai"&&(q=void 0,w("text")),t({instanceId:n,messageId:l,patch:{role:R,toolCalls:q}})}})}),extra:s(h,{direction:"row",gap:"size-100",children:[b.role==="ai"?e(_0,{messageMode:D,onChange:R=>{switch(w(R),R){case"text":V(b.toolCalls),t({instanceId:n,messageId:l,patch:{content:K,toolCalls:void 0}});break;case"toolCalls":I(b.content),t({instanceId:n,messageId:l,patch:{content:"",toolCalls:E!=null?fr({toolCalls:E,provider:f.provider}):[gy(f.provider)]}});break;default:ke()}}}):null,e(re,{text:D==="toolCalls"?JSON.stringify(b.toolCalls):El(b.content)}),e(M,{"aria-label":"Delete message",leadingVisual:e(_,{svg:e(sn,{})}),size:"S",onPress:()=>{i({instanceId:n,messageId:l})}}),e(kp,{ref:y,listeners:o,attributes:r})]}),children:e("div",{children:e(Q0,{message:b,messageMode:D,playgroundInstanceId:n,templateFormat:a,updateMessage:Q})})})})}function q0(n){const[a,l]=m.useState(null),t=n.playgroundInstanceId,i=z(b=>b.updateInstance),r=z(b=>b.addMessage),o=z(b=>b.setDirty),d=z(b=>b.instances),c=d.find(b=>b.id===t),p=d.findIndex(b=>b.id===t),y=c==null?void 0:c.prompt,u=y==null?void 0:y.id,g=c==null?void 0:c.dirty,f=m.useCallback(async b=>{if(!b){i({instanceId:t,patch:{prompt:null},dirty:!1});return}const S=await As(b);S&&(i({instanceId:t,patch:{...S.instance,template:{__type:"chat",messageIds:[]}},dirty:!1}),r({playgroundInstanceId:t,messages:S.instance.template.messages}),o(t,!1))},[t,i,r,o]);if(!c)throw new Error(`Playground instance ${t} not found`);const{template:k}=c;return s(H,{children:[e(O,{title:s(h,{direction:"row",gap:"size-100",alignItems:"center",marginEnd:"size-100",children:[e(It,{index:p}),e(vo,{promptId:u,onChange:f})]}),collapsible:!0,variant:"compact",bodyStyle:{padding:0},extra:s(h,{direction:"row",gap:"size-100",children:[e(m.Suspense,{fallback:e("div",{children:e(Ce,{size:"S"})}),children:e(I0,{instanceId:t})}),e(K0,{...n}),e(B0,{instanceId:t,setDialog:l,dirty:g}),d.length>1?e(U0,{...n}):null]}),children:k.__type==="chat"?e(m.Suspense,{children:e(O0,{...n})}):"Completion Template"}),e(Y,{isDismissable:!0,onDismiss:()=>{l(null)},children:a})]})}function U0(n){const a=z(l=>l.deleteInstance);return s(fe,{children:[e(qe,{children:e(M,{size:"S","aria-label":"Delete this instance of the playground",leadingVisual:e(_,{svg:e(sn,{})}),onPress:()=>{a(n.playgroundInstanceId)}})}),e(Ve,{children:e(Un,{children:"Delete this instance of the playground"})})]})}function B0({instanceId:n,setDialog:a,dirty:l}){const t=z(r=>r.instances.find(o=>o.id===n));if(!t)throw new Error(`Instance ${n} not found`);return e(H,{children:s(fe,{delay:100,offset:5,placement:"top",children:[e(qe,{children:e(M,{variant:l?"primary":void 0,size:"S",onPress:()=>{var r;a(e(u0,{instanceId:n,setDialog:a,selectedPromptId:(r=t.prompt)==null?void 0:r.id}))},children:"Save"})}),e(Ve,{children:e(Un,{children:"Save this prompt"})})]})})}function H0({size:n}){const a=z(t=>t.templateFormat),l=z(t=>t.setTemplateFormat);return e("div",{css:T`
        & * {
          white-space: nowrap;
        }
      `,children:s(hr,{size:n,defaultSelectedKeys:[a],"aria-label":"Template Format",onSelectionChange:t=>{if(t.size===0)return;const i=t.keys().next().value;typeof i=="string"&&bp(i)&&l(i)},children:[e(qa,{"aria-label":"None",id:We.NONE,children:"None"}),e(qa,{"aria-label":"Mustache",id:We.Mustache,children:"Mustache"}),e(qa,{"aria-label":"F-String",id:We.FString,children:"F-String"})]})})}const G0=T`
  display: flex;
  overflow: hidden;
  flex-direction: column;
  height: 100%;
`;function Yt(n){const{modelProviders:a}=x.useLazyLoadQuery(Ns,{}),l=Ge(c=>c.modelConfigByProvider),t=Ge(c=>c.playgroundStreamingEnabled),[,i]=hn(),r=a.some(c=>c.dependenciesInstalled);m.useEffect(()=>{i(c=>(c.delete("selectedSpanNodeId"),c),{replace:!0})},[i]);const o=window.Config.websocketsEnabled?t:!1,d=window.Config.websocketsEnabled;return r?s(_f,{...n,streaming:o,modelConfigByProvider:l,children:[s("div",{css:G0,children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",padding:"size-200",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(te,{level:1,children:"Playground"}),s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[d?e(o0,{}):null,e(qf,{}),e(Qf,{}),e(s0,{})]})]})}),e(a1,{})]}),e(m.Suspense,{children:e(Af,{})})]}):e($f,{availableProviders:a})}function W0(){const n=z(i=>i.addInstance),a=z(i=>i.instances),l=a.length,t=a.some(i=>i.activeRunId!=null);return e(M,{size:"S","aria-label":"add prompt",leadingVisual:e(_,{svg:e(bn,{})}),isDisabled:l>=Fg||t,onPress:()=>{n()},children:"Compare"})}const J0=T`
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  & > .ac-disclosure-group {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
    flex: 1 1 auto;
    & > .ac-disclosure {
      height: 100%;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      overflow-y: auto;
      flex: 1 1 auto;
      // prevent the accordion item header from growing to fill the accordion item
      // using two selectors as fallback just incase the component lib changes subtly
      & > [role="button"],
      & > #prompts-heading {
        flex: 0 0 auto;
      }
      .ac-disclosure-panel {
        height: 100%;
        overflow: hidden;
        flex: 1 1 auto;
      }
    }
  }
`,Z0=T`
  padding: var(--ac-global-dimension-size-200);
  scrollbar-gutter: stable;
  height: 100%;
  flex: 1 1 auto;
  overflow: auto;
  box-sizing: border-box;
`,X0=T`
  height: 100%;
  overflow: auto;
`,Y0=632,e1=["prompts"],n1=["input","output"];function a1(){const n=z(u=>u.instances),a=z(u=>u.templateFormat),[l]=hn(),t=l.get("datasetId"),i=t!=null,o=n.length===1,d=n.some(u=>u.activeRunId!=null),c=n.filter(u=>u.prompt).some(u=>u.dirty),p=m.useCallback(({currentLocation:u,nextLocation:g})=>{const f=u.pathname!==g.pathname;return(d||c)&&f},[d,c]),y=Bu(p);return m.useEffect(()=>{const u=d,g=f=>{f.preventDefault(),f.returnValue=!0};if(u)return window.addEventListener("beforeunload",g),()=>{window.removeEventListener("beforeunload",g)}},[d]),s(m.Fragment,{children:[s(Pn,{direction:o&&!i?"horizontal":"vertical",autoSaveId:o?"playground-horizontal":"playground-vertical",children:[e(Le,{children:e("div",{css:J0,children:e(Ye,{defaultExpandedKeys:e1,children:s(me,{id:"prompts",size:"L",children:[s(ce,{arrowPosition:"start",justifyContent:"space-between",children:["Prompts",e(Lt,{children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(H0,{size:"M"}),e(W0,{})]})})]}),e(ue,{children:e("div",{css:Z0,children:e(h,{direction:"row",gap:"size-200",maxWidth:"100%",children:n.map(u=>e(C,{flex:"1 1 0px",minWidth:Y0,children:e(q0,{playgroundInstanceId:u.id})},`${u.id}-prompt`))})})})]})})})}),e(Tn,{css:Wn}),e(Le,{children:i?e(m.Suspense,{fallback:e(Ce,{}),children:e(Gh,{datasetId:t})}):e("div",{css:X0,children:s(Ye,{defaultExpandedKeys:n1,children:[a!==We.NONE?s(me,{id:"input",size:"L",children:[e(ce,{arrowPosition:"start",children:"Inputs"}),e(ue,{children:e(C,{padding:"size-200",height:"100%",children:e(Yh,{})})})]}):null,s(me,{id:"output",size:"L",children:[e(ce,{arrowPosition:"start",children:"Output"}),e(ue,{children:e(C,{padding:"size-200",height:"100%",children:e(h,{direction:"row",gap:"size-200",children:n.map(u=>e(C,{flex:"1 1 0px",children:e(i0,{playgroundInstanceId:u.id})},`${u.id}-output`))})})})]})]})})})]}),y!=null&&e(Sp,{blocker:y,message:d?"Playground run is still in progress, leaving the page may result in incomplete runs. Are you sure you want to leave?":"You have unsaved changes. Are you sure you want to leave?"})]},"playground-content")}function Lv(){const{instanceWithPrompt:n,templateFormat:a}=Ue(),{instance:l}=m.useMemo(()=>{const{instance:t}=Xi();return{instance:{...t,...n,template:n.template}}},[n]);return e(Yt,{instances:[l],templateFormat:a})}const _o=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TagPromptVersionButtonSetTagMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:"prompt",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionsList__main"}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TagPromptVersionButtonSetTagMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:"prompt",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"8fb2730b63a6d441fbac8e5f5a438c9b",id:null,metadata:{},name:"TagPromptVersionButtonSetTagMutation",operationKind:"mutation",text:`mutation TagPromptVersionButtonSetTagMutation(
  $input: SetPromptVersionTagInput!
  $promptId: GlobalID!
) {
  setPromptVersionTag(input: $input) {
    query {
      prompt: node(id: $promptId) {
        __typename
        ... on Prompt {
          ...PromptVersionsList__main
        }
        __isNode: __typename
        id
      }
    }
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}

fragment PromptVersionsList__main on Prompt {
  promptVersions {
    edges {
      version: node {
        id
        ...PromptVersionSummaryFragment
      }
    }
  }
}
`}}}();_o.hash="6d6be37ba7956dbb351980e05b62cac1";const Lo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"},{defaultValue:null,kind:"LocalArgument",name:"versionId"}],a=[{kind:"Variable",name:"id",variableName:"promptId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],i={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:t,storageKey:null}],type:"Prompt",abstractKey:null},r=[{kind:"Variable",name:"id",variableName:"versionId"}],o={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:t,storageKey:null}],type:"PromptVersion",abstractKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={kind:"TypeDiscriminator",abstractKey:"__isNode"};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TagPromptVersionButtonTagsQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null},{alias:"promptVersion",args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[o],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TagPromptVersionButtonTagsQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,i,c,l],storageKey:null},{alias:"promptVersion",args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,o,c,l],storageKey:null}]},params:{cacheID:"51965c86ef2f0e2192aed200cd90bef9",id:null,metadata:{},name:"TagPromptVersionButtonTagsQuery",operationKind:"query",text:`query TagPromptVersionButtonTagsQuery(
  $promptId: GlobalID!
  $versionId: GlobalID!
) {
  prompt: node(id: $promptId) {
    __typename
    ... on Prompt {
      versionTags {
        id
        name
      }
    }
    __isNode: __typename
    id
  }
  promptVersion: node(id: $versionId) {
    __typename
    ... on PromptVersion {
      tags {
        id
        name
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Lo.hash="62f9ce0c869fb321ed64215c26ee5e56";const wo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptVersionId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l=[{kind:"Variable",name:"id",variableName:"promptVersionId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"NewPromptVersionTagDialogMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"NewPromptVersionTagDialogMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"f649353c182b494e5d15015c95ecc083",id:null,metadata:{},name:"NewPromptVersionTagDialogMutation",operationKind:"mutation",text:`mutation NewPromptVersionTagDialogMutation(
  $input: SetPromptVersionTagInput!
  $promptVersionId: GlobalID!
) {
  setPromptVersionTag(input: $input) {
    query {
      node(id: $promptVersionId) {
        __typename
        ...PromptVersionTagsList_data
        __isNode: __typename
        id
      }
    }
  }
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();wo.hash="c057a8cd7cddac787f887e505ff0f9e6";function l1({onNewTagCreated:n,promptVersionId:a,onDismiss:l}){const{control:t,handleSubmit:i,formState:{isDirty:r}}=Ae({defaultValues:{name:"",description:""}}),[o,d]=Ie.useState(null),[c,p]=x.useMutation(wo);return e(Y,{onDismiss:l,isDismissable:!0,type:"modal",children:s(X,{title:"New Prompt Tag",children:[o?e(ye,{variant:"danger",banner:!0,children:o}):null,s(Xe,{onSubmit:i(u=>{d(null),c({variables:{input:{name:u.name,description:u.description,promptVersionId:a},promptVersionId:a},onCompleted:()=>{n(u),l()},onError:g=>{d(g.message)}})}),children:[s(C,{padding:"size-200",children:[e(G,{name:"name",control:t,rules:{required:"Name is required",pattern:Co},render:({field:{name:u,onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(J,{isInvalid:b,onChange:g,onBlur:f,name:u,value:k.toString(),children:[e(W,{children:"Tag Name"}),e(ae,{placeholder:"e.x. prod"}),S!=null&&S.message?e(Fe,{children:S.message}):e(v,{slot:"description",children:"The identifier of the tag"})]})}),e(G,{name:"description",control:t,render:({field:{name:u,onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(J,{isInvalid:b,onChange:g,name:u,onBlur:f,value:k.toString(),children:[e(W,{children:"Description"}),e(ca,{placeholder:"A description of the tag"}),S!=null&&S.message?e(Fe,{children:S.message}):e(v,{slot:"description",children:"A description of the tag (optional)"})]})})]}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"dark",borderTopWidth:"thin",children:e(h,{gap:"size-100",justifyContent:"end",children:e(M,{variant:r?"primary":"default",size:"S",type:"submit",isDisabled:p,children:"Create Tag"})})})]})]})})}function t1(){const[n,a]=m.useState(!1),[l,t]=m.useState(0),i=Se(),{promptId:r,versionId:o}=an();if(!r)throw new Error("Expected promptId to be defined");if(!o)throw new Error("Expected versionId to be defined");return s("div",{children:[s(dt,{children:[e(M,{size:"S",leadingVisual:e(_,{svg:e(vp,{})}),children:"Tag Version"}),s(br,{placement:"bottom end",children:[e(Sr,{}),s(ot,{children:[e(m.Suspense,{fallback:e(C,{padding:"size-100",children:e(Ce,{size:"S"})}),children:e(i1,{promptId:r,versionId:o,fetchKey:l,onTagSet:d=>{t(c=>c+1),i({title:"Tag Set",message:`The tag ${d} has been set on the version`})}})}),e(C,{padding:"size-100",width:"250px",children:e(M,{leadingVisual:e(_,{svg:e(Ca,{})}),size:"S",css:T`
                  width: 100%;
                `,onPress:()=>a(!0),children:"New Tag"})})]})]})]}),n&&e(l1,{promptVersionId:o,onDismiss:()=>a(!1),onNewTagCreated:d=>{t(c=>c+1),i({title:"Tag Created",message:`The tag ${d.name} has been created and been set on the version`})}})]})}function i1({promptId:n,versionId:a,fetchKey:l,onTagSet:t}){var y,u;const i=x.useLazyLoadQuery(Lo,{promptId:n,versionId:a},{fetchKey:l,fetchPolicy:"store-and-network"}),r=m.useMemo(()=>{var g,f;return((f=(g=i==null?void 0:i.prompt)==null?void 0:g.versionTags)==null?void 0:f.map(k=>k.name))||[]},[(y=i==null?void 0:i.prompt)==null?void 0:y.versionTags]),o=m.useMemo(()=>{var g,f;return((f=(g=i==null?void 0:i.promptVersion)==null?void 0:g.tags)==null?void 0:f.map(k=>k.name))||[]},[(u=i==null?void 0:i.promptVersion)==null?void 0:u.tags]),d=m.useMemo(()=>Array.from(new Set([...di.map(g=>g.name),...r])),[r]),[c,p]=x.useMutation(_o);return e("ul",{children:d.map(g=>{const f=o.includes(g);return e("li",{children:e(C,{paddingY:"size-100",paddingX:"size-200",borderBottomColor:"light",borderBottomWidth:"thin",children:s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e("input",{type:"checkbox",name:g,checked:f,disabled:f||p,onChange:k=>{if(k.target.checked){const b=!o.includes(g);let S="";if(b){const F=di.find(P=>P.name===g);S=(F==null?void 0:F.description)||""}c({variables:{input:{name:g,promptVersionId:a,description:S},promptId:n},onCompleted:()=>{t(g)}})}}}),e("span",{children:g})]})})},g)})})}function wv(){const{promptVersion:n}=Ue();return e(r1,{promptVersion:n})}function r1({promptVersion:n}){return e(C,{width:"100%",overflow:"auto",elementType:"section",children:e(C,{padding:"size-200",width:"100%",overflow:"auto",children:s(h,{direction:"column",gap:"size-200",maxWidth:900,marginStart:"auto",marginEnd:"auto",children:[s(h,{direction:"row",justifyContent:"space-between",children:[s(h,{direction:"row",gap:"size-100",children:[e(te,{level:2,children:`Version: ${n.id}`}),e(Ls,{promptVersion:n})]}),s(h,{direction:"row",gap:"size-100",children:[e(re,{text:n.id,children:"Version ID"}),e(t1,{})]})]}),e(Cs,{promptVersion:n}),e(ys,{promptVersion:n}),e(Is,{promptVersion:n})]})})})}const Eo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],c={alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:d,storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptVersionLoaderQuery",selections:[{alias:"promptVersion",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptChatMessagesCard__main"},{args:null,kind:"FragmentSpread",name:"PromptCodeExportCard__main"},{args:null,kind:"FragmentSpread",name:"PromptModelConfigurationCard__main"},{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"},i,r,o,c,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[p],storageKey:null}],type:"PromptVersion",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptVersionLoaderQuery",selections:[{alias:"promptVersion",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[r,{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[y,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},p],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[y,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},o,{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:d,storageKey:null},c,{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[t,p],storageKey:null},i],type:"PromptVersion",abstractKey:null}],storageKey:null}]},params:{cacheID:"619de31a7a111f736e33d8aad0e16f97",id:null,metadata:{},name:"promptVersionLoaderQuery",operationKind:"query",text:`query promptVersionLoaderQuery(
  $id: GlobalID!
) {
  promptVersion: node(id: $id) {
    __typename
    id
    ... on PromptVersion {
      ...PromptInvocationParameters__main
      ...PromptChatMessagesCard__main
      ...PromptCodeExportCard__main
      ...PromptModelConfigurationCard__main
      ...PromptVersionTagsList_data
      description
      invocationParameters
      modelName
      tools {
        definition
      }
      tags {
        name
      }
    }
  }
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}}();Eo.hash="ab4959340d5259ba050f4d3ab7f4e261";async function Ev(n){const{versionId:a}=n.params;return await x.fetchQuery(be,Eo,{id:a}).toPromise().catch(()=>{throw new Error("Prompt version not found")})}const Vo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Literal",name:"first",value:1}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"promptVersion",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:1)"}],type:"Prompt",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptVersionsLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptVersionsLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}]},params:{cacheID:"6b4dac4f67e74b03bfd1c4802b844fb0",id:null,metadata:{},name:"promptVersionsLoaderQuery",operationKind:"query",text:`query promptVersionsLoaderQuery(
  $id: GlobalID!
) {
  prompt: node(id: $id) {
    __typename
    ... on Prompt {
      promptVersions(first: 1) {
        edges {
          promptVersion: node {
            id
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Vo.hash="b5ea8ee71d6ce7848581a446f803c1aa";async function Vv({params:n}){var r,o,d;if(n.versionId)return null;const l=n.promptId,t=await Ja.fetchQuery(be,Vo,{id:l}).toPromise();if(!((d=(o=(r=t==null?void 0:t.prompt)==null?void 0:r.promptVersions)==null?void 0:o.edges)!=null&&d.length))throw new Error("Prompt does not have any versions");const i=t.prompt.promptVersions.edges[0].promptVersion;return Ua(`/prompts/${l}/versions/${i.id}`)}const Mo={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionsPageContent__main",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionsList__main"}],type:"Prompt",abstractKey:null};Mo.hash="994c1d93ccbab49fef121d5d73cd2b62";const Ro={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionsList__main",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionSummaryFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null};Ro.hash="30cac642c3466fa8405eb71f29d27be3";const s1=T`
  border-bottom: 1px solid var(--ac-global-color-grey-300);
  transition: background-color 0.1s ease-in;

  &[data-active="true"],
  &:hover {
    background-color: var(--ac-global-color-grey-200);
  }

  & > a {
    text-decoration: none;
    color: inherit;
  }
`,o1=({version:n,active:a})=>e("div",{css:s1,"data-active":a,children:e(Hu,{to:`${n.id}`,children:e(C,{width:"100%",paddingY:"size-100",paddingX:"size-200",children:e(ws,{promptVersion:n})})})}),Di=400,d1=({prompt:n,itemActive:a})=>{const{promptVersions:l}=x.useFragment(Ro,n);return e(C,{height:"100%",overflow:"auto",width:Di,minWidth:Di,borderRightWidth:"thin",borderColor:"grey-300",children:e(h,{direction:"column",children:l.edges.map(({version:t})=>e(o1,{version:t,active:a==null?void 0:a(t)},t.id))})})};function Mv(){const{prompt:n}=Bt(),{versionId:a}=an();return e(c1,{prompt:n,promptVersionId:a})}function c1({prompt:n,promptVersionId:a}){const l=x.useFragment(Mo,n),t=m.useCallback(i=>i.id===a,[a]);return e(C,{height:"100%",children:s(h,{direction:"row",height:"100%",children:[e(d1,{prompt:l,itemActive:t}),e(Oe,{})]})})}const Ao=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null}],type:"ProjectSession",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"aa110794a0fd7ac02812e8e14196930b",id:null,metadata:{},name:"sessionLoaderQuery",operationKind:"query",text:`query sessionLoaderQuery(
  $id: GlobalID!
) {
  session: node(id: $id) {
    __typename
    id
    ... on ProjectSession {
      sessionId
    }
  }
}
`}}}();Ao.hash="26e5a5dbde9bd4ecfd7ae5fc1c078860";async function Rv(n){const{sessionId:a}=n.params;return await x.fetchQuery(be,Ao,{id:a}).toPromise()}const No=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}],i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:"latencyP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:null,args:null,concreteType:"TraceConnection",kind:"LinkedField",name:"traces",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"trace",args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"rootSpan",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:t,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ProjectSession",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SessionDetailsQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SessionDetailsQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}]},params:{cacheID:"2de2cec071eec7a908fbeaa045b1d4af",id:null,metadata:{},name:"SessionDetailsQuery",operationKind:"query",text:`query SessionDetailsQuery(
  $id: GlobalID!
) {
  session: node(id: $id) {
    __typename
    ... on ProjectSession {
      numTraces
      tokenUsage {
        total
        completion
        prompt
      }
      sessionId
      latencyP50: traceLatencyMsQuantile(probability: 0.5)
      traces {
        edges {
          trace: node {
            rootSpan {
              id
              attributes
              project {
                id
              }
              input {
                value
                mimeType
              }
              output {
                value
                mimeType
              }
              cumulativeTokenCountTotal
              cumulativeTokenCountCompletion
              cumulativeTokenCountPrompt
              latencyMs
              startTime
              spanAnnotations {
                name
                label
                score
                explanation
                annotatorKind
              }
              context {
                traceId
                spanId
              }
            }
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();No.hash="90059208fe6444236630273b31e8cef6";const u1=n=>{const{json:a}=we(n);if(a==null||!On(a))return null;const l=a[pe.user];if(l==null||!On(l))return null;const t=l[Gu.id];return cn.isString(t)||cn.isNumber(t)?t:null};function _i({role:n,value:a,mimeType:l}){const t=m.useMemo(()=>{if(l!=="json")return String(a);const r=we(a);return r.json==null?"--":JSON.stringify(r.json,null,2)},[a,l]),i=nl(n==="HUMAN"?"user":"assistant");return e(C,{alignSelf:n==="HUMAN"?"start":"end",borderRadius:"medium",borderColor:"dark",borderWidth:"thin",padding:"size-200",maxWidth:"70%",...i,children:s(h,{direction:"column",gap:"size-50",children:[e(v,{color:"text-700",children:n}),l==="json"?e(Je,{value:t}):e(v,{children:t})]})})}function m1({rootSpan:n,index:a}){const l=m.useMemo(()=>new Date(n.startTime),[n.startTime]),t=m.useMemo(()=>u1(n.attributes),[n.attributes]);return e(C,{height:"100%",children:s(h,{direction:"column",justifyContent:"space-between",height:"100%",children:[s(h,{direction:"column",gap:"size-200",children:[s(h,{direction:"row",justifyContent:"space-between",children:[s(v,{children:["Trace #",a+1]}),e(Qe,{to:`/projects/${n.project.id}/traces/${n.context.traceId}?selectedSpanNodeId=${n.id}`,children:s(h,{alignItems:"center",children:["View Trace",e(_,{svg:e(mr,{})})]})})]}),s(h,{direction:"row",justifyContent:"space-between",children:[t!=null?s(v,{color:"text-700",children:["user: ",t]}):null,e(v,{color:"text-700",flex:"end",marginStart:"auto",children:gn(l)})]}),s(h,{direction:"row",gap:"size-100",children:[e(Jn,{tokenCountTotal:n.cumulativeTokenCountTotal??0,tokenCountCompletion:n.cumulativeTokenCountCompletion??0,tokenCountPrompt:n.cumulativeTokenCountPrompt??0}),n.latencyMs!=null?e(Re,{latencyMs:n.latencyMs}):"--"]})]}),s(h,{direction:"row",justifyContent:"space-between",alignItems:"end",children:[s(h,{direction:"column",gap:"size-100",maxWidth:"50%",children:[e(v,{children:"Feedback"}),e(h,{gap:"size-50",direction:"column",children:n.spanAnnotations.length>0?n.spanAnnotations.map(i=>e(Da,{annotation:i,children:e(wn,{annotation:i,annotationDisplayPreference:"label"})},i.name)):"--"})]}),e("span",{children:e(Ys,{size:"S",spanNodeId:n.id,projectId:n.project.id})})]})]})})}function p1({rootSpan:n}){var a,l,t,i;return s(h,{direction:"column",gap:"size-100",children:[e(_i,{role:"HUMAN",value:(a=n.input)==null?void 0:a.value,mimeType:(l=n.input)==null?void 0:l.mimeType}),e(_i,{role:"AI",value:(t=n.output)==null?void 0:t.value,mimeType:(i=n.output)==null?void 0:i.mimeType})]})}function g1({traces:n}){const a=m.useMemo(()=>((n==null?void 0:n.edges)||[]).map(({trace:t})=>t.rootSpan).filter(t=>t!=null),[n]);return e(C,{height:"100%",flex:"1 1 auto",overflow:"auto",children:a.map((l,t)=>e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",children:s(h,{direction:"row",children:[e(C,{borderRightWidth:"thin",borderEndColor:"dark",padding:"size-200",flex:"1 1 auto",children:e(p1,{rootSpan:l})}),e(C,{width:350,padding:"size-200",flex:"none",children:e(m1,{rootSpan:l,index:t})})]})},l.context.spanId))})}function y1({traceCount:n,tokenUsage:a,latencyP50:l}){return e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:s(h,{direction:"row",gap:"size-400",children:[s(h,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Traces Count"}),e(v,{size:"L",children:n})]}),a!=null?s(h,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Total Tokens"}),e(Jn,{tokenCountTotal:a.total,tokenCountCompletion:a.completion,tokenCountPrompt:a.prompt,size:"L"})]}):null,l!=null?s(h,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Latency P50"}),e(Re,{latencyMs:l,size:"L"})]}):null]})})}function f1(n){const{sessionId:a}=n,l=x.useLazyLoadQuery(No,{id:a},{fetchPolicy:"store-and-network"});if(l.session==null)throw new Error("Session not found");return s("main",{css:T`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        height: 100%;
        overflow: hidden;
      `,children:[e(y1,{traceCount:l.session.numTraces??0,tokenUsage:l.session.tokenUsage,latencyP50:l.session.latencyP50}),e(g1,{traces:l.session.traces})]})}function Av(){var i;const n=Ue(),{sessionId:a,projectId:l}=an(),t=se();return e(Y,{type:"slideOver",isDismissable:!0,onDismiss:()=>t(`/projects/${l}`),children:e(X,{size:"fullscreen",title:`Session ID: ${((i=n.session)==null?void 0:i.sessionId)??"--"}`,children:e(Pl,{children:e(f1,{sessionId:a})})})})}const zo=function(){var n=[{alias:null,args:null,concreteType:"Functionality",kind:"LinkedField",name:"functionality",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"modelInferences",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"homeLoaderQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"homeLoaderQuery",selections:n},params:{cacheID:"8bfba02258509f0b645b86f3322838d8",id:null,metadata:{},name:"homeLoaderQuery",operationKind:"query",text:`query homeLoaderQuery {
  functionality {
    modelInferences
  }
}
`}}}();zo.hash="a248736e236c8d5348e0ecfbe9440ca2";async function Nv(n){const a=await x.fetchQuery(be,zo,{}).toPromise();return a!=null&&a.functionality.modelInferences?Ua("/model"):Ua("/projects")}const $o=function(){var n={defaultValue:null,kind:"LocalArgument",name:"endTime"},a={defaultValue:null,kind:"LocalArgument",name:"startTime"},l=[{kind:"Variable",name:"endTime",variableName:"endTime"},{kind:"Variable",name:"startTime",variableName:"startTime"}],t=[{kind:"Literal",name:"first",value:50}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={fields:[{kind:"Variable",name:"end",variableName:"endTime"},{kind:"Variable",name:"start",variableName:"startTime"}],kind:"ObjectValue",name:"timeRange"},d={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],p={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ModelPageQuery",selections:[{args:l,kind:"FragmentSpread",name:"ModelSchemaTable_dimensions"},{args:l,kind:"FragmentSpread",name:"ModelEmbeddingsTable_embeddingDimensions"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ModelPageQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:t,concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dimension",args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},{alias:"cardinality",args:[{kind:"Literal",name:"metric",value:"cardinality"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[{kind:"Literal",name:"metric",value:"percentEmpty"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"min",args:[{kind:"Literal",name:"metric",value:"min"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"mean",args:[{kind:"Literal",name:"metric",value:"mean"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"max",args:[{kind:"Literal",name:"metric",value:"max"},o],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},o],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:c,storageKey:null}],storageKey:null},p],storageKey:"dimensions(first:50)"},{alias:null,args:t,filters:null,handle:"connection",key:"ModelSchemaTable_dimensions",kind:"LinkedHandle",name:"dimensions"},{alias:null,args:t,concreteType:"EmbeddingDimensionConnection",kind:"LinkedField",name:"embeddingDimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"EmbeddingDimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"embedding",args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:"euclideanDistance",args:[{kind:"Literal",name:"metric",value:"euclideanDistance"},o],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:c,storageKey:null}],storageKey:null},p],storageKey:"embeddingDimensions(first:50)"},{alias:null,args:t,filters:null,handle:"connection",key:"ModelEmbeddingsTable_embeddingDimensions",kind:"LinkedHandle",name:"embeddingDimensions"}],storageKey:null}]},params:{cacheID:"18059ac8df6b3c15d5e4bc04ca2c9877",id:null,metadata:{},name:"ModelPageQuery",operationKind:"query",text:`query ModelPageQuery(
  $startTime: DateTime!
  $endTime: DateTime!
) {
  ...ModelSchemaTable_dimensions_3uKjWt
  ...ModelEmbeddingsTable_embeddingDimensions_3uKjWt
}

fragment ModelEmbeddingsTable_embeddingDimensions_3uKjWt on Query {
  model {
    embeddingDimensions(first: 50) {
      edges {
        embedding: node {
          id
          name
          euclideanDistance: driftMetric(metric: euclideanDistance, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}

fragment ModelSchemaTable_dimensions_3uKjWt on Query {
  model {
    dimensions(first: 50) {
      edges {
        dimension: node {
          id
          name
          type
          dataType
          cardinality: dataQualityMetric(metric: cardinality, timeRange: {start: $startTime, end: $endTime})
          percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: {start: $startTime, end: $endTime})
          min: dataQualityMetric(metric: min, timeRange: {start: $startTime, end: $endTime})
          mean: dataQualityMetric(metric: mean, timeRange: {start: $startTime, end: $endTime})
          max: dataQualityMetric(metric: max, timeRange: {start: $startTime, end: $endTime})
          psi: driftMetric(metric: psi, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}
`}}}();$o.hash="b612239336c7638df42037315b00f635";function zv(n){const{referenceInferences:a}=Sn(),{timeRange:l}=Vn(),t=x.useLazyLoadQuery($o,{startTime:l.start.toISOString(),endTime:l.end.toISOString()});return s("main",{children:[s(wt,{children:[e(vr,{}),a?e(Cr,{inferencesRole:"reference",timeRange:{start:new Date(a.startTime),end:new Date(a.endTime)}}):null]}),e("section",{css:T`
          margin: var(--ac-global-dimension-static-size-200);
        `,children:e(pt,{title:"Model Schema",variant:"compact",bodyStyle:{padding:0},children:s(He,{children:[e(ne,{name:"All",children:s(Ye,{defaultExpandedKeys:["embeddings","dimensions"],children:[s(me,{id:"embeddings",children:[e(ce,{children:"Embeddings"}),e(ue,{children:e(ci,{model:t})})]}),s(me,{id:"dimensions",children:[e(ce,{children:"Dimensions"}),e(ue,{children:e(ui,{model:t})})]})]})},"all"),e(ne,{name:"Embeddings",children:e(ci,{model:t})},"embeddings"),e(ne,{name:"Dimensions",children:e(ui,{model:t})},"dimensions")]})})}),e(Oe,{})]})}const Oo={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MetricSelector_dimensions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],storageKey:null}]},params:{cacheID:"4ccf476dd862525b059197daccd0d4d9",id:null,metadata:{},name:"EmbeddingPageModelQuery",operationKind:"query",text:`query EmbeddingPageModelQuery {
  model {
    ...MetricSelector_dimensions
  }
}

fragment MetricSelector_dimensions on Model {
  numericDimensions: dimensions(include: {dataTypes: [numeric]}) {
    edges {
      node {
        id
        name
        type
      }
    }
  }
}
`}};Oo.hash="374499f7f8ce6919e4a0a4ecbe380c52";const Qo=function(){var n={defaultValue:null,kind:"LocalArgument",name:"clusterMinSamples"},a={defaultValue:null,kind:"LocalArgument",name:"clusterSelectionEpsilon"},l={defaultValue:null,kind:"LocalArgument",name:"dataQualityMetricColumnName"},t={defaultValue:null,kind:"LocalArgument",name:"fetchDataQualityMetric"},i={defaultValue:null,kind:"LocalArgument",name:"fetchPerformanceMetric"},r={defaultValue:null,kind:"LocalArgument",name:"id"},o={defaultValue:null,kind:"LocalArgument",name:"minClusterSize"},d={defaultValue:null,kind:"LocalArgument",name:"minDist"},c={defaultValue:null,kind:"LocalArgument",name:"nNeighbors"},p={defaultValue:null,kind:"LocalArgument",name:"nSamples"},y={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},u={defaultValue:null,kind:"LocalArgument",name:"timeRange"},g=[{kind:"Variable",name:"id",variableName:"id"}],f={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},F=[f,{alias:null,args:null,kind:"ScalarField",name:"eventId",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"coordinates",plural:!1,selections:[k,{kind:"InlineFragment",selections:[b,S,{alias:null,args:null,kind:"ScalarField",name:"z",storageKey:null}],type:"Point3D",abstractKey:null},{kind:"InlineFragment",selections:[b,S],type:"Point2D",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EmbeddingMetadata",kind:"LinkedField",name:"embeddingMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"linkToData",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"rawData",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null}],P=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],D={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"clusterMinSamples",variableName:"clusterMinSamples"},{kind:"Variable",name:"clusterSelectionEpsilon",variableName:"clusterSelectionEpsilon"},{kind:"Variable",name:"minClusterSize",variableName:"minClusterSize"},{kind:"Variable",name:"minDist",variableName:"minDist"},{kind:"Variable",name:"nNeighbors",variableName:"nNeighbors"},{kind:"Variable",name:"nSamples",variableName:"nSamples"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"UMAPPoints",kind:"LinkedField",name:"UMAPPoints",plural:!1,selections:[{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"data",plural:!0,selections:F,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"referenceData",plural:!0,selections:F,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"corpusData",plural:!0,selections:F,storageKey:null},{alias:null,args:null,concreteType:"Cluster",kind:"LinkedField",name:"clusters",plural:!0,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"eventIds",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"driftRatio",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"primaryToCorpusRatio",storageKey:null},{condition:"fetchDataQualityMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"columnName",variableName:"dataQualityMetricColumnName"},{kind:"Literal",name:"metric",value:"mean"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"dataQualityMetric",plural:!1,selections:P,storageKey:null}]},{condition:"fetchPerformanceMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"performanceMetric",plural:!1,selections:P,storageKey:null}]}],storageKey:null},{alias:null,args:null,concreteType:"Retrieval",kind:"LinkedField",name:"contextRetrievals",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"queryId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"relevance",storageKey:null}],storageKey:null}],storageKey:null}],type:"EmbeddingDimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r,o,d,c,p,y,u],kind:"Fragment",metadata:null,name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:g,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[D],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[r,u,d,c,p,o,n,a,t,l,i,y],kind:"Operation",name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:g,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[k,D,{kind:"TypeDiscriminator",abstractKey:"__isNode"},f],storageKey:null}]},params:{cacheID:"d30210c52f86b9d9a7ac958f866aa93e",id:null,metadata:{},name:"EmbeddingPageUMAPQuery",operationKind:"query",text:`query EmbeddingPageUMAPQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
  $minDist: Float!
  $nNeighbors: Int!
  $nSamples: Int!
  $minClusterSize: Int!
  $clusterMinSamples: Int!
  $clusterSelectionEpsilon: Float!
  $fetchDataQualityMetric: Boolean!
  $dataQualityMetricColumnName: String
  $fetchPerformanceMetric: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      UMAPPoints(timeRange: $timeRange, minDist: $minDist, nNeighbors: $nNeighbors, nSamples: $nSamples, minClusterSize: $minClusterSize, clusterMinSamples: $clusterMinSamples, clusterSelectionEpsilon: $clusterSelectionEpsilon) {
        data {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        referenceData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        corpusData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        clusters {
          id
          eventIds
          driftRatio
          primaryToCorpusRatio
          dataQualityMetric(metric: {columnName: $dataQualityMetricColumnName, metric: mean}) @include(if: $fetchDataQualityMetric) {
            primaryValue
            referenceValue
          }
          performanceMetric(metric: {metric: $performanceMetric}) @include(if: $fetchPerformanceMetric) {
            primaryValue
            referenceValue
          }
        }
        contextRetrievals {
          queryId
          documentId
          relevance
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Qo.hash="f1ee7ce02317f1c3fe96b77af405095f";function h1(){const{theme:n}=En();return m.useMemo(()=>n==="light"?Cp:Fp,[n])}function k1(){const{embeddingDimensionId:n}=an();if(!n)throw new Error("Missing embeddingDimensionId in URL params");return n}const jo={euclideanDistance:{name:"Euclidean Distance",shortName:"Euc. Distance",definition:"Euclidean distance over time captures how much your primary inferences's embeddings are drifting from the reference data. Euclidean distance of the embeddings is calculated by taking the centroid of the embedding vectors for each inferences and calculating the distance between the two centroids."},queryDistance:{name:"Query Distance",shortName:"Query Distance",definition:"The query distance is the euclidean distance of the centroid of queries from the centroid of the corpus."},accuracyScore:{name:"Accuracy Score",shortName:"Accuracy",definition:"Accuracy classification score. In multi-label classification, this function computes subset accuracy: the set of labels predicted for a sample must exactly match the corresponding set of labels in the ground truth."}};function sa(n){const a=jo[n];return a!=null?a.shortName:n}function Zl(n){const a=jo[n];return a&&a.definition!=null&&a.definition||null}function ha(n){return`${n.column}:${n.dir}`}function b1(){const{referenceInferences:n}=Sn(),a=!!n,l=B(c=>c.clusterSort),t=B(c=>c.setClusterSort),[i,r]=m.useState(!1),o=m.useMemo(()=>{const c=[];return a&&c.push({label:"Most drift",value:ha({column:"driftRatio",dir:"desc"})}),[...c,{label:"Largest clusters",value:ha({column:"size",dir:"desc"})},{label:"Smallest clusters",value:ha({column:"size",dir:"asc"})},{label:"Highest metric value",value:ha({column:"primaryMetricValue",dir:"desc"})},{label:"Lowest metric value",value:ha({column:"primaryMetricValue",dir:"asc"})}]},[a]),d=ha(l);return e("div",{css:T`
        .ac-action-button {
          background: none;
          border: none;
          color: ${"var(--ac-global-text-color-700)"};
          font-size: var(--ac-global-font-size-xs);
          line-height: var(--ac-global-line-height-xs);
          cursor: pointer;
          outline: none;
          &:hover {
            color: var(--ac-global-text-color-900);
          }
        }
      `,children:s(ua,{placement:"bottom right","aria-label":"Sort clusters by",isOpen:i,onOpenChange:c=>r(c),children:[s(tm,{children:["Sort",e("span",{"aria-hidden":!0,"data-testid":"dropdown-caret",css:T`
              margin-left: var(--ac-global-dimension-static-size-50);
              border-bottom-color: #0000;
              border-left-color: #0000;
              border-right-color: #0000;
              border-style: solid;
              border-width: 3px 3px 0;
              content: "";
              display: inline-block;
              height: 0;
              vertical-align: middle;
              width: 0;
            `})]}),e(gl,{children:e(hl,{style:{width:200},selectedKeys:[d],selectionMode:"single",items:o,onSelectionChange:c=>{if(c instanceof Set&&c.size>0){const[p]=c.values(),[y,u]=p.split(":");t({column:y,dir:u})}r(!1)},children:c=>e(de,{children:c.label},c.value)})})]})})}const qo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"clusters"}],a=[{alias:null,args:[{kind:"Variable",name:"clusters",variableName:"clusters"}],concreteType:"ExportedFile",kind:"LinkedField",name:"exportClusters",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EmbeddingActionMenuExportClustersMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EmbeddingActionMenuExportClustersMutation",selections:a},params:{cacheID:"1bef6586fcb3d6eb7034204fbe49633c",id:null,metadata:{},name:"EmbeddingActionMenuExportClustersMutation",operationKind:"mutation",text:`mutation EmbeddingActionMenuExportClustersMutation(
  $clusters: [ClusterInput!]!
) {
  exportClusters(clusters: $clusters) {
    fileName
  }
}
`}}}();qo.hash="b5ff2517dbb0d19a1b24dea1796a3576";function S1(){const n=B(r=>r.clusters),{notifyError:a,notifySuccess:l}=Fr(),[t,i]=x.useMutation(qo);return e(Hn,{align:"end",buttonSize:"compact",icon:i?e(_,{svg:e(ln,{})}):null,onAction:r=>{switch(r){case"export_cluster":t({variables:{clusters:n.map(o=>({eventIds:o.eventIds,id:o.id}))},onCompleted:o=>{const{fileName:d}=o.exportClusters;l({title:"Clusters Exported",message:"dataframe is available via px.active_session().exports or can be downloaded by clicking below",action:{text:"Download",onClick:()=>{window.open(`/exports?filename=${d}`,"_self")}}})},onError:o=>{a({title:"Failed to export clusters",message:`Failed to export clusters: ${o.message}`})}});break}},children:s(de,{children:[e(_,{svg:e(Et,{})}),"Export clusters"]},"export_cluster")})}const Uo={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MetricSelector_dimensions",selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],type:"Model",abstractKey:null};Uo.hash="55d03de16503d7af254c17cef7d18ee0";const ba=":";function v1(n){return["drift","performance","dataQuality","retrieval"].includes(n)}function Ra(n){const{type:a,metric:l}=n;switch(a){case"drift":return`${a}${ba}${l}`;case"retrieval":return`${a}${ba}${l}`;case"performance":return`${a}${ba}${l}`;case"dataQuality":{const{name:t}=n.dimension;return`${a}${ba}${l}${ba}${t}`}default:ke()}}function C1({metricKey:n,dimensions:a}){const[l,t,i]=n.split(ba);if(!v1(l))throw new Error(`Invalid metric type: ${l}`);switch(l){case"drift":return{type:l,metric:t};case"retrieval":return{type:l,metric:t};case"performance":return{type:l,metric:t};case"dataQuality":{const r=a.find(o=>o.name===i);if(!r)throw new Error(`Invalid dimension name: ${i}`);return{type:l,metric:t,dimension:r}}default:ke()}}const F1=s(Ia,{variant:"info",children:[e(te,{level:4,weight:"heavy",children:"Analysis Metric"}),s(Un,{children:[e("p",{children:"Select a metric to drive the analysis of your embeddings."}),e("p",{children:"To analyze the the drift between your two inferences, select a drift metric and the UI will highlight areas of high drift."}),e("p",{children:"To analyze the quality of your embeddings, select a dimension data quality metric by which to analyze the point cloud. The UI will highlight areas where the data quality is degrading."})]})]});function K1({model:n}){const[,a]=m.useTransition(),l=x.useFragment(Uo,n),{referenceInferences:t,corpusInferences:i}=Sn(),r=!!t,o=!!i,d=B(f=>f.metric),c=B(f=>f.loading),p=B(f=>f.setMetric),y=l.numericDimensions.edges.map(f=>f.node),u=y.length>0,g=m.useCallback(f=>{const k=C1({metricKey:f,dimensions:y});a(()=>{p(k)})},[p,y,a]);return s(gt,{label:"metric",labelExtra:F1,selectedKey:d?Ra(d):void 0,onSelectionChange:g,placeholder:"Select a metric...",isDisabled:c,children:[r?e(tl,{title:"Drift",children:e(de,{children:"Euclidean Distance"},Ra({type:"drift",metric:"euclideanDistance"}))}):null,o?e(tl,{title:"Retrieval",children:e(de,{children:"Query Distance"},Ra({type:"retrieval",metric:"queryDistance"}))}):null,e(tl,{title:"Performance",children:e(de,{children:"Accuracy Score"},Ra({type:"performance",metric:"accuracyScore"}))}),u?e(tl,{title:"Data Quality",children:y.map(f=>e(de,{children:`${f.name} avg`},Ra({type:"dataQuality",metric:"average",dimension:f})))}):null]})}const Bo=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"embeddingDimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"fetchDataQuality"},i={defaultValue:null,kind:"LocalArgument",name:"fetchDrift"},r={defaultValue:null,kind:"LocalArgument",name:"fetchPerformance"},o={defaultValue:null,kind:"LocalArgument",name:"fetchQueryDistance"},d={defaultValue:null,kind:"LocalArgument",name:"metricGranularity"},c={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},p={defaultValue:null,kind:"LocalArgument",name:"timeRange"},y=[{kind:"Variable",name:"id",variableName:"embeddingDimensionId"}],u={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},g={kind:"Variable",name:"granularity",variableName:"metricGranularity"},f={kind:"Variable",name:"timeRange",variableName:"timeRange"},k=[g,{kind:"Literal",name:"metric",value:"euclideanDistance"},f],b=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],S={kind:"InlineFragment",selections:[{condition:"fetchDrift",kind:"Condition",passingValue:!0,selections:[{alias:"euclideanDistanceTimeSeries",args:k,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:b,storageKey:null}]},{condition:"fetchQueryDistance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:k,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"retrievalMetricTimeSeries",plural:!1,selections:b,storageKey:null}]},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},f],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:b,storageKey:null}],type:"EmbeddingDimension",abstractKey:null},F=[{kind:"Variable",name:"id",variableName:"dimensionId"}],P={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:[g,{kind:"Literal",name:"metric",value:"mean"},f],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:b,storageKey:null}],type:"Dimension",abstractKey:null},D={alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{condition:"fetchPerformance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[g,{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"},f],concreteType:"PerformanceTimeSeries",kind:"LinkedField",name:"performanceTimeSeries",plural:!1,selections:b,storageKey:null}]}],storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r,o,d,c,p],kind:"Fragment",metadata:null,name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:y,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[u,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:F,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[P],storageKey:null}]},D],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,p,d,n,i,o,t,a,r,c],kind:"Operation",name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:y,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[w,u,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:F,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[w,P,{kind:"TypeDiscriminator",abstractKey:"__isNode"},u],storageKey:null}]},D]},params:{cacheID:"a68a8204bf7fdd13e6915b338d4b5497",id:null,metadata:{},name:"MetricTimeSeriesQuery",operationKind:"query",text:`query MetricTimeSeriesQuery(
  $embeddingDimensionId: GlobalID!
  $timeRange: TimeRange!
  $metricGranularity: Granularity!
  $countGranularity: Granularity!
  $fetchDrift: Boolean!
  $fetchQueryDistance: Boolean!
  $fetchDataQuality: Boolean!
  $dimensionId: GlobalID!
  $fetchPerformance: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $embeddingDimensionId) {
    __typename
    id
    ... on EmbeddingDimension {
      euclideanDistanceTimeSeries: driftTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchDrift) {
        data {
          timestamp
          value
        }
      }
      retrievalMetricTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchQueryDistance) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
  dimension: node(id: $dimensionId) @include(if: $fetchDataQuality) {
    __typename
    ... on Dimension {
      name
      dataQualityTimeSeries(metric: mean, timeRange: $timeRange, granularity: $metricGranularity) {
        data {
          timestamp
          value
        }
      }
    }
    __isNode: __typename
    id
  }
  model {
    performanceTimeSeries(metric: {metric: $performanceMetric}, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchPerformance) {
      data {
        timestamp
        value
      }
    }
  }
}
`}}}();Bo.hash="f31abad2141a5a1c461ef2a598ffa4f3";const Li=new Intl.NumberFormat([],{maximumFractionDigits:2}),Ho=()=>{const n=Mn(),a=n.blue400,l=n.gray500;return{color:a,barColor:l}};function T1({active:n,payload:a,label:l}){var r,o,d;const{color:t,barColor:i}=Ho();if(n&&a&&a.length){const c=((r=a[1])==null?void 0:r.value)??null,p=((o=a[0])==null?void 0:o.value)??null,y=typeof c=="number"?Li.format(c):"--",u=typeof p=="number"?Li.format(p):"--";return s(Zn,{children:[e(v,{weight:"heavy",size:"S",children:`${gn(new Date(l))}`}),e($e,{color:t,name:((d=a[1])==null?void 0:d.payload.metricName)??"Metric",value:y}),e($e,{color:i,shape:"square",name:"Count",value:u}),e(xl,{}),s("div",{css:T`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);

            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(_,{svg:e(xn,{})}),e("span",{children:"Click to view the point cloud at this time"})]})]})}return null}function P1(n){switch(n.type){case"drift":return"Embedding Drift";case"performance":return"Model Performance";case"dataQuality":return"Data Quality";case"retrieval":return"Query Distance";default:ke()}}function I1(n){if(n)switch(n.type){case"drift":return sa(n.metric);case"performance":return sa(n.metric);case"dataQuality":return`${n.dimension.name} avg`;case"retrieval":return sa(n.metric);default:ke()}else return"Count"}function x1(n){switch(n.type){case"drift":return Zl(n.metric);case"performance":return Zl(n.metric);case"dataQuality":return null;case"retrieval":return Zl(n.metric);default:ke()}}function D1({embeddingDimensionId:n}){const a=B(K=>K.metric),l=a.type==="drift",t=a.type==="retrieval",i=a.type==="dataQuality",r=a.type==="performance",{timeRange:o}=Vn(),{selectedTimestamp:d,setSelectedTimestamp:c}=Il(),p=La(o),y=x.useLazyLoadQuery(Bo,{embeddingDimensionId:n,timeRange:{start:o.start.toISOString(),end:o.end.toISOString()},metricGranularity:Kr(o),countGranularity:p,fetchDrift:l,fetchQueryDistance:t,fetchDataQuality:i,fetchPerformance:r,dimensionId:a.type==="dataQuality"?a.dimension.id:n,performanceMetric:a.type==="performance"?a.metric:"accuracyScore"}),u=wa({samplingIntervalMinutes:p.samplingIntervalMinutes}),g=m.useCallback(K=>{const{activePayload:I}=K;if(I!=null&&I.length>0){const E=I[0].payload;c(new Date(E.timestamp))}},[c]),f=_1({data:y,metric:a}),b=L1(y).reduce((K,I)=>(K[I.timestamp]=I.value,K),{})??{},S=f.map(K=>{const I=b[K.timestamp];return{...K,traffic:I,timestamp:new Date(K.timestamp).getTime()}}),F=I1(a),P=x1(a),{color:D,barColor:w}=Ho();return s("section",{css:T`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        h3 {
          padding: var(--ac-global-dimension-static-size-100)
            var(--ac-global-dimension-static-size-200) 0
            var(--ac-global-dimension-static-size-200);
          flex: none;
          display: flex;
          flex-direction: row;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-50);
        }
        & > div {
          flex: 1 1 auto;
          width: 100%;
          overflow: hidden;
        }
      `,children:[s(te,{level:3,children:[P1(a),P!=null?s(Ia,{children:[e(te,{level:4,children:F}),e(Un,{children:P})]}):null]}),e("div",{children:e(ea,{width:"100%",height:"100%",children:s(el,{data:S,margin:{top:25,right:18,left:18,bottom:10},onClick:g,children:[s("defs",{children:[s("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:D,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:D,stopOpacity:0})]}),s("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:w,stopOpacity:.3}),e("stop",{offset:"95%",stopColor:w,stopOpacity:0})]})]}),e(na,{...Ea,tickFormatter:K=>u(new Date(K)),style:{fill:"var(--ac-global-text-color-700)"}}),e(fn,{stroke:"var(--ac-global-color-grey-500)",label:{value:F,angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(fn,{yAxisId:"right",orientation:"right",label:{value:"Count",angle:90,position:"insideRight",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(aa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(la,{content:e(T1,{})}),e(Ta,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(Ha,{type:"monotone",dataKey:"value",stroke:D,fillOpacity:1,fill:"url(#colorUv)"}),d!=null?e(Ur,{...Tr,x:d.getTime()}):null]})})})]})}function _1({data:n,metric:a}){var l,t,i,r,o,d;if(((l=n.embedding.euclideanDistanceTimeSeries)==null?void 0:l.data)!=null&&n.embedding.euclideanDistanceTimeSeries.data.length>0)return n.embedding.euclideanDistanceTimeSeries.data.map(c=>({metricName:sa(a.metric),...c}));if(((t=n.embedding.retrievalMetricTimeSeries)==null?void 0:t.data)!=null&&n.embedding.retrievalMetricTimeSeries.data.length>0)return n.embedding.retrievalMetricTimeSeries.data.map(c=>({metricName:sa(a.metric),...c}));if(n.dimension&&((r=(i=n.dimension)==null?void 0:i.dataQualityTimeSeries)==null?void 0:r.data)!=null&&n.dimension.dataQualityTimeSeries.data.length>0){const c=n.dimension.name||"unknown";return n.dimension.dataQualityTimeSeries.data.map(p=>({metricName:`${c} avg`,...p}))}else{if(n.model&&((o=n.model.performanceTimeSeries)==null?void 0:o.data)!=null&&n.model.performanceTimeSeries.data.length>0)return n.model.performanceTimeSeries.data.map(c=>({metricName:sa(a.metric),...c}));if(((d=n.embedding.trafficTimeSeries)==null?void 0:d.data)!=null)return n.embedding.trafficTimeSeries.data.map(c=>({metricName:"Count",...c}))}return[]}function L1(n){var a;return((a=n.embedding.trafficTimeSeries)==null?void 0:a.data)!=null?[...n.embedding.trafficTimeSeries.data]:[]}const Go=function(){var n={defaultValue:null,kind:"LocalArgument",name:"corpusEventIds"},a={defaultValue:null,kind:"LocalArgument",name:"primaryEventIds"},l={defaultValue:null,kind:"LocalArgument",name:"referenceEventIds"},t=[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"DimensionWithValue",kind:"LinkedField",name:"dimensions",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"dimension",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptResponse",kind:"LinkedField",name:"promptAndResponse",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"response",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentText",storageKey:null}],i=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"primaryEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:t,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"referenceEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:t,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"corpusEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:t,storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"PointSelectionPanelContentQuery",selections:i,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,n],kind:"Operation",name:"PointSelectionPanelContentQuery",selections:i},params:{cacheID:"8b48064eba35d0d6c8dc834c2f7795c0",id:null,metadata:{},name:"PointSelectionPanelContentQuery",operationKind:"query",text:`query PointSelectionPanelContentQuery(
  $primaryEventIds: [ID!]!
  $referenceEventIds: [ID!]!
  $corpusEventIds: [ID!]!
) {
  model {
    primaryInferences {
      events(eventIds: $primaryEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    referenceInferences {
      events(eventIds: $referenceEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    corpusInferences {
      events(eventIds: $corpusEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
  }
}
`}}}();Go.hash="4bd627481610322f2acbcf73dfbfaadc";const wi=T`
  margin: var(--ac-global-dimension-static-size-200);
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-static-size-100);
  & > div {
    display: flex;
    flex-direction: row;
    dt {
      font-weight: bold;
      flex: none;
      width: 130px;
    }
    dd {
      flex: 1 1 auto;
      margin-inline-start: 0;
    }
  }
`;function Aa(n){return e("div",{css:T`
        max-height: 200px;
        overflow-y: auto;
      `,children:e("pre",{css:T`
          padding: var(--ac-global-dimension-static-size-200);
          color: var(--ac-global-text-color-900);
          white-space: normal;
          margin: 0;
        `,children:n.children})})}function w1({event:n}){const a=n.retrievedDocuments&&n.retrievedDocuments.length>0,l=!n.id.includes("CORPUS");return s("section",{css:T`
        height: 100%;
        overflow-y: auto;
      `,children:[e(R1,{event:n}),s(Ye,{defaultExpandedKeys:["prediction","document","dimensions","retrievals"],children:[l?s(me,{id:"prediction",children:[e(ce,{children:"Prediction Details"}),e(ue,{children:s("dl",{css:wi,children:[n.predictionId!=null&&s("div",{children:[e("dt",{children:"Prediction ID"}),e("dd",{css:T`
                        display: flex;
                        align-items: center;
                      `,children:n.predictionId})]}),n.predictionLabel!=null&&s("div",{children:[e("dt",{children:"Prediction Label"}),e("dd",{children:n.predictionLabel})]}),n.predictionScore!=null&&s("div",{children:[e("dt",{children:"Prediction Score"}),e("dd",{children:n.predictionScore})]}),n.actualLabel!=null&&s("div",{children:[e("dt",{children:"Actual Label"}),e("dd",{children:n.actualLabel})]}),n.actualScore!=null&&s("div",{children:[e("dt",{children:"Actual Score"}),e("dd",{children:n.actualScore})]})]})})]}):s(me,{id:"document",children:[e(ce,{children:"Document Details"}),e(ue,{children:e("dl",{css:wi,children:n.predictionId!=null&&s("div",{children:[e("dt",{children:"Document ID"}),e("dd",{css:T`
                        display: flex;
                        align-items: center;
                      `,children:n.predictionId})]})})})]}),s(me,{id:"dimensions",children:[e(ce,{children:"Dimensions"}),e(ue,{children:e(V1,{dimensions:n.dimensions})})]}),a&&s(me,{id:"retrievals",children:[s(ce,{children:["Retrieved Documents",e(un,{variant:"light",children:n.retrievedDocuments.length})]}),e(ue,{children:e("ul",{css:T`
                  padding: var(--ac-global-dimension-static-size-100);
                  li + li {
                    margin-top: var(--ac-global-dimension-static-size-100);
                  }
                `,children:n.retrievedDocuments.map(t=>e("li",{children:e(E1,{document:t})},t.id))})})]})]})]})}function E1({document:n}){return e(C,{borderRadius:"medium",backgroundColor:"light",children:s(h,{direction:"column",children:[e(C,{width:"100%",borderBottomWidth:"thin",borderBottomColor:"dark",children:s(h,{direction:"row",justifyContent:"space-between",margin:"size-100",alignItems:"center",children:[s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(_,{svg:e(ur,{})}),s(te,{level:4,children:["document ",n.id]})]}),typeof n.relevance=="number"&&e(va,{color:"blue",children:`relevance ${Pt(n.relevance)}`})]})}),e("pre",{css:T`
            padding: var(--ac-global-dimension-static-size-200);
            white-space: normal;
            margin: 0;
          `,children:n.text})]})})}function V1({dimensions:n}){const a=m.useMemo(()=>n.map(i=>({name:i.dimension.name,type:i.dimension.type,value:i.value??"--"})),[n]),l=m.useMemo(()=>[{header:()=>"Name",accessorKey:"name"},{header:()=>"Type",accessorKey:"type"},{header:()=>"Value",accessorKey:"value"}],[]),t=xe({columns:l,data:a,getCoreRowModel:De()});return s("table",{css:tn,children:[e("thead",{children:t.getHeaderGroups().map(i=>e("tr",{children:i.headers.map(r=>e("th",{colSpan:r.colSpan,children:r.isPlaceholder?null:e("div",{children:Z(r.column.columnDef.header,r.getContext())})},r.id))},i.id))}),t.getCoreRowModel().rows.length?e("tbody",{children:t.getRowModel().rows.map(i=>e("tr",{children:i.getVisibleCells().map(r=>e("td",{children:Z(r.column.columnDef.cell,r.getContext())},r.id))},i.id))}):e(A1,{})]})}function M1({dataUrl:n}){const a=Kp(n),l=Tp(n);return a?e("video",{src:n,controls:!0,css:T`
          width: 100%;
          height: 500px;
          background-color: black;
        `}):l?e("audio",{src:n,controls:!0,autoPlay:!0}):e("img",{src:n,alt:"event image",width:"100%",height:"200px",css:T`
        object-fit: contain;
        background-color: black;
      `})}function R1({event:n}){const a=n.linkToData||void 0,l=n.rawData,t=n.prompt||n.response?{prompt:n.prompt,response:n.response}:null,i=n.documentText;let r=null;return a?r=s(h,{direction:"column",children:[e(M1,{dataUrl:a}),l&&s(me,{id:"raw",children:[e(ce,{children:"Raw Data"}),e(ue,{children:e(Aa,{children:l})})]})]}):i?r=s(me,{id:"document",children:[e(ce,{children:"Document"}),e(ue,{children:e(Aa,{children:i})})]}):t?r=s(Ye,{defaultExpandedKeys:["prompt","response"],children:[s(me,{id:"prompt",children:[e(ce,{children:"Prompt"}),e(ue,{children:e(Aa,{children:t.prompt})})]}),s(me,{id:"response",children:[e(ce,{children:"Response"}),e(ue,{children:e(Aa,{children:t.response})})]})]}):n.rawData&&n.rawData&&n.rawData,r}function A1(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:T`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:e(sr,{graphicKey:"documents",message:"This embedding has no associated dimensions"})})})})}const Wo=function(){var n=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"ExportedFile",kind:"LinkedField",name:"exportedFiles",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExportSelectionButtonExportsQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ExportSelectionButtonExportsQuery",selections:n},params:{cacheID:"2f7e3554305121746dc799b6a8d120da",id:null,metadata:{},name:"ExportSelectionButtonExportsQuery",operationKind:"query",text:`query ExportSelectionButtonExportsQuery {
  model {
    exportedFiles {
      fileName
    }
  }
}
`}}}();Wo.hash="7e6db431afe21f137e54505645c787f4";const Jo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"eventIds"}],a=[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"eventIds"}],concreteType:"ExportedFile",kind:"LinkedField",name:"exportEvents",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExportSelectionButtonMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExportSelectionButtonMutation",selections:a},params:{cacheID:"d370df04ca30a5059288c7aa298239a8",id:null,metadata:{},name:"ExportSelectionButtonMutation",operationKind:"mutation",text:`mutation ExportSelectionButtonMutation(
  $eventIds: [ID!]!
) {
  exportEvents(eventIds: $eventIds) {
    fileName
  }
}
`}}}();Jo.hash="8b0d6962e2034d4c148d1b9919111d2f";const N1=`import phoenix as px

exports = px.active_session().exports
dataframe = exports[-1]
dataframe`,z1=T`
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100);
  }
`;function $1({value:n}){const{theme:a}=En(),l=a==="light"?void 0:Xn;return e(Yn,{value:n,basicSetup:!1,extensions:[Ya()],editable:!1,theme:l,css:z1})}function O1(){const n=B(o=>o.selectedEventIds),[a,l]=x.useMutation(Jo),[t,i]=m.useState(null),r=m.useCallback(()=>{a({variables:{eventIds:[...n]},onCompleted:o=>{i(o.exportEvents)}})},[a,n]);return s(H,{children:[e(M,{size:"S",leadingVisual:e(_,{svg:l?e(ln,{}):e(Et,{})}),"aria-label":"Export selection / cluster",isDisabled:l,onPress:r,children:l?"Exporting":"Export"}),e(Y,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:t!=null&&s(X,{title:"Cluster Exports",size:"M",children:[e(ye,{variant:"success",banner:!0,title:"Export succeeded",extra:e(M,{variant:"success",size:"S",onPress:()=>{window.open(`/exports?filename=${t.fileName}`,"_self")},children:"Download"})}),s("div",{css:T`
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                align-items: flex-start;
                padding: 16px;
                gap: 16px;
              `,children:[e("p",{css:T`
                  margin: 0;
                  flex: 1 1 auto;
                `,children:"You can retrieve your export in your notebook via"}),e(C,{borderColor:"light",borderWidth:"thin",borderRadius:"medium",children:e($1,{value:N1})})]}),e(Ye,{defaultExpandedKeys:["all-exports"],children:s(me,{id:"all-exports",children:[e(ce,{children:"Latest Exports"}),e(ue,{children:e(m.Suspense,{fallback:e(Ce,{}),children:e(Q1,{})})})]})})]})})]})}function Q1(){const n=x.useLazyLoadQuery(Wo,{},{fetchPolicy:"network-only"});return e(pl,{children:n.model.exportedFiles.map((a,l)=>e(ml,{children:s("div",{css:T`
              display: flex;
              flex-direction: row;
              justify-content: space-between;
              align-items: center;
            `,children:[a.fileName,e(M,{size:"S","aria-label":"Download",variant:"default",leadingVisual:e(_,{svg:e(im,{})}),onPress:()=>{window.open(`/exports?filename=${a.fileName}`,"_self")}})]})},l))})}function j1(n){const{getInferencesNameByRole:a}=Sn(),{events:l,onItemSelected:t}=n,i=B(p=>p.eventIdToDataMap),r=B(p=>p.eventIdToGroup),o=B(p=>p.pointGroupColors),d=B(p=>p.selectionGridSize),c=B(p=>p.setHoveredEventId);return e("div",{css:T`
        flex: 1 1 auto;
        overflow-y: auto;
      `,"data-testid":"grid-view-scroll-container",children:e("ul",{"data-grid-size":d,css:T`
          &[data-grid-size="small"] {
            --grid-item-min-width: 100px;
            --grid-item-height: 100px;
          }
          &[data-grid-size="medium"] {
            --grid-item-min-width: 200px;
            --grid-item-height: 200px;
          }
          &[data-grid-size="large"] {
            --grid-item-min-width: 300px;
            --grid-item-height: 200px;
          }
          padding: var(--ac-global-dimension-static-size-200);
          transition: all 0.2s ease-in-out;
          display: grid;
          grid-template-columns: repeat(
            auto-fill,
            minmax(var(--grid-item-min-width), 1fr)
          );
          flex-wrap: wrap;
          gap: var(--ac-global-dimension-static-size-200);
          & > li {
            min-width: var(--grid-item-min-width);
            height: var(--grid-item-height);
          }
        `,children:l.map((p,y)=>{const u=i.get(p.id),{rawData:g=null,linkToData:f=null}=(u==null?void 0:u.embeddingMetadata)??{},{predictionLabel:k=null,actualLabel:b=null}=(u==null?void 0:u.eventMetadata)??{},S=Pp(p.id),F=a(S),P=r[p.id],D=o[P];return e("li",{children:e(Ip,{rawData:g,linkToData:f,inferencesName:F,group:P,onClick:()=>{t(p.id)},onMouseOver:()=>{c(p.id)},onMouseOut:()=>{c(null)},color:D,size:d,predictionLabel:k,actualLabel:b,promptAndResponse:p.promptAndResponse,documentText:p.documentText,autoPlay:!1})},y)})})})}function q1({data:n,onPointSelected:a}){const{primaryInferences:l,referenceInferences:t}=Sn(),i=B(y=>y.metric),[r,o]=m.useState([]),{columns:d,tableData:c}=m.useMemo(()=>{const y=n.filter(D=>D.id.includes("CORPUS")===!1);let u=!1,g=!1,f=!1,k=!1,b=!1;n.forEach(D=>{D.linkToData&&(u=!0),D.rawData&&(g=!0),(D.prompt||D.response)&&(f=!0),D.predictionLabel&&(k=!0),D.actualLabel&&(b=!0)});const S=[];t&&S.push({header:"Inference Set",accessorKey:"id",size:50,cell:({getValue:D})=>e(U1,{id:D(),primaryInferencesName:l.name,referenceInferencesName:(t==null?void 0:t.name)??"reference"})}),u&&S.push({header:"Link",accessorKey:"linkToData",cell:({getValue:D})=>{const w=D();if(typeof w=="string"){const K=w.split("/").pop();return e(en,{href:w,children:K})}return null}}),f?(S.push({header:"Prompt",accessorKey:"prompt",cell:Ke,size:200}),S.push({header:"Response",accessorKey:"response",cell:Ke,size:200})):g&&S.push({header:"Raw Data",accessorKey:"rawData"}),k&&S.push({header:"Prediction Label",accessorKey:"predictionLabel",size:50}),b&&S.push({header:"Actual Label",accessorKey:"actualLabel",size:50});const F=[];if(i&&i.type==="dataQuality"){const D=i.dimension.name;F.push({header:i.dimension.name,accessorKey:"metric",cell:xp,sortingFn:"basic"}),y.forEach(w=>{var I;const K=(I=w.dimensions.find(E=>E.dimension.name===D))==null?void 0:I.value;w.metric=K!=null?Number(K):null})}return{columns:[...S,...F,{header:"",id:"view-details",size:50,cell:({row:D})=>e(M,{"aria-label":"view point details",size:"S",onPress:()=>{a(D.original.id)},children:"view details"})}],tableData:y}},[n,a,l,t,i]),p=xe({columns:d,data:c,state:{sorting:r},getCoreRowModel:De(),onSortingChange:o,getSortedRowModel:kn()});return s("table",{css:tn,children:[e("thead",{children:p.getHeaderGroups().map(y=>e("tr",{children:y.headers.map(u=>s("th",{children:[u.isPlaceholder?null:s("div",{className:u.column.getCanSort()?"cursor-pointer":"",onClick:u.column.getToggleSortingHandler(),children:[Z(u.column.columnDef.header,u.getContext()),u.column.getIsSorted()?e(_,{className:"sort-icon",svg:u.column.getIsSorted()==="asc"?e(on,{}):e(dn,{})}):null]}),e("div",{onMouseDown:u.getResizeHandler(),onTouchStart:u.getResizeHandler(),className:`resizer ${u.column.getIsResizing()?"isResizing":""}`,style:{transform:u.column.getIsResizing()?`translateX(${p.getState().columnSizingInfo.deltaOffset}px)`:""}})]},u.id))},y.id))}),e("tbody",{children:p.getRowModel().rows.map(y=>e("tr",{children:y.getVisibleCells().map(u=>e("td",{style:{width:u.column.getSize()},children:Z(u.column.columnDef.cell,u.getContext())},u.id))},y.id))})]})}function U1({id:n,primaryInferencesName:a,referenceInferencesName:l}){const t=n.includes("PRIMARY"),i=h1();return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(_p,{shape:Dp.circle,color:i[t?0:1]}),t?a:l]})}const B1=T`
  width: 100%;
  height: 100%;
  position: relative;
  display: flex;
  flex-direction: column;
  /* Give spacing for the close icon */
  & > .ac-tabs {
    padding-top: 17px;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    [role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      display: flex;
      flex-direction: column;
      flex: 1 1 auto;
      overflow: hidden;
      [role="tabpanel"] {
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        overflow: hidden;
      }
    }
  }
`;function H1({event:n,relevance:a}){return{id:n.eventMetadata.predictionId||"unknown id",text:n.documentText??"empty document",relevance:a}}function G1(){const n=B(K=>K.selectedEventIds),a=B(K=>K.setSelectedEventIds),l=B(K=>K.setSelectedClusterId),t=B(K=>K.selectionDisplay),[i,r]=Ie.useState(null),{primaryEventIds:o,referenceEventIds:d,corpusEventIds:c}=m.useMemo(()=>{const K=[],I=[],E=[];return n.forEach(V=>{V.includes("PRIMARY")?K.push(V):V.includes("CORPUS")?E.push(V):I.push(V)}),{primaryEventIds:K,referenceEventIds:I,corpusEventIds:E}},[n]),p=x.useLazyLoadQuery(Go,{primaryEventIds:[...o],referenceEventIds:[...d],corpusEventIds:[...c]}),y=m.useMemo(()=>{var V,Q,R,q,ee,ge;const K=((Q=(V=p.model)==null?void 0:V.primaryInferences)==null?void 0:Q.events)??[],I=((q=(R=p.model)==null?void 0:R.referenceInferences)==null?void 0:q.events)??[],E=((ge=(ee=p.model)==null?void 0:ee.corpusInferences)==null?void 0:ge.events)??[];return[...K,...I,...E]},[p]),u=()=>{a(new Set),l(null)},g=B(K=>K.eventIdToDataMap),f=B(K=>K.pointData),k=B(K=>K.selectionSearchText),b=m.useMemo(()=>y.map(K=>{var V,Q,R,q,ee,ge,he;const I=g.get(K.id),E=[];return f!=null&&(I==null?void 0:I.retrievals)!=null&&I.retrievals.forEach(({documentId:N,relevance:j})=>{const A=f[N];A!=null&&E.push(H1({event:A,relevance:j}))}),{id:K.id,predictionId:((V=K.eventMetadata)==null?void 0:V.predictionId)??null,actualLabel:((Q=K.eventMetadata)==null?void 0:Q.actualLabel)??null,actualScore:((R=K.eventMetadata)==null?void 0:R.actualScore)??null,predictionLabel:((q=K.eventMetadata)==null?void 0:q.predictionLabel)??null,predictionScore:((ee=K.eventMetadata)==null?void 0:ee.predictionScore)??null,rawData:(I==null?void 0:I.embeddingMetadata.rawData)??null,linkToData:(I==null?void 0:I.embeddingMetadata.linkToData)??null,dimensions:K.dimensions,prompt:((ge=K.promptAndResponse)==null?void 0:ge.prompt)??null,response:((he=K.promptAndResponse)==null?void 0:he.response)??null,retrievedDocuments:E,documentText:K.documentText??null}}),[y,g,f]),S=m.useMemo(()=>{if(k){const K=k.toLowerCase();return b.filter(I=>{var E,V,Q,R;return I.id.includes(K)||((E=I.documentText)==null?void 0:E.toLowerCase().includes(K))||((V=I.predictionId)==null?void 0:V.includes(K))||((Q=I.prompt)==null?void 0:Q.toLowerCase().includes(K))||((R=I.response)==null?void 0:R.toLowerCase().includes(K))})}return b},[b,k]),F=m.useMemo(()=>{if(k){const K=k.toLowerCase();return y.filter(I=>{var E,V,Q,R,q,ee,ge;return I.id.includes(K)||((E=I.documentText)==null?void 0:E.toLowerCase().includes(K))||((Q=(V=I.eventMetadata)==null?void 0:V.predictionId)==null?void 0:Q.includes(K))||((q=(R=I.promptAndResponse)==null?void 0:R.prompt)==null?void 0:q.toLowerCase().includes(K))||((ge=(ee=I.promptAndResponse)==null?void 0:ee.response)==null?void 0:ge.toLowerCase().includes(K))})}return y},[y,k]),P=m.useMemo(()=>i?b.find(I=>I.id===i)??null:null,[b,i]),D=y.length,w=F.length;return s("section",{css:B1,children:[s("div",{role:"toolbar",css:T`
          position: absolute;
          top: var(--ac-global-dimension-static-size-100);
          right: var(--ac-global-dimension-static-size-200);
          display: flex;
          flex-direction: row-reverse;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(M,{size:"S",leadingVisual:e(_,{svg:e(rm,{})}),"aria-label":"Clear selection",onPress:u}),e(O1,{})]}),e(He,{children:s(ne,{name:"Selection",children:[e(W1,{numSelectedEvents:D,numMatchingEvents:w,searchText:k}),t===Pr.list?e("div",{css:T`
                flex: 1 1 auto;
                overflow-y: auto;
              `,children:e(q1,{data:S,onPointSelected:r})}):e(j1,{events:F,onItemSelected:r})]})}),e(Y,{type:"slideOver",isDismissable:!0,onDismiss:()=>r(null),children:P&&e(X,{title:"Embedding Details",size:"L",children:e(w1,{event:P})})})]})}function W1({numSelectedEvents:n,numMatchingEvents:a,searchText:l}){const t=B(p=>p.selectionDisplay),i=B(p=>p.setSelectionDisplay),r=B(p=>p.selectionGridSize),o=B(p=>p.setSelectionGridSize),d=B(p=>p.setSelectionSearchText),c=m.useMemo(()=>l?`${a}/${n} match "${l}"`:`${n} selected`,[n,a,l]);return e(wt,{extra:s("div",{css:T`
            display: flex;
            flex-direction: row;
            gap: var(--ac-global-dimension-static-size-100);
          `,children:[e(sm,{placeholder:"Search by text or ID",onChange:p=>{d(p)}}),t===Pr.gallery&&e(Lp,{size:r,onChange:o}),e(wp,{mode:t,onChange:p=>{i(p)}})]}),children:e(v,{children:c})})}const Zo=Qo;function $v(){const{referenceInferences:n,corpusInferences:a}=Sn(),{timeRange:l}=Vn(),t=m.useMemo(()=>{let i={};return a!=null?i=Mp():n!=null?i=Rp():i=Ap(),i={...i,umapParameters:{...window.Config.UMAP}},i},[a,n]);return e(Ir,{initialTimestamp:l.end,children:e(Np,{...t,children:e(J1,{})})})}function J1(){const n=k1(),{primaryInferences:a,referenceInferences:l}=Sn(),t=B(F=>F.umapParameters),i=B(F=>F.getHDSCANParameters),r=B(F=>F.getMetric),o=B(F=>F.reset),d=B(F=>F.setLoading),[c,p]=m.useState(!0),[y,u,g]=x.useQueryLoader(Zo),{selectedTimestamp:f}=Il(),k=m.useMemo(()=>f??new Date(a.endTime),[f,a.endTime]),b=m.useMemo(()=>({start:Gi(k,2).toISOString(),end:k.toISOString()}),[k]),S=x.useLazyLoadQuery(Oo,{});return m.useEffect(()=>{o(),d(!0);const F=r();return u({id:n,timeRange:b,...t,...i(),fetchDataQualityMetric:F.type==="dataQuality",fetchPerformanceMetric:F.type==="performance",dataQualityMetricColumnName:F.type==="dataQuality"?F.dimension.name:null,performanceMetric:F.type==="performance"?F.metric:"accuracyScore"},{fetchPolicy:"network-only"}),()=>{g()}},[d,o,n,u,g,t,i,r,b]),s("main",{css:T`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(tk,{}),s(wt,{extra:s(h,{direction:"row",justifyContent:"center",alignItems:"center",gap:"size-100",children:[e(xa,{onChange:F=>{p(F)},defaultSelected:!0,labelPlacement:"start",children:"Show Timeseries"}),e(S1,{})]}),children:[e(vr,{}),l?e(Cr,{inferencesRole:"reference",timeRange:{start:new Date(l.startTime),end:new Date(l.endTime)}}):null,e(K1,{model:S.model})]}),s(Pn,{direction:"vertical",children:[c?s(H,{children:[e(Le,{defaultSize:20,collapsible:!0,order:1,children:e(m.Suspense,{fallback:e(Ce,{}),children:e(D1,{embeddingDimensionId:n})})}),e(Tn,{css:Wn})]}):null,e(Le,{order:2,children:e("div",{css:T`
              width: 100%;
              height: 100%;
              position: relative;
            `,children:e(m.Suspense,{fallback:e(zp,{}),children:y?e(X1,{queryReference:y}):null})})})]})]})}function Z1(n){if(n.__typename!=="Point3D")throw new Error(`Expected Point3D but got ${n.__typename} for coordinates`);return[n.x,n.y,n.z]}function X1({queryReference:n}){const a=x.usePreloadedQuery(Zo,n),l=m.useMemo(()=>{var p,y;return((y=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:y.data)??[]},[a]),t=m.useMemo(()=>{var p,y;return((y=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:y.referenceData)??[]},[a]),i=m.useMemo(()=>{var p,y;return((y=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:y.corpusData)??[]},[a]),r=m.useMemo(()=>{var p,y;return((y=(p=a.embedding)==null?void 0:p.UMAPPoints)==null?void 0:y.contextRetrievals)??[]},[a]),o=m.useMemo(()=>[...l,...t,...i].map(y=>({...y,position:Z1(y.coordinates),metaData:{id:y.eventId}})),[t,l,i]),d=B(p=>p.setInitialData),c=B(p=>p.setClusters);return Wu(()=>{var y,u;const p=((u=(y=a.embedding)==null?void 0:y.UMAPPoints)==null?void 0:u.clusters)||[];d({points:o,clusters:p,retrievals:r})},[o,n,r,d,c]),e("div",{css:T`
        flex: 1 1 auto;
        display: flex;
        flex-direction: row;
        align-items: stretch;
        width: 100%;
        height: 100%;
      `,"data-testid":"point-cloud-display",children:s(Pn,{direction:"horizontal",children:[e(Le,{id:"embedding-left",defaultSize:15,maxSize:30,minSize:10,collapsible:!0,children:s(Pn,{autoSaveId:"embedding-controls-vertical",direction:"vertical",children:[e(Le,{css:T`
                display: flex;
                flex-direction: column;
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  display: flex;
                  flex-direction: column;
                  [role="tablist"] {
                    flex: none;
                  }
                  .ac-tabs__pane-container {
                    flex: 1 1 auto;
                    overflow: hidden;
                    display: flex;
                    flex-direction: column;
                    & > div {
                      height: 100%;
                    }
                  }
                }
              `,children:e(ak,{})}),e(Tn,{css:Wn}),e(Le,{css:T`
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  .ac-tabs__pane-container {
                    height: 100%;
                    overflow-y: auto;
                  }
                }
              `,children:s(He,{children:[e(ne,{name:"Display",children:e($p,{})}),e(ne,{name:"Hyperparameters",children:e(Op,{})})]})})]})}),e(Tn,{css:Qp}),e(Le,{children:s("div",{css:T`
              position: relative;
              width: 100%;
              height: 100%;
            `,children:[e(Y1,{}),e(jp,{})]})})]})})}function Y1(){return B(a=>a.selectedEventIds).size===0?null:e("div",{css:T`
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
      `,"data-testid":"selection-panel",children:s(Pn,{direction:"vertical",children:[e(Le,{}),e(Tn,{css:Wn,style:{zIndex:1}}),e(Le,{id:"embedding-point-selection",defaultSize:40,minSize:20,order:2,style:{zIndex:1},children:e(ek,{children:e(m.Suspense,{fallback:e(Ce,{}),children:e(G1,{})})})})]})})}function ek(n){return e("div",{css:T`
        background-color: var(--ac-global-color-grey-75);
        width: 100%;
        height: 100%;
      `,children:n.children})}const nk=1,ak=Ie.memo(function(){const{referenceInferences:a}=Sn(),l=B(u=>u.clusters),t=B(u=>u.selectedClusterId),i=B(u=>u.metric),r=B(u=>u.setSelectedClusterId),o=B(u=>u.setSelectedEventIds),d=B(u=>u.setHighlightedClusterId),c=B(u=>u.setClusterColorMode),p=a==null||i.type==="drift",y=m.useCallback(u=>{c(u===nk?mi.highlight:mi.default)},[c]);return s(He,{onChange:y,children:[e(ne,{name:"Clusters",extra:e(un,{children:l.length}),children:s(h,{direction:"column",height:"100%",children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"dark",flex:"none",padding:"size-50",children:e(h,{direction:"row",justifyContent:"end",children:e(b1,{})})}),e(C,{flex:"1 1 auto",overflow:"auto",children:e("ul",{css:T`
                flex: 1 1 auto;
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-size-100);
                margin: var(--ac-global-dimension-size-100);
              `,children:l.map(u=>e("li",{children:e(Ep,{clusterId:u.id,numPoints:u.eventIds.length,isSelected:t===u.id,driftRatio:u.driftRatio,primaryToCorpusRatio:u.primaryToCorpusRatio,primaryMetricValue:u.primaryMetricValue,referenceMetricValue:u.referenceMetricValue,metricName:lk(i),hideReference:p,onClick:()=>{t!==u.id?(r(u.id),o(new Set(u.eventIds))):(r(null),o(new Set))},onMouseEnter:()=>{d(u.id)},onMouseLeave:()=>{d(null)}})},u.id))})})]})}),e(ne,{name:"Configuration",children:e(C,{overflow:"auto",height:"100%",children:e(Vp,{})})})]})});function lk(n){const{type:a,metric:l}=n;switch(a){case"dataQuality":return`${n.dimension.name} avg`;case"drift":{switch(l){case"euclideanDistance":return"Cluster Drift";default:ke()}break}case"performance":return sa(l);case"retrieval":{switch(l){case"queryDistance":return"% Query";default:ke()}break}default:ke()}}function tk(){const{notifyError:n}=Fr(),a=B(t=>t.errorMessage),l=B(t=>t.setErrorMessage);return m.useEffect(()=>{a!==null&&n({title:"An error occurred",message:a,action:{text:"Dismiss",onClick:()=>{l(null)}}})},[a,n,l]),null}const Xo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[t],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"cff0ac130f1ef79784f7bef4161ac60d",id:null,metadata:{},name:"embeddingLoaderQuery",operationKind:"query",text:`query embeddingLoaderQuery(
  $id: GlobalID!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      id
      name
    }
    __isNode: __typename
    id
  }
}
`}}}();Xo.hash="c049e57d92943f64b5e751e0daa89dc8";async function Ov(n){const{embeddingDimensionId:a}=n.params;return x.fetchQuery(be,Xo,{id:a}).toPromise()}const Yo=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"hasReference"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"timeRange",variableName:"timeRange"},o=[r],d=[{kind:"Variable",name:"hasReference",variableName:"hasReference"},r],c={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}],y={kind:"Literal",name:"metric",value:"cardinality"},u={kind:"Literal",name:"metric",value:"percentEmpty"},g={kind:"Literal",name:"inferencesRole",value:"reference"};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionPageQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[i,{args:o,kind:"FragmentSpread",name:"DimensionSegmentsBarChart_dimension"},{args:o,kind:"FragmentSpread",name:"DimensionCountStats_dimension"},{args:o,kind:"FragmentSpread",name:"DimensionDriftStats_dimension"},{args:d,kind:"FragmentSpread",name:"DimensionCardinalityStats_dimension"},{args:d,kind:"FragmentSpread",name:"DimensionPercentEmptyStats_dimension"},{args:o,kind:"FragmentSpread",name:"DimensionQuantilesStats_dimension"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionPageQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[c,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[c,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:p,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:p,storageKey:null}],storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},r],kind:"ScalarField",name:"driftMetric",storageKey:null},{alias:"cardinality",args:[y,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[u,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[g,y],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'},{alias:"referencePercentEmpty",args:[g,u],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"2ad937e56d4647309b9d78ac11f57265",id:null,metadata:{},name:"DimensionPageQuery",operationKind:"query",text:`query DimensionPageQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $hasReference: Boolean!
) {
  dimension: node(id: $dimensionId) {
    __typename
    ... on Dimension {
      id
      ...DimensionSegmentsBarChart_dimension_3E0ZE6
      ...DimensionCountStats_dimension_3E0ZE6
      ...DimensionDriftStats_dimension_3E0ZE6
      ...DimensionCardinalityStats_dimension_1JBzL3
      ...DimensionPercentEmptyStats_dimension_1JBzL3
      ...DimensionQuantilesStats_dimension_3E0ZE6
    }
    __isNode: __typename
    id
  }
}

fragment DimensionCardinalityStats_dimension_1JBzL3 on Dimension {
  id
  cardinality: dataQualityMetric(metric: cardinality, timeRange: $timeRange)
  referenceCardinality: dataQualityMetric(metric: cardinality, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionCountStats_dimension_3E0ZE6 on Dimension {
  id
  count: dataQualityMetric(metric: count, timeRange: $timeRange)
}

fragment DimensionDriftStats_dimension_3E0ZE6 on Dimension {
  id
  psi: driftMetric(metric: psi, timeRange: $timeRange)
}

fragment DimensionPercentEmptyStats_dimension_1JBzL3 on Dimension {
  id
  percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: $timeRange)
  referencePercentEmpty: dataQualityMetric(metric: percentEmpty, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionQuantilesStats_dimension_3E0ZE6 on Dimension {
  p99: dataQualityMetric(metric: p99, timeRange: $timeRange)
  p75: dataQualityMetric(metric: p75, timeRange: $timeRange)
  p50: dataQualityMetric(metric: p50, timeRange: $timeRange)
  p25: dataQualityMetric(metric: p25, timeRange: $timeRange)
  p1: dataQualityMetric(metric: p01, timeRange: $timeRange)
}

fragment DimensionSegmentsBarChart_dimension_3E0ZE6 on Dimension {
  id
  segmentsComparison(primaryTimeRange: $timeRange) {
    segments {
      bin {
        __typename
        ... on NominalBin {
          __typename
          name
        }
        ... on IntervalBin {
          __typename
          range {
            start
            end
          }
        }
        ... on MissingValueBin {
          __typename
        }
      }
      counts {
        primaryValue
      }
    }
    totalCounts {
      primaryValue
    }
  }
}
`}}}();Yo.hash="d194bfd656408e8ba7cb427ddc80fc85";const ed=function(){var n={kind:"Literal",name:"metric",value:"cardinality"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCardinalityStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"cardinality",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'}]}],type:"Dimension",abstractKey:null}}();ed.hash="8b4edef350e4df49e799afa70ca34918";function ik(n){const a=x.useFragment(ed,n.dimension);return s(H,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"Cardinality"}),e(v,{children:oa(a.cardinality)}),a.referenceCardinality!=null&&e(v,{size:"S",color:"purple-800",children:oa(a.referenceCardinality)})]})}const nd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"cardinalityTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"cardinality"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"f53e5ac5e0bfd6a0a6c50b761223a617",id:null,metadata:{},name:"DimensionCardinalityTimeSeriesQuery",operationKind:"query",text:`query DimensionCardinalityTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      cardinalityTimeSeries: dataQualityTimeSeries(metric: cardinality, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();nd.hash="88ce04bb2022d5e2bc75c663abd7e5de";const al={top:25,right:18,left:18,bottom:5},rk=new Intl.NumberFormat([],{maximumFractionDigits:2}),ad=()=>{const{gray300:n}=Mn();return{color:n}};function sk({active:n,payload:a,label:l}){var i;const{color:t}=ad();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,o=typeof r=="number"?rk.format(r):"--";return s(Zn,{children:[e(v,{weight:"heavy",size:"S",children:`${gn(new Date(l))}`}),e($e,{color:t,name:"Cardinality",value:o}),e(xl,{})]})}return null}function ok({dimensionId:n}){var d;const{timeRange:a}=Vn(),l=La(a),t=x.useLazyLoadQuery(nd,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:l}),{color:i}=ad(),r=((d=t.dimension.cardinalityTimeSeries)==null?void 0:d.data.map(c=>({timestamp:new Date(c.timestamp).valueOf(),value:c.value})))||[],o=wa({samplingIntervalMinutes:l.samplingIntervalMinutes});return e(ea,{width:"100%",height:"100%",children:s(el,{data:r,margin:al,syncId:"dimensionDetails",children:[e("defs",{children:s("linearGradient",{id:"cardinalityColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:i,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:i,stopOpacity:0})]})}),e(na,{...Ea,tickFormatter:c=>o(new Date(c))}),e(fn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Cardinality",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(aa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(la,{content:e(sk,{})}),e(Ha,{type:"monotone",dataKey:"value",stroke:i,fillOpacity:1,fill:"url(#cardinalityColorUv)"})]})})}const ld={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCountStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null};ld.hash="6dccac51f3fb0853276677c692af5a43";function dk(n){const l=x.useFragment(ld,n.dimension).count??0;return s(H,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"Total Count"}),e(v,{size:"L",children:oa(l)})]})}const td=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,n],kind:"Operation",name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"1f9eff6d8d453148844edae32b844df7",id:null,metadata:{},name:"DimensionCountTimeSeriesQuery",operationKind:"query",text:`query DimensionCountTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();td.hash="9677ef7c6b298554824fe3fd3904c7aa";const ck=new Intl.NumberFormat([],{maximumFractionDigits:2}),id=()=>{const{gray300:n}=Mn();return{barColor:n}};function uk({active:n,payload:a,label:l}){var i;const{barColor:t}=id();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,o=typeof r=="number"?ck.format(r):"--";return s(Zn,{children:[e(v,{weight:"heavy",size:"S",children:`${gn(new Date(l))}`}),e($e,{color:t,shape:"square",name:"Count",value:o})]})}return null}function mk({dimensionId:n}){var c;const{timeRange:a}=Vn(),l=La(a),r=(((c=x.useLazyLoadQuery(td,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},countGranularity:l}).embedding.trafficTimeSeries)==null?void 0:c.data)||[]).map(p=>({...p,timestamp:new Date(p.timestamp).valueOf()})),o=wa({samplingIntervalMinutes:l.samplingIntervalMinutes}),{barColor:d}=id();return e(ea,{width:"100%",height:"100%",children:s(Nt,{data:r,margin:al,syncId:"dimensionDetails",children:[e("defs",{children:s("linearGradient",{id:"countBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:d,stopOpacity:1}),e("stop",{offset:"95%",stopColor:d,stopOpacity:.5})]})}),e(na,{...Ea,tickFormatter:p=>o(new Date(p))}),e(fn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Count",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(aa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(la,{...Vt,content:e(uk,{})}),e(Ta,{dataKey:"value",fill:"url(#countBarColor)",spacing:5})]})})}const rd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"dimensionId"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"dimensionId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],c={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:d,storageKey:null},p={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:d,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{kind:"RequiredField",field:{alias:null,args:t,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[i,r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[i,o],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[i],type:"MissingValueBin",abstractKey:null}],storageKey:null},c],storageKey:null},p],storageKey:null},action:"THROW",path:"dimension.segmentsComparison"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,l,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[i,{kind:"InlineFragment",selections:[r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[o],type:"IntervalBin",abstractKey:null}],storageKey:null},c],storageKey:null},p],storageKey:null}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"7d11d88f419003f5ee8cd9d11312e427",id:null,metadata:{},name:"DimensionDriftBreakdownSegmentBarChartQuery",operationKind:"query",text:`query DimensionDriftBreakdownSegmentBarChartQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      segmentsComparison(primaryTimeRange: $timeRange) {
        segments {
          bin {
            __typename
            ... on NominalBin {
              __typename
              name
            }
            ... on IntervalBin {
              __typename
              range {
                start
                end
              }
            }
            ... on MissingValueBin {
              __typename
            }
          }
          counts {
            primaryValue
            referenceValue
          }
        }
        totalCounts {
          primaryValue
          referenceValue
        }
      }
    }
  }
}
`}}}();rd.hash="6bb76e3cce4ee28c333e485b3aa2dffd";const Ei=ct(".2f"),sd=()=>{const{primary:n,reference:a}=Mn();return{primaryBarColor:n,referenceBarColor:a}};function pk({active:n,payload:a,label:l}){var r,o,d,c,p,y;const{primaryBarColor:t,referenceBarColor:i}=sd();if(n&&a&&a.length){const u=(o=(r=a[0])==null?void 0:r.payload)==null?void 0:o.primaryName,g=(d=a[0])==null?void 0:d.value,f=(p=(c=a[0])==null?void 0:c.payload)==null?void 0:p.referenceName,k=(y=a[1])==null?void 0:y.value;return s(Zn,{children:[e(v,{elementType:"h3",size:"S",weight:"heavy",children:l}),e($e,{color:t,shape:"square",name:u,value:g!=null?`${Ei(g)}%`:"--"}),e($e,{color:i,shape:"square",name:f,value:k!=null?`${Ei(k)}%`:"--"})]})}return null}function gk(n){var g,f,k,b,S;const{primaryInferences:a,referenceInferences:l}=Sn(),t=a.name,i=(l==null?void 0:l.name)||"reference",{selectedTimestamp:r}=Il(),o=m.useMemo(()=>r??new Date(a.endTime),[r,a.endTime]),d=m.useMemo(()=>({start:Gi(o,2).toISOString(),end:o.toISOString()}),[o]),c=x.useLazyLoadQuery(rd,{dimensionId:n.dimensionId,timeRange:d}),p=m.useMemo(()=>{var w,K,I,E,V;const F=((w=c.dimension.segmentsComparison)==null?void 0:w.segments)??[],P=((I=(K=c.dimension.segmentsComparison)==null?void 0:K.totalCounts)==null?void 0:I.primaryValue)??0,D=((V=(E=c.dimension.segmentsComparison)==null?void 0:E.totalCounts)==null?void 0:V.referenceValue)??0;return F.map(Q=>{var N,j;const R=((N=Q.counts)==null?void 0:N.primaryValue)??0,q=((j=Q.counts)==null?void 0:j.referenceValue)??0,ee=xr(Q.bin),ge=R/P*100,he=q/D*100;return{name:ee,primaryName:t,referenceName:i,primaryPercent:ge,referencePercent:he}})},[(g=c.dimension.segmentsComparison)==null?void 0:g.segments,(k=(f=c.dimension.segmentsComparison)==null?void 0:f.totalCounts)==null?void 0:k.primaryValue,(S=(b=c.dimension.segmentsComparison)==null?void 0:b.totalCounts)==null?void 0:S.referenceValue,t,i]),{primaryBarColor:y,referenceBarColor:u}=sd();return s(h,{direction:"column",height:"100%",children:[e(C,{flex:"none",paddingTop:"size-100",paddingStart:"size-200",children:e(v,{elementType:"h3",size:"S",color:"text-700",children:`Distribution comparison at ${gn(new Date(d.end))}`})}),e(C,{flex:!0,children:e(ea,{children:s(Nt,{data:p,margin:{top:15,right:18,left:18,bottom:5},children:[s("defs",{children:[s("linearGradient",{id:"dimensionPrimarySegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:y,stopOpacity:1}),e("stop",{offset:"95%",stopColor:y,stopOpacity:.5})]}),s("linearGradient",{id:"dimensionReferenceSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:u,stopOpacity:1}),e("stop",{offset:"95%",stopColor:u,stopOpacity:.5})]})]}),e(na,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(fn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Percent",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(aa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)"}),e(la,{...Vt,content:e(pk,{})}),e(Ta,{dataKey:"primaryPercent",fill:"url(#dimensionPrimarySegmentsBarColor)"}),e(Ta,{dataKey:"referencePercent",fill:"url(#dimensionReferenceSegmentsBarColor)"})]})})})]})}const od={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionDriftStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"driftMetric",storageKey:null}],type:"Dimension",abstractKey:null};od.hash="f8a9fb08a14f63906e38bc247d50b189";const yk=s(Ia,{variant:"info",placement:"top end",children:[e(te,{weight:"heavy",level:4,children:"Population Stability Index"}),e(Un,{children:e(v,{children:"PSI is a symmetric metric that measures the relative entropy, or difference in information represented by two distributions. It can be thought of as measuring the distance between two data distributions showing how different the two distributions are from each other."})}),e("footer",{children:e(en,{href:"https://arize.com/blog-course/population-stability-index-psi/#:~:text=Population%20Stability%20Index%20(PSI)%20Overview,distributions%20are%20from%20each%20other.",children:"Learn more"})})]});function fk(n){const a=x.useFragment(od,n.dimension);return s(H,{children:[s(h,{direction:"row",alignItems:"center",gap:"size-25",children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"PSI"}),yk]}),e(v,{size:"L",children:Sa(a.psi)})]})}const dd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"driftGranularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},i=[{kind:"Variable",name:"id",variableName:"dimensionId"}],r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={kind:"Variable",name:"timeRange",variableName:"timeRange"},d=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],c={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"granularity",variableName:"driftGranularity"},{kind:"Literal",name:"metric",value:"psi"},o],concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l,t],kind:"Fragment",metadata:null,name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,l,n],kind:"Operation",name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,c],storageKey:null}]},params:{cacheID:"af2d25e28675891b3c8a6bc75027f731",id:null,metadata:{},name:"DimensionDriftTimeSeriesQuery",operationKind:"query",text:`query DimensionDriftTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $driftGranularity: Granularity!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      driftTimeSeries(metric: psi, timeRange: $timeRange, granularity: $driftGranularity) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();dd.hash="6312b58dbb252b17efdf08d44dd58630";const cd=()=>{const{orange300:n,gray300:a}=Mn();return{color:n,barColor:a}};function hk({active:n,payload:a,label:l}){var i;const{color:t}=cd();if(n&&a&&a.length){const r=((i=a[1])==null?void 0:i.value)??null;return s(Zn,{children:[e(v,{weight:"heavy",size:"S",children:`${gn(new Date(l))}`}),e($e,{color:t,name:"PSI",value:Sa(r)}),e(xl,{}),s("div",{css:T`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);

            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(_,{svg:e(xn,{})}),e("span",{children:"Click to view details"})]})]})}return null}function kk({dimensionId:n}){var f,k;const{timeRange:a}=Vn(),{selectedTimestamp:l,setSelectedTimestamp:t}=Il(),i=La(a),r=x.useLazyLoadQuery(dd,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},driftGranularity:Kr(a),countGranularity:i}),o=((f=r.embedding.driftTimeSeries)==null?void 0:f.data)||[],d=((k=r.embedding.trafficTimeSeries)==null?void 0:k.data.reduce((b,S)=>(b[S.timestamp]=S.value,b),{}))??{},c=o.map(b=>{const S=d[b.timestamp];return{...b,traffic:S,timestamp:new Date(b.timestamp).valueOf()}}),p=wa({samplingIntervalMinutes:i.samplingIntervalMinutes}),y=m.useCallback(b=>{const{activePayload:S}=b;if(S!=null&&S.length>0){const F=S[0].payload;t(new Date(F.timestamp))}},[t]),{color:u,barColor:g}=cd();return e(ea,{width:"100%",height:"100%",children:s(el,{data:c,margin:al,onClick:y,syncId:"dimensionDetails",children:[s("defs",{children:[s("linearGradient",{id:"dimensionDriftColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:u,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:u,stopOpacity:0})]}),s("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:g,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:g,stopOpacity:0})]})]}),e(na,{...Ea,tickFormatter:b=>p(new Date(b))}),e(fn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"PSI",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-color-grey-500)"}}),e(fn,{yAxisId:"right",orientation:"right",tick:!1,tickLine:!1,width:0}),e(aa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(la,{content:e(hk,{})}),e(Ta,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(Ha,{type:"monotone",dataKey:"value",stroke:u,fillOpacity:1,fill:"url(#dimensionDriftColorUv)"}),l!=null?e(Ur,{...Tr,x:l.getTime()}):null]})})}const ud=function(){var n={kind:"Literal",name:"metric",value:"percentEmpty"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"percentEmpty",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referencePercentEmpty",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}}();ud.hash="1e10d0449d6607d9292f355548c41c78";function bk(n){const a=x.useFragment(ud,n.dimension);return s(H,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"% Empty"}),e(v,{size:"L",children:tt(a.percentEmpty)}),a.referencePercentEmpty!=null&&e(v,{size:"M",color:"purple-800",children:tt(a.referencePercentEmpty)})]})}const md=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"percentEmptyTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"percentEmpty"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"9be05c72f19755036f4829777a96f97d",id:null,metadata:{},name:"DimensionPercentEmptyTimeSeriesQuery",operationKind:"query",text:`query DimensionPercentEmptyTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      percentEmptyTimeSeries: dataQualityTimeSeries(metric: percentEmpty, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();md.hash="1e843d6c8dbe05b389b24188c6bdb394";const Sk=new Intl.NumberFormat([],{maximumFractionDigits:2}),pd=()=>{const{gray100:n}=Mn();return{color:n}};function vk({active:n,payload:a,label:l}){var i;const{color:t}=pd();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,o=typeof r=="number"?Sk.format(r):"--";return s(Zn,{children:[e(v,{weight:"heavy",size:"S",children:`${gn(new Date(l))}`}),e($e,{color:t,name:"% Empty",value:o})]})}return null}function Ck({dimensionId:n}){var d;const{timeRange:a}=Vn(),l=La(a),i=((d=x.useLazyLoadQuery(md,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:l}).embedding.percentEmptyTimeSeries)==null?void 0:d.data.map(c=>({timestamp:new Date(c.timestamp).valueOf(),value:c.value})))||[],r=wa({samplingIntervalMinutes:l.samplingIntervalMinutes}),{color:o}=pd();return e(ea,{width:"100%",height:"100%",children:s(el,{data:i,margin:al,syncId:"dimensionDetails",children:[e("defs",{children:s("linearGradient",{id:"percentEmptyColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:o,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:o,stopOpacity:0})]})}),e(na,{...Ea,tickFormatter:c=>r(new Date(c))}),e(fn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"% Empty",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(aa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(la,{content:e(vk,{})}),e(Br,{type:"monotone",dataKey:"value",stroke:o,fillOpacity:1,fill:"url(#percentEmptyColorUv)"})]})})}const gd=function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionQuantilesStats_dimension",selections:[{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null}}();gd.hash="c306c8eafb1d34be464d3a658d5f94a7";function Fk(n){const a=x.useFragment(gd,n.dimension);return e("ul",{css:T`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-50);
      `,children:Object.keys(a).map(l=>{const t=a[l];return s("li",{css:T`
              display: flex;
              flex-direction: column;
              align-items: flex-end;
            `,children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:l}),e(v,{size:"S","data-raw":t,children:Pt(t)})]},l)})})}const yd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"granularity",variableName:"granularity"},o={kind:"Variable",name:"timeRange",variableName:"timeRange"},d=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],c={kind:"InlineFragment",selections:[{alias:"p99TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p99"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p75TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p75"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p50TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p50"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p25TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p25"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p01TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p01"},o],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,c],storageKey:null}]},params:{cacheID:"0bb3d9faf9d7f0c2e27995120ae24e1c",id:null,metadata:{},name:"DimensionQuantilesTimeSeriesQuery",operationKind:"query",text:`query DimensionQuantilesTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      p99TimeSeries: dataQualityTimeSeries(metric: p99, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p75TimeSeries: dataQualityTimeSeries(metric: p75, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p50TimeSeries: dataQualityTimeSeries(metric: p50, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p25TimeSeries: dataQualityTimeSeries(metric: p25, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p01TimeSeries: dataQualityTimeSeries(metric: p01, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();yd.hash="134f0dad0e0ecc7863dfbb0f437d829b";const Kk=ct("~s");var fd=(n=>(n.p99_p01="p99_p01",n.p75_p25="p75_p25",n.p50="p50",n))(fd||{});const Tk=new Intl.NumberFormat([],{maximumFractionDigits:2});function Na(n){return typeof n=="number"?Tk.format(n):"--"}const hd=()=>{const n=Mn();return{outerColor:n.gray500,innerColor:n.gray300,lineColor:n.default}};function Pk({active:n,payload:a,label:l}){const{outerColor:t,innerColor:i,lineColor:r}=hd();if(n&&a&&a.length){const o=a[0].payload;return s(Zn,{children:[e(v,{weight:"heavy",size:"S",children:`${gn(new Date(l))}`}),e($e,{color:t,name:"p99",value:Na(o.p99_p01[0])}),e($e,{color:i,name:"p75",value:Na(o.p75_p25[0])}),e($e,{color:r,name:"p50",value:Na(o.p50)}),e($e,{color:i,name:"p25",value:Na(o.p75_p25[1])}),e($e,{color:t,name:"p01",value:Na(o.p99_p01[1])})]})}return null}function Ik({dimensionId:n}){var D,w,K,I,E;const{timeRange:a}=Vn(),l=La(a),t=x.useLazyLoadQuery(yd,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:l}),i=((D=t.dimension.p99TimeSeries)==null?void 0:D.data.map(V=>V))||[],r=((w=t.dimension.p01TimeSeries)==null?void 0:w.data.map(V=>V))||[],o=((K=t.dimension.p75TimeSeries)==null?void 0:K.data.map(V=>V))||[],d=((I=t.dimension.p25TimeSeries)==null?void 0:I.data.map(V=>V))||[],c=((E=t.dimension.p50TimeSeries)==null?void 0:E.data.map(V=>V))||[],p=i.map((V,Q)=>({timestamp:new Date(V.timestamp).valueOf(),p99_p01:[V.value,r[Q].value],p75_p25:[o[Q].value,d[Q].value],p50:c[Q].value})),y=wa({samplingIntervalMinutes:l.samplingIntervalMinutes}),[u,g]=m.useState(Object.keys(fd).reduce((V,Q)=>(V[Q]=!1,V),{})),f=V=>{u[V.dataKey]||g({...u})},k=()=>{g({...u})},b=V=>{g({...u,[String(V.dataKey)]:!u[V.dataKey]})},{outerColor:S,innerColor:F,lineColor:P}=hd();return e(ea,{width:"100%",height:"100%",children:s(el,{data:p,margin:al,syncId:"dimensionDetails",children:[s("defs",{children:[s("linearGradient",{id:"p99_p01ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:S,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:S,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:S,stopOpacity:.7})]}),s("linearGradient",{id:"p75_p25ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:F,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:F,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:F,stopOpacity:.7})]})]}),e(na,{...Ea,tickFormatter:V=>y(new Date(V))}),e(fn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Value",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},tickFormatter:V=>Kk(V),style:{fill:"var(--ac-global-text-color-700)"}}),e(aa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(la,{content:e(Pk,{})}),e(bg,{onClick:b,onMouseOver:f,onMouseOut:k}),e(Ha,{type:"monotone",dataKey:"p99_p01",name:"p99 - p01",fillOpacity:1,fill:"url(#p99_p01ColorUV)",stroke:S,hide:u.p99_p01===!0}),e(Ha,{type:"monotone",dataKey:"p75_p25",name:"p75 - p25",fillOpacity:1,stroke:F,fill:"url(#p75_p25ColorUV)",hide:u.p75_p25===!0}),e(Br,{type:"monotone",dataKey:"p50",stroke:P,hide:u.p50===!0})]})})}const kd=function(){var n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionSegmentsBarChart_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[n,{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[n],type:"MissingValueBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:a,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:a,storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null}}();kd.hash="8cef9841e9a5bd7d0d50acb5db9028b0";const xk=ct(".2f"),bd=()=>{const{primary:n}=Mn();return{color:n}};function Dk({active:n,payload:a,label:l}){var i;const{color:t}=bd();if(n&&a&&a.length){const r=(i=a[0])==null?void 0:i.value;return e(Zn,{children:e($e,{color:t,shape:"square",name:l,value:r!=null?`${xk(r)}%`:"--"})})}return null}function _k(n){const a=x.useFragment(kd,n.dimension),l=m.useMemo(()=>{var o,d,c;const i=((o=a.segmentsComparison)==null?void 0:o.segments)??[],r=((c=(d=a.segmentsComparison)==null?void 0:d.totalCounts)==null?void 0:c.primaryValue)??0;return i.map(p=>{var f;const y=((f=p.counts)==null?void 0:f.primaryValue)??0,u=xr(p.bin),g=y/r*100;return{name:u,percent:g}})},[a]),{color:t}=bd();return e(ea,{children:s(Nt,{data:l,margin:{top:25,right:18,left:18,bottom:5},children:[e("defs",{children:s("linearGradient",{id:"dimensionSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:t,stopOpacity:1}),e("stop",{offset:"95%",stopColor:t,stopOpacity:.5})]})}),e(na,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(fn,{stroke:"var(--ac-global-color-grey-500)",label:{value:"% Volume",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(aa,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(la,{...Vt,content:e(Dk,{})}),e(Ta,{dataKey:"percent",fill:"url(#dimensionSegmentsBarColor)",spacing:15})]})})}function Qv(){const{dimensionId:n}=an(),{timeRange:a}=Vn(),l=Ue(),{referenceInferences:t}=Sn(),i=t!==null,r=i,o=l.dimension.shape!=="continuous",d=l.dimension.dataType==="numeric",c=se(),p=x.useLazyLoadQuery(Yo,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},hasReference:i});if(!n)throw new Error("Dimension ID is required to display a dimension");return e(Ir,{initialTimestamp:new Date(a.end),children:e(Y,{type:"slideOver",isDismissable:!0,onDismiss:()=>c(-1),children:e(X,{size:"L",title:l.dimension.name,children:e("main",{css:T`
              padding: var(--ac-global-dimension-static-size-100);
              display: flex;
              flex-direction: column;
              min-height: 400px;
              overflow-y: auto;
              height: 100%;
            `,children:e(m.Suspense,{fallback:e(Ce,{}),children:s(h,{direction:"column",gap:"size-100",children:[e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:e(_k,{dimension:p.dimension})}),e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600","data-testid":"dimension-count-time-series-view",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(mk,{dimensionId:n}),e(ia,{children:e(dk,{dimension:p.dimension})})]})}),r?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",children:s(h,{direction:"column",alignItems:"stretch",children:[e(C,{width:"100%",height:"size-1600",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(kk,{dimensionId:n})}),e(ia,{children:e(fk,{dimension:p.dimension})})]})}),e(C,{height:"size-1600",width:"100%",borderTopColor:"dark",borderTopWidth:"thin",children:e(m.Suspense,{fallback:e(Ce,{}),children:e(gk,{dimensionId:n})})})]})}):null,d?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-3000",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(Ik,{dimensionId:n})}),e(ia,{children:e(Fk,{dimension:p.dimension})})]})}):null,o?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(ok,{dimensionId:n})}),e(ia,{children:e(ik,{dimension:p.dimension})})]})}):null,e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:s(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(Ck,{dimensionId:n}),e(ia,{children:e(bk,{dimension:p.dimension})})]})})]})})})})})})}const Sd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"shape",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t,i,r],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[t,i,r],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"03a9aafe3f08a9d093b029ff4a9e3253",id:null,metadata:{},name:"dimensionLoaderQuery",operationKind:"query",text:`query dimensionLoaderQuery(
  $id: GlobalID!
) {
  dimension: node(id: $id) {
    __typename
    ... on Dimension {
      id
      name
      dataType
      shape
    }
    __isNode: __typename
    id
  }
}
`}}}();Sd.hash="5a662d77e69d2e9bb4eb2af4cad6b722";async function jv(n){const{dimensionId:a}=n.params;return x.fetchQuery(be,Sd,{id:a}).toPromise()}const vd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={kind:"Variable",name:"timeRange",variableName:"timeRange"},o=[{kind:"Literal",name:"first",value:50},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},r],d={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},c={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},g=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],f={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:g,storageKey:null},k={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:g,storageKey:null},b={alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},S={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},F={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},P=[r];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"TracesTable_spans"},{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"},{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:o,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,d,i,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},c,p,y,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},u,f,k,b,S,F,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"descendants",plural:!0,selections:[t,d,i,c,p,y,u,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},f,k,b,S,F],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:o,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"},{alias:null,args:P,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:P,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:P,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:P,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},r],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},r],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"58844e1d5d6347db1d6c4687b539dbe4",id:null,metadata:{},name:"ProjectPageQuery",operationKind:"query",text:`query ProjectPageQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...TracesTable_spans
    ...ProjectPageHeader_stats
    ...StreamToggle_data
    __isNode: __typename
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  tokenCountTotal(timeRange: $timeRange)
  tokenCountPrompt(timeRange: $timeRange)
  tokenCountCompletion(timeRange: $timeRange)
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}

fragment TracesTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: 50, sort: {col: startTime, dir: desc}, rootSpansOnly: true, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode: propagatedStatusCode
        startTime
        latencyMs
        cumulativeTokenCountTotal
        cumulativeTokenCountPrompt
        cumulativeTokenCountCompletion
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        context {
          spanId
          traceId
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants {
          id
          spanKind
          name
          statusCode: propagatedStatusCode
          startTime
          latencyMs
          parentId
          cumulativeTokenCountTotal: tokenCountTotal
          cumulativeTokenCountPrompt: tokenCountPrompt
          cumulativeTokenCountCompletion: tokenCountCompletion
          input {
            value: truncatedValue
          }
          output {
            value: truncatedValue
          }
          context {
            spanId
            traceId
          }
          spanAnnotations {
            id
            name
            label
            score
            annotatorKind
          }
          documentRetrievalMetrics {
            evaluationName
            ndcg
            precision
            hit
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();vd.hash="e2d168c52b9c1b5fd5543286f4d2786c";const Cd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:50},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],r=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:i,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:i,filters:["sort","filterIoSubstring","timeRange"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"bea6d52a2d550bcdcc441e8ea3c6fdfc",id:null,metadata:{},name:"ProjectPageSessionsQuery",operationKind:"query",text:`query ProjectPageSessionsQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...SessionsTable_sessions
    __isNode: __typename
    id
  }
}

fragment SessionsTable_sessions on Project {
  name
  sessions(first: 50, sort: {col: startTime, dir: desc}, timeRange: $timeRange) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          prompt
          completion
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Cd.hash="58a3bc9becb7a255676ca0efafb8d0b7";const Fd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r=[{kind:"Literal",name:"first",value:50},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],o=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageSpansQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageSpansQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:r,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:r,filters:["sort","filterCondition","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"09e4f18ba3f2a63560f542088a4329ff",id:null,metadata:{},name:"ProjectPageSpansQuery",operationKind:"query",text:`query ProjectPageSpansQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...SpansTable_spans
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: 50, sort: {col: startTime, dir: desc}, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        tokenCountTotal
        tokenCountPrompt
        tokenCountCompletion
        context {
          spanId
          traceId
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Fd.hash="18fe45fad1c124d8c29cdcabf463a213";const Kd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],t={kind:"Variable",name:"timeRange",variableName:"timeRange"},i=[t];return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectPageHeaderQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectPageHeaderQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"2b81cd60d6a8a82b6814df7a5a658114",id:null,metadata:{},name:"ProjectPageHeaderQuery",operationKind:"query",text:`query ProjectPageHeaderQuery(
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ProjectPageHeader_stats
    __isNode: __typename
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  tokenCountTotal(timeRange: $timeRange)
  tokenCountPrompt(timeRange: $timeRange)
  tokenCountCompletion(timeRange: $timeRange)
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}
`}}}();Kd.hash="e110b84031cc6bfa6bb37751b9c69765";const Td=function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"},a=[n];return{argumentDefinitions:[{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Kd,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ProjectPageHeader_stats",selections:[{alias:null,args:a,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null}}();Td.hash="e110b84031cc6bfa6bb37751b9c69765";const Pd=m.createContext(null);function ga(){const n=Ie.useContext(Pd);if(n===null)throw new Error("useStreamState must be used within a StreamStateProvider");return n}function Lk({initialFetchKey:n="initial",children:a}){const l=Ge(d=>d.traceStreamingEnabled),t=Ge(d=>d.setTraceStreamingEnabled),[i,r]=m.useState(n),o=m.useCallback(d=>{m.startTransition(()=>{r(d)})},[r]);return e(Pd.Provider,{value:{isStreaming:l,setIsStreaming:t,fetchKey:i,setFetchKey:o},children:a})}const Id=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"bae90b7000aa37d37050070d8504b41c",id:null,metadata:{},name:"AnnotationSummaryValueQuery",operationKind:"query",text:`query AnnotationSummaryValueQuery(
  $annotationName: String!
  $timeRange: TimeRange!
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    __isNode: __typename
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}}();Id.hash="0a8e190e4d87acc87c161366f330e3af";const xd={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"annotationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Id,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"AnnotationSummaryValueFragment",selections:[{alias:null,args:[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};xd.hash="0a8e190e4d87acc87c161366f330e3af";const Dd=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"AnnotationSummaryQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,l],kind:"Operation",name:"AnnotationSummaryQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"88dfad5d25db7e03286a789f3ba37c75",id:null,metadata:{},name:"AnnotationSummaryQuery",operationKind:"query",text:`query AnnotationSummaryQuery(
  $id: GlobalID!
  $annotationName: String!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    __isNode: __typename
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}}();Dd.hash="6a15ba35fe9e1e35aa4c517ab6309a2b";function wk({annotationName:n}){var i,r;const{projectId:a}=an(),{timeRange:l}=Dl(),t=x.useLazyLoadQuery(Dd,{annotationName:n,id:a,timeRange:{start:(i=l==null?void 0:l.start)==null?void 0:i.toISOString(),end:(r=l==null?void 0:l.end)==null?void 0:r.toISOString()}});return s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:n}),e(m.Suspense,{fallback:e(v,{size:"L",children:"--"}),children:e(Ek,{annotationName:n,project:t.project})})]})}function Ek(n){var f,k;const{project:a,annotationName:l}=n,{fetchKey:t}=ga(),[i,r]=x.useRefetchableFragment(xd,a);m.useEffect(()=>{m.startTransition(()=>{r({},{fetchPolicy:"store-and-network"})})},[t,r]);const o=Mn(),c=[Dr(l),o.default,o.gray600,o.gray400,o.gray200],p=(f=i==null?void 0:i.spanAnnotationSummary)==null?void 0:f.meanScore,y=(k=i==null?void 0:i.spanAnnotationSummary)==null?void 0:k.labelFractions,u=typeof p=="number",g=Array.isArray(y)&&y.length>0;return!u&&!g?e(v,{size:"L",children:"--"}):s(fe,{delay:0,placement:"bottom",children:[e(qe,{children:s(h,{direction:"row",alignItems:"center",gap:"size-50",children:[g?e(Sg,{width:24,height:24,children:e(vg,{data:y,dataKey:"fraction",nameKey:"label",cx:"50%",cy:"50%",innerRadius:8,outerRadius:11,strokeWidth:0,stroke:"transparent",children:y.map((b,S)=>e(Cg,{fill:c[S%c.length]},`cell-${S}`))})}):null,e(v,{size:"L",children:u?An(p):"--"})]})}),e(ma,{children:e(C,{width:"size-2400",children:s(h,{direction:"column",gap:"size-50",children:[g&&e("ul",{children:y.map((b,S)=>e("li",{children:e($e,{color:c[S%c.length],name:b.label,shape:"square",value:_r(b.fraction*100)})},b.label))}),g&&u?e(xl,{}):null,u?s(h,{direction:"row",justifyContent:"space-between",children:[e(v,{children:"mean"}),e(v,{children:An(p)})]}):null]})})})]})}const _d=function(){var n={defaultValue:null,kind:"LocalArgument",name:"evaluationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"60d7798d88e1408e6b6b0bebdc1716f5",id:null,metadata:{},name:"DocumentEvaluationSummaryValueQuery",operationKind:"query",text:`query DocumentEvaluationSummaryValueQuery(
  $evaluationName: String!
  $timeRange: TimeRange!
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    __isNode: __typename
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}}();_d.hash="15d0652aa260c80f62acec943f615d93";const Ld={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:_d,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DocumentEvaluationSummaryValueFragment",selections:[{alias:null,args:[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};Ld.hash="15d0652aa260c80f62acec943f615d93";const wd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"3ebd1cf66ef8f31c995ec6aae6505e94",id:null,metadata:{},name:"DocumentEvaluationSummaryQuery",operationKind:"query",text:`query DocumentEvaluationSummaryQuery(
  $evaluationName: String!
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    __isNode: __typename
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}}();wd.hash="4d50474ffa9b9e4a68d07f6e0777c144";function Vk({evaluationName:n}){var i,r;const{projectId:a}=an(),{timeRange:l}=Dl(),t=x.useLazyLoadQuery(wd,{id:a,evaluationName:n,timeRange:{start:(i=l==null?void 0:l.start)==null?void 0:i.toISOString(),end:(r=l==null?void 0:l.end)==null?void 0:r.toISOString()}});return s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:n}),e(m.Suspense,{fallback:e(v,{size:"L",children:"--"}),children:e(Mk,{evaluationName:n,project:t==null?void 0:t.project})})]})}function Mk(n){var p,y,u,g;const{project:a}=n,{fetchKey:l}=ga(),[t,i]=x.useRefetchableFragment(Ld,a);m.useEffect(()=>{m.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[l,i]);const r=(p=t==null?void 0:t.documentEvaluationSummary)==null?void 0:p.averageNdcg,o=(y=t==null?void 0:t.documentEvaluationSummary)==null?void 0:y.averagePrecision,d=(u=t==null?void 0:t.documentEvaluationSummary)==null?void 0:u.hitRate,c=(g=t==null?void 0:t.documentEvaluationSummary)==null?void 0:g.meanReciprocalRank;return s(fe,{delay:0,placement:"bottom",children:[e(qe,{children:e(h,{direction:"row",alignItems:"center",gap:"size-50",height:"28px",children:s(H,{children:[e(Ze,{metric:"ndcg",score:r},"ndcg"),e(Ze,{metric:"precision",score:o},"precision"),e(Ze,{metric:"hit rate",score:d},"hit")]})})}),e(ma,{children:e(C,{width:"size-2400",children:s(h,{direction:"column",children:[s(h,{justifyContent:"space-between",children:[e(v,{children:"average ndcg"}),e(v,{children:typeof r=="number"?An(r):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"average precision"}),e(v,{children:typeof o=="number"?An(o):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"mean reciprocal rank"}),e(v,{children:typeof c=="number"?An(c):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"hit rate"}),e(v,{children:typeof d=="number"?An(d):"--"})]})]})})})]})}function Rk(n){const{extra:a}=n,{fetchKey:l}=ga(),[t,i]=x.useRefetchableFragment(Td,n.project);m.useEffect(()=>{m.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[l,i]);const r=t==null?void 0:t.latencyMsP50,o=t==null?void 0:t.latencyMsP99,d=t==null?void 0:t.tokenCountTotal,c=t==null?void 0:t.tokenCountPrompt,p=t==null?void 0:t.tokenCountCompletion,y=t==null?void 0:t.spanAnnotationNames,u=t==null?void 0:t.documentEvaluationNames;return e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-50",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e("div",{css:T`
            overflow-x: auto;
            overflow-y: hidden;
            flex: 1 1 auto;
            background-image: linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              ),
              linear-gradient(
                to left,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              );
            background-repeat: no-repeat;
            background-size:
              32px 100%,
              32px 100%,
              32px 100%,
              32px 100%;
            background-position:
              left center,
              right center,
              left center,
              right center;
            background-attachment: local, local, scroll, scroll;
          `,children:s(h,{direction:"row",gap:"size-400",alignItems:"center",children:[s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(v,{size:"L",children:oa(t==null?void 0:t.traceCount)})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Tokens"}),s(fe,{delay:0,placement:"bottom",children:[e(qe,{children:e(v,{size:"L",children:oa(d)})}),e(ma,{children:e(C,{width:"size-2400",children:s(h,{direction:"column",children:[s(h,{justifyContent:"space-between",children:[e(v,{children:"Prompt Tokens"}),e(v,{children:typeof c=="number"?Ul(c):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"Completion Tokens"}),e(v,{children:typeof p=="number"?Ul(p):"--"})]}),s(h,{justifyContent:"space-between",children:[e(v,{children:"Total Tokens"}),e(v,{children:typeof d=="number"?Ul(d):"--"})]})]})})})]})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),r!=null?e(Re,{latencyMs:r,size:"L"}):e(v,{size:"L",children:"--"})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P99"}),o!=null?e(Re,{latencyMs:o,size:"L"}):e(v,{size:"L",children:"--"})]}),y.map(g=>e(Pl,{fallback:qp,children:e(wk,{annotationName:g},g)},g)),u.map(g=>e(Vk,{evaluationName:g},`document-${g}`))]})}),e(C,{flex:"none",paddingStart:"size-100",children:a})]})})}const Ed=m.createContext(null);function Vd(){const n=m.useContext(Ed);if(n===null)throw new Error("useSessionSubstring must be used within a SessionSubstringProvider");return n}function Ak(n){const[a,l]=m.useState(""),t=m.useCallback(i=>{m.startTransition(()=>{l(i)})},[]);return e(Ed.Provider,{value:{filterIoSubstring:a,setFilterIoSubstring:t},children:n.children})}const Md=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},l={defaultValue:50,kind:"LocalArgument",name:"first"},t={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},o=[{kind:"Variable",name:"id",variableName:"id"}],d={kind:"Variable",name:"after",variableName:"after"},c={kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},p={kind:"Variable",name:"first",variableName:"first"},y={kind:"Variable",name:"sort",variableName:"sort"},u={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f=[d,c,p,y,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],k=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,l,t,i,r],kind:"Fragment",metadata:null,name:"SessionsTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[d,c,p,y],kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,l,i,r,t],kind:"Operation",name:"SessionsTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[u,{kind:"TypeDiscriminator",abstractKey:"__isNode"},g,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:f,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:k,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:k,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[u],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:f,filters:["sort","filterIoSubstring","timeRange"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"07b07c6e6b2088166d9ae2faf0847ef8",id:null,metadata:{},name:"SessionsTableQuery",operationKind:"query",text:`query SessionsTableQuery(
  $after: String = null
  $filterIoSubstring: String = null
  $first: Int = 50
  $sort: ProjectSessionSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SessionsTable_sessions_2MhLSo
    __isNode: __typename
    id
  }
}

fragment SessionsTable_sessions_2MhLSo on Project {
  name
  sessions(first: $first, after: $after, sort: $sort, filterIoSubstring: $filterIoSubstring, timeRange: $timeRange) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          prompt
          completion
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Md.hash="73d205acbb256ea1f2cf68875634a21b";const Rd=function(){var n=["sessions"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Md,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SessionsTable_sessions",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:"sessions",args:[{kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"__SessionsTable_sessions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Project",abstractKey:null}}();Rd.hash="73d205acbb256ea1f2cf68875634a21b";const Ad=m.createContext(null);function Nk({children:n,...a}){const[l]=m.useState(()=>Up(a));return e(Ad.Provider,{value:l,children:n})}function Ln(n,a){const l=Ie.useContext(Ad);if(!l)throw new Error("Missing TracingContext.Provider in the tree");return Wa(l,n,a)}const zk=T`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,$k=T`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function Ok(n){const{placeholder:a="Search messages"}=n,[l,t]=m.useState(!1),{filterIoSubstring:i,setFilterIoSubstring:r}=Vd(),{theme:o}=En();return e("div",{"data-is-focused":l,className:"sessions-substring-field",css:$k,children:s(h,{direction:"row",children:[e(yt,{children:e(_,{svg:e(Mt,{})})}),e(Yn,{css:zk,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!1,syntaxHighlighting:!1,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>t(!0),onBlur:()=>t(!1),value:i,onChange:r,height:"36px",width:"100%",theme:o==="dark"?Xn:void 0,placeholder:a}),e("button",{css:T`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${i!==""?"visible":"hidden"};
          `,onClick:()=>r(""),className:"button--reset",children:e(_,{svg:e(_l,{})})})]})})}const Qk="pip install openinference-instrumentation",jk=`import uuid

import openai
from openinference.instrumentation import using_session
from openinference.semconv.trace import SpanAttributes
from opentelemetry import trace

client = openai.Client()
session_id = str(uuid.uuid4())

tracer = trace.get_tracer(__name__)

@tracer.start_as_current_span(name="agent", attributes={SpanAttributes.OPENINFERENCE_SPAN_KIND: "agent"})
def assistant(
  messages: list[dict],
  session_id: str = str,
):
  current_span = trace.get_current_span()
  current_span.set_attribute(SpanAttributes.SESSION_ID, session_id)
  current_span.set_attribute(SpanAttributes.INPUT_VALUE, messages[-1].get('content'))

  # Propagate the session_id down to spans crated by the OpenAI instrumentation
  # This is not strictly necessary, but it helps to correlate the spans to the same session
  with using_session(session_id):
   response = client.chat.completions.create(
       model="gpt-3.5-turbo",
       messages=[{"role": "system", "content": "You are a helpful assistant."}] + messages,
   ).choices[0].message

  current_span.set_attribute(SpanAttributes.OUTPUT_VALUE, response.content)
  return response

messages = [
  {"role": "user", "content": "hi! im bob"}
]
response = assistant(
  messages,
  session_id=session_id,
)
messages = messages + [
  response,
  {"role": "user", "content": "what's my name?"}
]
response = assistant(
  messages,
  session_id=session_id,
)`;function qk(){return s("div",{children:[e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(te,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Be,{children:e(mn,{value:Qk})}),e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(te,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(C,{paddingBottom:"size-100",children:e(v,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Be,{children:e(mn,{value:jk})}),e(C,{paddingBottom:"size-100",paddingTop:"size-100",children:s(v,{children:["For more information on how to use sessions, consult the"," ",e(en,{href:"https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}const Uk="npm install @arizeai/openinference-core --save",Bk=`import { trace } from "@opentelemetry/api";
import { SemanticConventions } from "@arizeai/openinference-semantic-conventions";
import { context } from "@opentelemetry/api";
import { setSession } from "@arizeai/openinference-core";

const tracer = trace.getTracer("agent");

const client = new OpenAI({
  apiKey: process.env["OPENAI_API_KEY"], // This is the default and can be omitted
});

async function assistant(params: {
  messages: { role: string; content: string }[];
  sessionId: string;
}) {
  return tracer.startActiveSpan("agent", async (span: Span) => {
    span.setAttribute(SemanticConventions.OPENINFERENCE_SPAN_KIND, "agent");
    span.setAttribute(SemanticConventions.SESSION_ID, params.sessionId);
    span.setAttribute(
      SemanticConventions.INPUT_VALUE,
      messages[messages.length - 1].content,
    );
    try {
      // This is not strictly necessary but it helps propagate the session ID
      // to all child spans
      return context.with(
        setSession(context.active(), { sessionId: params.sessionId }),
        async () => {
          // Calls within this block will generate spans with the session ID set
          const chatCompletion = await client.chat.completions.create({
            messages: params.messages,
            model: "gpt-3.5-turbo",
          });
          const response = chatCompletion.choices[0].message;
          span.setAttribute(SemanticConventions.OUTPUT_VALUE, response.content);
          span.end();
          return response;
        },
      );
    } catch (e) {
      span.error(e);
    }
  });
}

const sessionId = crypto.randomUUID();

let messages = [{ role: "user", content: "hi! im Tim" }];

const res = await assistant({
  messages,
  sessionId: sessionId,
});

messages = [res, { role: "assistant", content: "What is my name?" }];

await assistant({
  messages,
  sessionId: sessionId,
});
`;function Hk(){return s("div",{children:[e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(te,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Be,{children:e(mn,{value:Uk})}),e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(te,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(C,{paddingBottom:"size-100",children:e(v,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Be,{children:e(Bp,{value:Bk})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["For more information on how to use sessions, consult the"," ",e(en,{href:"https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}function Gk(){const[n,a]=m.useState("Python");return e(X,{title:"Setup Sessions for this Project",size:"L",children:s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-100",children:e(vl,{language:n,onChange:a})}),n==="Python"?e(qk,{}):e(Hk,{})]})})}function Wk(){const[n,a]=m.useState(null),l=()=>{a(e(Gk,{}))};return s("tbody",{className:"is-empty",children:[e("tr",{children:e("td",{colSpan:100,css:T`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:s(h,{direction:"column",gap:"size-200",alignItems:"center",children:["No sessions found for this project",e(M,{leadingVisual:e(_,{svg:e(pa,{})}),onPress:l,children:"Setup Sessions"})]})})}),e(Y,{onDismiss:()=>a(null),isDismissable:!0,type:"slideOver",children:n})]})}const ei=T`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  overflow: hidden;
  .span-filter-condition-field {
    flex: 1 1 auto;
  }

  // Style the column selector
  .ac-dropdown-button {
    min-width: var(--ac-global-dimension-static-size-300);
  }
`,Vi=50;function Jk(n){const a=m.useRef(null),[l,t]=m.useState([]),{filterIoSubstring:i}=Vd(),r=se(),{fetchKey:o}=ga(),{data:d,loadNext:c,hasNext:p,isLoadingNext:y,refetch:u}=x.usePaginationFragment(Rd,n.project),g=m.useMemo(()=>d.sessions.edges.map(({session:K})=>({...K,tokenCountTotal:K.tokenUsage.total})),[d.sessions]),f=[{header:"session id",accessorKey:"sessionId",enableSorting:!1,cell:Ke},{header:"first input",accessorKey:"firstInput.value",enableSorting:!1,cell:Ke},{header:"last output",accessorKey:"lastOutput.value",enableSorting:!1,cell:Ke},{header:"start time",accessorKey:"startTime",enableSorting:!0,cell:Me},{header:"end time",accessorKey:"endTime",enableSorting:!0,cell:Me},{header:"p50 latency",accessorKey:"traceLatencyMsP50",enableSorting:!1,cell:({getValue:K})=>{const I=K();return I===null||typeof I!="number"?null:e(Re,{latencyMs:I})}},{header:"p99 latency",accessorKey:"traceLatencyMsP99",enableSorting:!1,cell:({getValue:K})=>{const I=K();return I===null||typeof I!="number"?null:e(Re,{latencyMs:I})}},{header:"total tokens",accessorKey:"tokenCountTotal",enableSorting:!0,minSize:80,cell:({row:K,getValue:I})=>{const E=I();if(E==null||typeof E!="number")return"--";const{prompt:V,completion:Q}=K.original.tokenUsage;return e(Jn,{tokenCountTotal:E,tokenCountPrompt:V||0,tokenCountCompletion:Q||0})}},{header:"total traces",accessorKey:"numTraces",enableSorting:!0,cell:Lr}];m.useEffect(()=>{const K=l[0];m.startTransition(()=>{u({sort:K?{col:K.id,dir:K.desc?"desc":"asc"}:{col:"startTime",dir:"desc"},after:null,first:Vi,filterIoSubstring:i},{fetchPolicy:"store-and-network"})})},[l,u,i,o]);const k=Ie.useCallback(K=>{if(K){const{scrollHeight:I,scrollTop:E,clientHeight:V}=K;I-E-V<300&&!y&&p&&c(Vi)}},[p,y,c]),[b,S]=m.useState({}),F=Ln(K=>K.columnVisibility),P=xe({columns:f,data:g,onExpandedChange:S,manualSorting:!0,state:{sorting:l,expanded:b,columnVisibility:F},enableSubRowSelection:!1,onSortingChange:t,getCoreRowModel:De(),getSortedRowModel:kn(),getExpandedRowModel:Wi(),getRowId:K=>K.id}),D=P.getRowModel().rows,w=D.length===0;return s("div",{css:ei,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:e(Ok,{})}),e("div",{css:T`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:K=>k(K.target),ref:a,children:s("table",{css:Gn,children:[e("thead",{children:P.getHeaderGroups().map(K=>e("tr",{children:K.headers.map(I=>e("th",{colSpan:I.colSpan,children:I.isPlaceholder?null:s("div",{"data-sortable":I.column.getCanSort(),className:I.column.getCanSort()?"cursor-pointer":"",onClick:I.column.getToggleSortingHandler(),style:{left:I.getStart(),width:I.getSize()},children:[Z(I.column.columnDef.header,I.getContext()),I.column.getIsSorted()?e(_,{className:"sort-icon",svg:I.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]})},I.id))},K.id))}),w?e(Wk,{}):e("tbody",{children:D.map(K=>e("tr",{onClick:()=>r(`sessions/${encodeURIComponent(K.id)}`),children:K.getVisibleCells().map(I=>e("td",{children:Z(I.column.columnDef.cell,I.getContext())},I.id))},K.id))})]})})]})}const Nd=m.createContext(null);function zd(){const n=m.useContext(Nd);if(n===null)throw new Error("useSpanFilterCondition must be used within a SpanFilterConditionProvider");return n}function Mi(n){const[a,l]=m.useState(""),t=m.useCallback(r=>{m.startTransition(()=>{l(r)})},[]),i=m.useCallback(r=>{m.startTransition(()=>{a.length>0?l(a+" and "+r):l(r)})},[a]);return e(Nd.Provider,{value:{filterCondition:a,setFilterCondition:t,appendFilterCondition:i},children:n.children})}const $d=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},l={defaultValue:50,kind:"LocalArgument",name:"first"},t={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},o=[{kind:"Variable",name:"id",variableName:"id"}],d={kind:"Variable",name:"after",variableName:"after"},c={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},p={kind:"Variable",name:"first",variableName:"first"},y={kind:"Variable",name:"sort",variableName:"sort"},u={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},k=[d,c,p,y,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],b=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,l,t,i,r],kind:"Fragment",metadata:null,name:"SpansTableSpansQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[d,c,p,y],kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,l,i,r,t],kind:"Operation",name:"SpansTableSpansQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[u,{kind:"TypeDiscriminator",abstractKey:"__isNode"},g,{kind:"InlineFragment",selections:[f,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:k,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[g,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},f,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:b,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:b,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[u],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:k,filters:["sort","filterCondition","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"21dc6f490cf749c02bc20bcdb43c199c",id:null,metadata:{},name:"SpansTableSpansQuery",operationKind:"query",text:`query SpansTableSpansQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 50
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SpansTable_spans_1XEuU
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans_1XEuU on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: $first, after: $after, sort: $sort, filterCondition: $filterCondition, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        tokenCountTotal
        tokenCountPrompt
        tokenCountCompletion
        context {
          spanId
          traceId
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();$d.hash="4827989f55b1c0bd269253b6bc977439";const Od=function(){var n=["spans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:$d,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SpansTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"spans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__SpansTable_spans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},l],type:"Project",abstractKey:null}}();Od.hash="4827989f55b1c0bd269253b6bc977439";function Qd(n){const{appendFilterCondition:a}=zd(),{annotation:l}=n,{name:t,label:i,score:r}=l,o=m.useMemo(()=>{const d=[];return i!=null&&(d.push({filterName:"Match label",filterCondition:`annotations['${t}'].label == "${i}"`}),d.push({filterName:"Exclude label",filterCondition:`annotations['${t}'].label != "${i}"`})),typeof r=="number"&&(d.push({filterName:"Greater than score",filterCondition:`annotations['${t}'].score > ${r}`}),d.push({filterName:"Less than score",filterCondition:`annotations['${t}'].score < ${r}`}),d.push({filterName:"Equals score",filterCondition:`annotations['${t}'].score == ${r}`})),d},[t,i,r]);return s(C,{borderStartWidth:"thin",borderColor:"dark",paddingStart:"size-200",paddingEnd:"size-100",marginStart:"size-200",width:300,children:[e(v,{weight:"heavy",children:"Filters"}),e("ul",{css:T`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-size-100);
          color: var(--ac-global-color-primary);
          padding: var(--ac-global-dimension-size-100) 0;
          flex-wrap: wrap;
        `,children:o.map(d=>e("li",{children:e(Zk,{onClick:()=>{a(d.filterCondition)},children:d.filterName})},d.filterName))})]})}function Zk({onClick:n,children:a}){return e("button",{onClick:l=>{l.preventDefault(),l.stopPropagation(),n()},className:"button--reset",css:T`
        color: var(--ac-global-text-color-900);
        border: 1px solid var(--ac-global-color-grey-300);
        border-radius: 4px;
        padding: var(--ac-global-dimension-size-50)
          var(--ac-global-dimension-size-100);
        cursor: pointer;
        transition: background-color 0.2s;
        &:hover {
          background-color: var(--ac-global-color-gray-300);
        }
      `,children:a})}function Xk({projectName:n}){const[a,l]=m.useState("Python");return e(X,{title:"Send Traces to this Project",size:"L",children:s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-100",children:e(vl,{language:a,onChange:l})}),a==="Python"?e(wr,{projectName:n}):e(Er,{projectName:n})]})})}function jd({projectName:n}){const[a,l]=m.useState(null),t=()=>{l(e(Xk,{projectName:n}))};return s("tbody",{className:"is-empty",children:[e("tr",{children:e("td",{colSpan:100,css:T`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:s(h,{direction:"column",gap:"size-200",alignItems:"center",children:["No traces found that match the selected filters",e(M,{variant:"default",leadingVisual:e(_,{svg:e(pa,{})}),onPress:t,children:"Get Started"})]})})}),e(Y,{onDismiss:()=>l(null),isDismissable:!0,type:"slideOver",children:a})]})}const qd={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanColumnSelector_annotations",selections:[{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null}],type:"Project",abstractKey:null};qd.hash="ad01e6897ad1ea779eb346d85783b8b4";const Yk=["spanKind","name"];function Ud(n){return e(ft,{menu:e(eb,{...n}),triggerProps:{placement:"bottom end"},children:s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(_,{svg:e(Hp,{})}),"Columns"]})})}const cl=T`
  padding: var(--ac-global-dimension-static-size-50)
    var(--ac-global-dimension-static-size-100);
  label {
    display: flex;
    align-items: center;
    gap: var(--ac-global-dimension-static-size-100);
  }
`;function eb(n){const{columns:a}=n,l=Ln(c=>c.columnVisibility),t=Ln(c=>c.setColumnVisibility),i=m.useMemo(()=>a.filter(c=>!Yk.includes(c.id)),[a]),r=m.useMemo(()=>i.every(c=>{const p=l[c.id];return p??!0}),[i,l]),o=m.useCallback(c=>{const{name:p,checked:y}=c.target;t({...l,[p]:y})},[l,t]),d=m.useCallback(c=>{const{checked:p}=c.target,y=i.reduce((u,g)=>({...u,[g.id]:p}),{});t(y)},[i,t]);return e("div",{css:T`
        overflow-y: auto;
        max-height: calc(100vh - 200px);
      `,children:s(C,{paddingTop:"size-50",paddingBottom:"size-50",children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",paddingBottom:"size-50",children:e("div",{css:cl,children:s("label",{children:[e("input",{type:"checkbox",name:"toggle-all",checked:r,onChange:d}),"span columns"]})})}),e("ul",{children:i.map(c=>{const p=l[c.id],y=p??!0,u=typeof c.columnDef.header=="string"?c.columnDef.header:c.id;return e("li",{css:cl,children:s("label",{children:[e("input",{type:"checkbox",name:c.id,checked:y,onChange:o}),u]})},c.id)})}),e(nb,{...n})]})})}function nb({query:n}){const a=x.useFragment(qd,n),l=Ln(o=>o.annotationColumnVisibility),t=Ln(o=>o.setAnnotationColumnVisibility),i=m.useMemo(()=>a.spanAnnotationNames.every(o=>l[o]||!1),[a.spanAnnotationNames,l]),r=m.useCallback(()=>{const o=a.spanAnnotationNames.reduce((d,c)=>({...d,[c]:!i}),{});t(o)},[a.spanAnnotationNames,t,i]);return s("section",{children:[e(C,{paddingTop:"size-50",paddingBottom:"size-50",borderColor:"dark",borderTopWidth:"thin",borderBottomWidth:"thin",children:e("div",{css:cl,children:s("label",{children:[e("input",{type:"checkbox",name:"toggle-evaluations-all",checked:i,onChange:r}),"feedback"]})})}),e("ul",{children:a.spanAnnotationNames.map(o=>{const d=l[o]??!1;return e("li",{css:cl,children:s("label",{children:[e("input",{type:"checkbox",name:o,checked:d,onChange:()=>{t({...l,[o]:!d})}}),o]})},o)})})]})}const Bd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"condition"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"condition",variableName:"condition"}],concreteType:"ValidationResult",kind:"LinkedField",name:"validateSpanFilterCondition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isValid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"29583e7ec666cef832dc7effb9e75678",id:null,metadata:{},name:"SpanFilterConditionFieldValidationQuery",operationKind:"query",text:`query SpanFilterConditionFieldValidationQuery(
  $condition: String!
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      validateSpanFilterCondition(condition: $condition) {
        isValid
        errorMessage
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Bd.hash="22836f192038b0c40201d3b25aad65b4";const Hd=T`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,Gd=T`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function ab(n){const a=n.matchBefore(/\w*/);return!a||a.from==a.to&&!n.explicit?null:{from:a.from,options:[{label:"span_kind",type:"variable",info:"The span variant: CHAIN, LLM, RETRIEVER, TOOL, etc."},{label:"status_code",type:"variable",info:"The span status: OK, UNSET, or ERROR"},{label:"input.value",type:"variable",info:"The input value of a span, typically a query"},{label:"output.value",type:"variable",info:"The output value of a span, typically a response"},{label:"name",type:"variable",info:"The name given to a span - e.x. OpenAI"},{label:"latency_ms",type:"variable",info:"Latency (i.e. duration) in milliseconds"},{label:"cumulative_token_count.prompt",type:"variable",info:"Sum of token count for prompt from self and all child spans"},{label:"cumulative_token_count.completion",type:"variable",info:"Sum of token count for completion from self and all child spans"},{label:"cumulative_token_count.total",type:"variable",info:"Sum of token count total (prompt + completion) from self and all child spans"},{label:"llm spans",type:"text",apply:"span_kind == 'LLM'",detail:"macro"},{label:"retriever spans",type:"text",apply:"span_kind == 'RETRIEVER'",detail:"macro"},{label:"search input",type:"text",apply:"'' in input.value",detail:"macro"},{label:"search output",type:"text",apply:"'' in output.value",detail:"macro"},{label:"status_code error",type:"text",apply:"status_code == 'ERROR'",detail:"macro"},{label:"Latency >= 10s",type:"text",apply:"latency_ms >= 10_000",detail:"macro"},{label:"Tokens >= 1,000",type:"text",apply:"llm.token_count.total >= 1_000",detail:"macro"},{label:"Hallucinations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Annotations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Metadata",type:"text",apply:"metadata['topic'] == 'agent'",detail:"macro"},{label:"Substring",type:"text",apply:"'agent' in input.value",detail:"macro"}]}}async function lb(n,a){if(!n)return{isValid:!0,errorMessage:null};const l=await Ja.fetchQuery(be,Bd,{condition:n,id:a}).toPromise();if(!l)throw new Error("Filter condition validation is null");return l.project.validateSpanFilterCondition}const tb=[At.of([{key:"Enter",run:n=>!0}]),Ya(),qr({override:[ab]})];function Wd(n){const{onValidCondition:a,placeholder:l="filter condition (e.x. span_kind == 'LLM')"}=n,[t,i]=m.useState(!1),[r,o]=m.useState(""),{filterCondition:d,setFilterCondition:c,appendFilterCondition:p}=zd(),y=m.useDeferredValue(d),{theme:u}=En(),g=u==="dark"?Xn:void 0,{projectId:f}=an();m.useEffect(()=>{lb(y,f).then(S=>{S!=null&&S.isValid?(o(""),m.startTransition(()=>{a(y)})):o((S==null?void 0:S.errorMessage)??"Invalid filter condition")})},[a,y,f]);const k=r!=="";return s("div",{"data-is-focused":t,"data-is-invalid":k,className:"span-filter-condition-field",css:Gd,children:[s(h,{direction:"row",children:[e(yt,{children:e(_,{svg:e(Mt,{})})}),e(Yn,{css:Hd,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>i(!0),onBlur:()=>i(!1),value:d,onChange:c,height:"36px",width:"100%",theme:g,placeholder:l,extensions:tb}),e("button",{css:T`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${d!==""?"visible":"hidden"};
          `,onClick:()=>c(""),className:"button--reset",children:e(_,{svg:e(_l,{})})}),s(ua,{placement:"bottom right",children:[e(qe,{children:e("button",{css:T`
                color: var(--ac-global-text-color-700);
                background-color: var(--ac-global-color-grey-400);
                padding-left: var(--ac-global-dimension-static-size-100);
                padding-right: var(--ac-global-dimension-static-size-100);
                height: 100%;
              `,className:"button--reset",children:e(_,{svg:e(bn,{})})})}),e(ib,{onAddFilterConditionSnippet:p})]})]}),s(fe,{isOpen:k&&t,placement:"bottom",children:[e(qe,{children:e("div",{})}),e(ma,{children:r!=""?e(v,{color:"danger",children:r}):e(v,{color:"success",children:"Valid Expression"})})]})]})}function ib(n){const{onAddFilterConditionSnippet:a}=n;return e(C,{width:"500px",padding:"size-200",borderRadius:"medium",borderWidth:"thin",borderColor:"light",backgroundColor:"light",children:s(h,{direction:"column",gap:"size-100",children:[e(ta,{label:"filter by kind",initialSnippet:"span_kind == 'LLM'",onAddFilterConditionSnippet:a},"kind"),e(ta,{label:"filter by token count",initialSnippet:"cumulative_token_count.total > 1000",onAddFilterConditionSnippet:a},"token_count"),e(ta,{label:"filter by annotation label",initialSnippet:"annotations['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"annotation_label"),e(ta,{label:"filter by evaluation label",initialSnippet:"evals['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"eval_label"),e(ta,{label:"filter by evaluation score",initialSnippet:"evals['Hallucination'].score < 1",onAddFilterConditionSnippet:a},"eval_score"),e(ta,{label:"filter by metadata",initialSnippet:"metadata['topic'] == 'agent'",onAddFilterConditionSnippet:a},"metadata"),e(ta,{label:"filter by substring",initialSnippet:"'agent' in input.value",onAddFilterConditionSnippet:a},"substring")]})})}function ta(n){const{initialSnippet:a,onAddFilterConditionSnippet:l}=n,[t,i]=m.useState(a),{theme:r}=En(),o=r==="light"?void 0:Xn;return e(Bn,{label:n.label,children:s(h,{direction:"row",width:"100%",gap:"size-100",children:[e("div",{css:T(Gd,T`
              flex: 1 1 auto;
            `),children:e(Yn,{value:t,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[Ya()],editable:!0,onChange:i,theme:o,css:Hd})}),e(M,{"aria-label":"Add to filter condition",variant:"default",onPress:()=>l(t),leadingVisual:e(_,{svg:e(bn,{})})})]})})}const Jd=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addSpansToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a},params:{cacheID:"1c694540190478b8fba8ef3c0cacf30c",id:null,metadata:{},name:"SpanSelectionToolbarAddSpansToDatasetMutation",operationKind:"mutation",text:`mutation SpanSelectionToolbarAddSpansToDatasetMutation(
  $input: AddSpansToDatasetInput!
) {
  addSpansToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();Jd.hash="5e3aef907285081a06c0e0360045e865";const Zd={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"6d459b61a36b99979f025742892941f9",id:null,metadata:{},name:"DatasetSelectorPopoverContentDatasetsQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentDatasetsQuery {
  ...DatasetSelectorPopoverContent_datasets
}

fragment DatasetSelectorPopoverContent_datasets on Query {
  datasets {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}};Zd.hash="40d5267ad0ec2335a73ff2a4d05bbed1";const Xd={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:Zd}},name:"DatasetSelectorPopoverContent_datasets",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Xd.hash="40d5267ad0ec2335a73ff2a4d05bbed1";const Yd={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetSelectorPopoverContentQuery",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"5fb28a402f330dd235295da21efea58b",id:null,metadata:{},name:"DatasetSelectorPopoverContentQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentQuery {
  ...DatasetSelectorPopoverContent_datasets
}

fragment DatasetSelectorPopoverContent_datasets on Query {
  datasets {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}};Yd.hash="7cd8a13144d97d2b5294f2a09c9e1351";function rb(n){const{onCreateNewDataset:a,onDatasetSelected:l}=n,[t,i]=m.useState(""),r=x.useLazyLoadQuery(Yd,{},{fetchPolicy:"network-only"});return s(O,{title:"Add to Dataset",variant:"compact",backgroundColor:"light",borderColor:"light",bodyStyle:{padding:0},extra:e(M,{variant:"default",size:"S",onPress:a,children:"New Dataset"}),children:[e(C,{padding:"size-100",children:e(Gp,{onChange:o=>{i(o)},children:e(ae,{placeholder:"Search datasets"})})}),e(C,{borderTopWidth:"thin",borderColor:"light",children:e("div",{css:T`
            height: 400px;
            overflow-y: auto;
            min-width: 300px;
          `,children:e(sb,{query:r,search:t,onDatasetSelected:l})})})]})}function sb(n){const{search:a,onDatasetSelected:l}=n,[t]=x.useRefetchableFragment(Xd,n.query),i=m.useMemo(()=>{let o=t.datasets.edges.map(d=>d.dataset);return a&&(o=o.filter(d=>d.name.toLowerCase().includes(a.toLowerCase()))),o},[a,t]);return i.length===0?e(C,{padding:"size-200",children:e(h,{direction:"column",justifyContent:"center",alignItems:"center",flex:"1 1 auto",children:e(v,{children:"No datasets found"})})}):e(hl,{selectionMode:"single",onSelectionChange:o=>{if(typeof o=="object"){const d=Array.from(o);l(d[0])}},children:i.map(o=>e(de,{children:o.name},o.id))})}function ec(n){const a=se(),[l,t]=m.useState(null),i=Se(),r=Te(),[o,d]=m.useState(!1),{selectedSpans:c,onClearSelection:p}=n,[y,u]=x.useMutation(Jd),g=c.length!==1,f=m.useCallback(k=>{y({variables:{input:{datasetId:k,spanIds:c.map(b=>b.id)}},onCompleted:()=>{i({title:"Examples added to dataset",message:`${c.length} example${g?"s":""} have been added to the dataset.`,action:{text:"View dataset",onClick:()=>{a(`/datasets/${k}/examples`)}}}),p()},onError:b=>{const S=Pe(b);r({title:"An error occurred",message:`Failed to add spans to dataset: ${(S==null?void 0:S[0])??b.message}`})}})},[y,c,i,g,p,a,r]);return s("div",{css:T`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(um,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:s(ii,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(om,{children:`${c.length} span${g?"s":""} selected`}),s(ii,{direction:"row",gap:"size-100",children:[e(M,{variant:"default",size:"S",onPress:p,children:"Cancel"}),s(ua,{placement:"top end",crossOffset:300,isOpen:o,onOpenChange:k=>{d(k)},children:[e(dm,{variant:"primary",size:"compact",icon:e(cm,{svg:u?e(ri.LoadingOutline,{}):e(ri.DatabaseOutline,{})}),isDisabled:u,children:u?"Adding to dataset":"Add to dataset"}),e(m.Suspense,{children:e(rb,{onDatasetSelected:k=>{f(k),d(!1)},onCreateNewDataset:()=>{d(!1),t(e(X,{title:"New Dataset",isDismissable:!0,onDismiss:()=>t(null),children:e(Vr,{onDatasetCreateError:k=>{const b=Pe(k);r({title:"Dataset creation failed",message:`Failed to create dataset: ${(b==null?void 0:b[0])??k.message}`})},onDatasetCreated:k=>{t(null),i({title:"Dataset created",message:`${k.name} has been successfully created.`}),d(!0)}})}))}})})]})]})]})}),e(Y,{onDismiss:()=>{t(null)},children:l})]})}const Ga="annotations",Cn=":",nc={col:"startTime",dir:"desc"};function ac(n){let a=null,l=null;if(n.id&&n.id.startsWith(Ga)){const[,t,i]=n.id.split(Cn);l={attr:t,name:i}}else a=n.id;return{col:a,evalResultKey:l,dir:n.desc?"desc":"asc"}}const Ri=50;function ob(n){const{fetchKey:a}=ga(),l=!!Ji("/projects/:projectId"),t=m.useRef(null),[i,r]=m.useState({}),[o,d]=m.useState([]),[c,p]=m.useState(""),y=Ln(N=>N.columnVisibility),u=se(),{data:g,loadNext:f,hasNext:k,isLoadingNext:b,refetch:S}=x.usePaginationFragment(Od,n.project),F=Ln(N=>N.annotationColumnVisibility),P=m.useMemo(()=>Object.keys(F).filter(N=>F[N]),[F]),D=m.useMemo(()=>g.spans.edges.map(({span:j})=>j),[g]),w=P.map(N=>({header:N,columns:[{header:"label",accessorKey:`${Ga}${Cn}label${Cn}${N}`,cell:({row:j})=>{const A=j.original.spanAnnotations.find(U=>U.name===N);return A?A.label:null}},{header:"score",accessorKey:`${Ga}${Cn}score${Cn}${N}`,cell:({row:j})=>{const A=j.original.spanAnnotations.find(U=>U.name===N);return A?A.score:null}}]})),K=[{header:()=>s(h,{direction:"row",gap:"size-50",children:[e("span",{children:"feedback"}),s(Ia,{children:[e(te,{level:3,weight:"heavy",children:"Feedback"}),e(Un,{children:"Feedback includes evaluations and human annotations logged via the API or set via the UI."})]})]}),accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:N})=>s(h,{direction:"row",gap:"size-50",wrap:"wrap",children:[N.original.spanAnnotations.map(j=>e(Da,{annotation:j,layout:"horizontal",width:"500px",extra:e(Qd,{annotation:j}),children:e(wn,{annotation:j,annotationDisplayPreference:"label"})},j.name)),N.original.documentRetrievalMetrics.map(j=>s(H,{children:[e(Ze,{name:j.evaluationName,metric:"ndcg",score:j.ndcg},"ndcg"),e(Ze,{name:j.evaluationName,metric:"precision",score:j.precision},"precision"),e(Ze,{name:j.evaluationName,metric:"hit",score:j.hit},"hit")]}))]})},...w],I=[{id:"select",maxSize:10,header:({table:N})=>e(Qn,{checked:N.getIsAllRowsSelected(),indeterminate:N.getIsSomeRowsSelected(),onChange:N.getToggleAllRowsSelectedHandler()}),cell:({row:N})=>e(Qn,{checked:N.getIsSelected(),disabled:!N.getCanSelect(),indeterminate:N.getIsSomeSelected(),onChange:N.getToggleSelectedHandler()})},{header:"kind",accessorKey:"spanKind",maxSize:100,enableSorting:!1,cell:({getValue:N})=>e(Kt,{spanKind:N()})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:N,row:j})=>{const A=j.original,{traceId:U}=A.context;return e(Qe,{to:`traces/${U}?selectedSpanNodeId=${A.id}`,children:N()})}},{header:"input",accessorKey:"input.value",cell:Ke,enableSorting:!1},{header:"output",accessorKey:"output.value",cell:Ke,enableSorting:!1},{header:"metadata",accessorKey:"metadata",cell:Ke,enableSorting:!1},...K,{header:"start time",accessorKey:"startTime",cell:Me},{header:"latency",accessorKey:"latencyMs",cell:({getValue:N})=>{const j=N();return j===null||typeof j!="number"?null:e(Re,{latencyMs:j})}},{header:"total tokens",accessorKey:"tokenCountTotal",cell:({row:N,getValue:j})=>{const A=j();return A===null?"--":e(Jn,{tokenCountTotal:A,tokenCountPrompt:N.original.tokenCountPrompt||0,tokenCountCompletion:N.original.tokenCountCompletion||0})}},{header:"status",accessorKey:"statusCode",enableSorting:!1,cell:({getValue:N})=>e(Tl,{statusCode:N()})}];m.useEffect(()=>{const N=o[0];m.startTransition(()=>{l&&S({sort:N?ac(N):nc,after:null,first:Ri,filterCondition:c},{fetchPolicy:"store-and-network"})})},[o,S,c,a,l]);const E=m.useCallback(N=>{if(N){const{scrollHeight:j,scrollTop:A,clientHeight:U}=N;j-A-U<300&&!b&&k&&f(Ri)}},[k,b,f]),V=xe({columns:I,data:D,state:{sorting:o,columnVisibility:y,rowSelection:i},manualSorting:!0,enableRowSelection:!0,onRowSelectionChange:r,onSortingChange:d,getCoreRowModel:De(),getSortedRowModel:kn()}),Q=V.getRowModel().rows,R=V.getSelectedRowModel().rows,q=R.map(N=>N.original),ee=m.useCallback(()=>{r({})},[r]),ge=Q.length===0,he=V.getAllColumns().filter(N=>N.columns.length===0);return s("div",{css:ei,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:s(h,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(Wd,{onValidCondition:p}),e(Ud,{columns:he,query:g})]})}),e("div",{css:T`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:N=>E(N.target),ref:t,children:s("table",{css:Gn,children:[e("thead",{children:V.getHeaderGroups().map(N=>e("tr",{children:N.headers.map(j=>e("th",{colSpan:j.colSpan,children:j.isPlaceholder?null:s("div",{className:j.column.getCanSort()?"cursor-pointer":"",onClick:j.column.getToggleSortingHandler(),style:{left:j.getStart(),width:j.getSize()},children:[Z(j.column.columnDef.header,j.getContext()),j.column.getIsSorted()?e(_,{className:"sort-icon",svg:j.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]})},j.id))},N.id))}),ge?e(jd,{projectName:g.name}):e("tbody",{children:Q.map(N=>e("tr",{onClick:()=>u(`traces/${N.original.context.traceId}?selectedSpanNodeId=${N.original.id}`),children:N.getVisibleCells().map(j=>e("td",{children:Z(j.column.columnDef.cell,j.getContext())},j.id))},N.id))})]})}),R.length?e(ec,{selectedSpans:q,onClearSelection:ee}):null]})}const lc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"4e136f41c0942f253822336dc0c5b291",id:null,metadata:{},name:"StreamToggleRefetchQuery",operationKind:"query",text:`query StreamToggleRefetchQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...StreamToggle_data
    __isNode: __typename
    id
  }
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}
`}}}();lc.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";const tc={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:lc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"StreamToggle_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};tc.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";function ic(n,a){const l=m.useRef(null);m.useEffect(()=>{l.current=n},[n]),m.useEffect(()=>{function t(){l.current&&l.current()}if(typeof a=="number"){const i=setInterval(t,a);return()=>clearInterval(i)}},[a])}const db=2e3;function cb(n){const{isStreaming:a,setIsStreaming:l,setFetchKey:t}=ga(),[i,r]=x.useRefetchableFragment(tc,n.project),o=m.useRef(i.streamingLastUpdatedAt),d=m.useCallback(()=>{a&&m.startTransition(()=>{r({},{fetchPolicy:"store-and-network"})})},[a,r]),c=i.streamingLastUpdatedAt;return m.useEffect(()=>{c!=null&&(o.current==null||o.current<c)&&(o.current=c,t(`fetch-traces-${c}`))},[t,c]),ic(d,db),e(xa,{labelPlacement:"start",isSelected:a,onChange:()=>{l(!a)},children:"Stream"})}const rc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},l={defaultValue:50,kind:"LocalArgument",name:"first"},t={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},o=[{kind:"Variable",name:"id",variableName:"id"}],d={kind:"Variable",name:"after",variableName:"after"},c={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},p={kind:"Variable",name:"first",variableName:"first"},y={kind:"Variable",name:"sort",variableName:"sort"},u={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},k=[d,c,p,{kind:"Literal",name:"rootSpansOnly",value:!0},y,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],b={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},S={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},w=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],K={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:w,storageKey:null},I={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:w,storageKey:null},E={alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},V={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[g,f,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},Q={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r],kind:"Fragment",metadata:null,name:"TracesTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[d,c,p,y],kind:"FragmentSpread",name:"TracesTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,l,i,r,t],kind:"Operation",name:"TracesTableQuery",selections:[{alias:null,args:o,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[u,{kind:"TypeDiscriminator",abstractKey:"__isNode"},g,{kind:"InlineFragment",selections:[f,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:k,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[g,b,f,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},S,F,P,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},D,K,I,E,V,Q,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"descendants",plural:!0,selections:[g,b,f,S,F,P,D,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},K,I,E,V,Q],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[u],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:k,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"02a7f881e2b629106c3ca5af769d1175",id:null,metadata:{},name:"TracesTableQuery",operationKind:"query",text:`query TracesTableQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 50
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...TracesTable_spans_1XEuU
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment TracesTable_spans_1XEuU on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: $first, after: $after, sort: $sort, rootSpansOnly: true, filterCondition: $filterCondition, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode: propagatedStatusCode
        startTime
        latencyMs
        cumulativeTokenCountTotal
        cumulativeTokenCountPrompt
        cumulativeTokenCountCompletion
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        context {
          spanId
          traceId
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants {
          id
          spanKind
          name
          statusCode: propagatedStatusCode
          startTime
          latencyMs
          parentId
          cumulativeTokenCountTotal: tokenCountTotal
          cumulativeTokenCountPrompt: tokenCountPrompt
          cumulativeTokenCountCompletion: tokenCountCompletion
          input {
            value: truncatedValue
          }
          output {
            value: truncatedValue
          }
          context {
            spanId
            traceId
          }
          spanAnnotations {
            id
            name
            label
            score
            annotatorKind
          }
          documentRetrievalMetrics {
            evaluationName
            ndcg
            precision
            hit
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();rc.hash="7a8017aa7d5eebddd6255365f3372f64";const sc=function(){var n=["rootSpans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},i={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},c=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],p={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:c,storageKey:null},y={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:c,storageKey:null},u={alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},g={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,a,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},f={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:rc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"TracesTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"rootSpans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__TracesTable_rootSpans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},i,r,o,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},d,p,y,u,g,f,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"descendants",plural:!0,selections:[l,t,a,i,r,o,d,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},p,y,u,g,f],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},l],type:"Project",abstractKey:null}}();sc.hash="7a8017aa7d5eebddd6255365f3372f64";const Ai=50;function oc(n){const a=[];for(const l of n){const t={...l.span,children:oc(l.children)};a.push(t)}return a}function ub(n){const a=m.useRef(null),[l,t]=m.useState({}),[i,r]=m.useState([]),[o,d]=m.useState(""),c=se(),p=!!Ji("/projects/:projectId"),{fetchKey:y}=ga(),{data:u,loadNext:g,hasNext:f,isLoadingNext:k,refetch:b}=x.usePaginationFragment(sc,n.project),S=Ln(A=>A.annotationColumnVisibility),F=m.useMemo(()=>Object.keys(S).filter(A=>S[A]),[S]),P=m.useMemo(()=>u.rootSpans.edges.map(({rootSpan:U})=>{const oe=Wp([U,...U.descendants]),[$]=oc(oe);return $}),[u]),D=F.map(A=>({header:A,columns:[{header:"label",accessorKey:`${Ga}${Cn}label${Cn}${A}`,cell:({row:U})=>{const oe=U.original.spanAnnotations.find($=>$.name===A);return oe?oe.label:null}},{header:"score",accessorKey:`${Ga}${Cn}score${Cn}${A}`,cell:({row:U})=>{const oe=U.original.spanAnnotations.find($=>$.name===A);return oe?oe.score:null}}]})),w=[{header:()=>s(h,{direction:"row",gap:"size-50",children:[e("span",{children:"feedback"}),s(Ia,{children:[e(te,{level:3,weight:"heavy",children:"Feedback"}),e(Un,{children:"Feedback includes evaluations and human annotations logged via the API or set via the UI."})]})]}),accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:A})=>{const U=A.original.spanAnnotations.length===0&&A.original.documentRetrievalMetrics.length===0;return s(h,{direction:"row",gap:"size-50",wrap:"wrap",children:[A.original.spanAnnotations.map(oe=>e(Da,{annotation:oe,layout:"horizontal",width:"500px",extra:e(Qd,{annotation:oe}),children:e(wn,{annotation:oe,annotationDisplayPreference:"label"})},oe.name)),A.original.documentRetrievalMetrics.map(oe=>s(m.Fragment,{children:[e(Ze,{name:oe.evaluationName,metric:"ndcg",score:oe.ndcg},"ndcg"),e(Ze,{name:oe.evaluationName,metric:"precision",score:oe.precision},"precision"),e(Ze,{name:oe.evaluationName,metric:"hit",score:oe.hit},"hit")]},"doc-evals")),U?"--":null]})}},...D],K=[{id:"select",maxSize:10,header:({table:A})=>e(Qn,{checked:A.getIsAllRowsSelected(),indeterminate:A.getIsSomeRowsSelected(),onChange:A.getToggleAllRowsSelectedHandler()}),cell:({row:A})=>e(Qn,{checked:A.getIsSelected(),disabled:!A.getCanSelect(),indeterminate:A.getIsSomeSelected(),onChange:A.getToggleSelectedHandler()})},{header:()=>s(h,{gap:"size-50",direction:"row",alignItems:"center",children:[e(pi,{isExpanded:R.getIsAllRowsExpanded(),onClick:R.getToggleAllRowsExpandedHandler(),"aria-label":"Expand all rows"}),"kind"]}),enableSorting:!1,accessorKey:"spanKind",maxSize:100,cell:A=>e("div",{css:T`
              // Since rows are flattened by default,
              // we can use the row.depth property
              // and paddingLeft to visually indicate the depth
              // of the row
              padding-left: ${A.row.depth*2}rem;
            `,children:s(h,{gap:"size-50",children:[A.row.getCanExpand()?e(pi,{isExpanded:A.row.getIsExpanded(),onClick:A.row.getToggleExpandedHandler(),"aria-label":"Expand row"}):null,e(Kt,{spanKind:A.getValue()})]})})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:A,row:U})=>{const{traceId:oe}=U.original.context;return e(Qe,{to:`traces/${oe}?selectedSpanNodeId=${U.original.id}`,children:A()})}},{header:"input",accessorKey:"input.value",enableSorting:!1,cell:Ke},{header:"output",accessorKey:"output.value",enableSorting:!1,cell:Ke},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:Ke},...w,{header:"start time",accessorKey:"startTime",cell:Me},{header:"latency",accessorKey:"latencyMs",cell:({getValue:A})=>{const U=A();return U===null||typeof U!="number"?null:e(Re,{latencyMs:U})}},{header:"total tokens",minSize:80,accessorKey:"cumulativeTokenCountTotal",cell:({row:A,getValue:U})=>{const oe=U();return oe===null?"--":e(Jn,{tokenCountTotal:oe,tokenCountPrompt:A.original.cumulativeTokenCountPrompt||0,tokenCountCompletion:A.original.cumulativeTokenCountCompletion||0})}},{header:"status",accessorKey:"statusCode",enableSorting:!1,cell:({getValue:A})=>e(Tl,{statusCode:A()})}];m.useEffect(()=>{if(p){const A=i[0];m.startTransition(()=>{b({sort:A?ac(A):nc,after:null,first:Ai,filterCondition:o},{fetchPolicy:"store-and-network"})})}},[i,b,o,y,p]);const I=Ie.useCallback(A=>{if(A){const{scrollHeight:U,scrollTop:oe,clientHeight:$}=A;U-oe-$<300&&!k&&f&&g(Ai)}},[f,k,g]),[E,V]=m.useState({}),Q=Ln(A=>A.columnVisibility),R=xe({columns:K,data:P,onExpandedChange:V,manualSorting:!0,getSubRows:A=>A.children,state:{sorting:i,expanded:E,columnVisibility:Q,rowSelection:l},onRowSelectionChange:t,enableSubRowSelection:!1,onSortingChange:r,getCoreRowModel:De(),getSortedRowModel:kn(),getExpandedRowModel:Wi(),getRowId:A=>A.id}),q=R.getRowModel().rows,ee=R.getSelectedRowModel().flatRows,ge=ee.map(A=>A.original),he=m.useCallback(()=>{t({})},[t]),N=q.length===0,j=R.getAllColumns().filter(A=>A.columns.length===0);return s("div",{css:ei,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:s(h,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(Wd,{onValidCondition:d}),e(Ud,{columns:j,query:u})]})}),e("div",{css:T`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:A=>I(A.target),ref:a,children:s("table",{css:Gn,children:[e("thead",{children:R.getHeaderGroups().map(A=>e("tr",{children:A.headers.map(U=>e("th",{colSpan:U.colSpan,children:U.isPlaceholder?null:s("div",{"data-sortable":U.column.getCanSort(),className:U.column.getCanSort()?"cursor-pointer":"",onClick:U.column.getToggleSortingHandler(),style:{left:U.getStart(),width:U.getSize()},children:[Z(U.column.columnDef.header,U.getContext()),U.column.getIsSorted()?e(_,{className:"sort-icon",svg:U.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]})},U.id))},A.id))}),N?e(jd,{projectName:u.name}):e("tbody",{children:q.map(A=>e("tr",{onClick:()=>c(`traces/${A.original.context.traceId}`),children:A.getVisibleCells().map(U=>e("td",{children:Z(U.column.columnDef.cell,U.getContext())},U.id))},A.id))})]})}),ee.length?e(ec,{selectedSpans:ge,onClearSelection:he}):null]})}const mb=T`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function qv(){const{projectId:n}=an(),{timeRange:a}=Dl();return e(m.Suspense,{fallback:e(Ce,{}),children:e(pb,{projectId:n,timeRange:a})})}const dc=Fd,cc=Cd;function pb({projectId:n,timeRange:a}){const l=m.useMemo(()=>{var u,g;return{start:(u=a==null?void 0:a.start)==null?void 0:u.toISOString(),end:(g=a==null?void 0:a.end)==null?void 0:g.toISOString()}},[a]),t=x.useLazyLoadQuery(vd,{id:n,timeRange:l},{fetchPolicy:"store-and-network"}),[i,r,o]=x.useQueryLoader(dc),[d,c,p]=x.useQueryLoader(cc),y=m.useCallback(u=>{u===1?(p(),r({id:n,timeRange:l})):u===2?(o(),c({id:n,timeRange:l})):(o(),p())},[o,r,p,c,n,l]);return s("main",{css:mb,children:[e(Rk,{project:t.project,extra:s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(cb,{project:t.project}),e(Mr,{})]})}),s(He,{onChange:y,children:[e(ne,{name:"Traces",children:({isSelected:u})=>u&&e(Mi,{children:e(m.Suspense,{children:e(ub,{project:t.project})})})}),e(ne,{name:"Spans",children:({isSelected:u})=>u&&i&&e(Mi,{children:e(m.Suspense,{fallback:e(Ce,{}),children:e(gb,{queryReference:i})})})}),e(ne,{name:"Sessions",children:({isSelected:u})=>u&&d&&e(Ak,{children:e(m.Suspense,{children:e(yb,{queryReference:d})})})})]}),e(m.Suspense,{children:e(Oe,{})})]})}function gb({queryReference:n}){const a=x.usePreloadedQuery(dc,n);return e(ob,{project:a.project})}function yb({queryReference:n}){const a=x.usePreloadedQuery(cc,n);return e(Jk,{project:a.project})}const uc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"04c84b5bc2a01477851d347af75dcc11",id:null,metadata:{},name:"projectLoaderQuery",operationKind:"query",text:`query projectLoaderQuery(
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    id
    ... on Project {
      name
    }
  }
}
`}}}();uc.hash="3d31e323c06df38ec2eaa6f3adb55e79";async function Uv(n){const{projectId:a}=n.params;return await x.fetchQuery(be,uc,{id:a}).toPromise()}function Bv(){const n=Ju(),a=m.useMemo(()=>n instanceof Error&&n.message==="Failed to fetch"?e(fb,{}):e(hb,{error:n}),[n]);return e("main",{css:T`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      `,children:e("section",{css:T`
          width: 500px;
          /* Add spacing on the bottom so it gets pushed down */
          margin-top: 200px;
          display: flex;
          flex-direction: column;
        `,children:a})})}function fb(){return s(H,{children:[s(h,{direction:"column",width:"100%",alignItems:"center",children:[e(yl,{graphicKey:"not found"}),e("h1",{children:"Server disconnected"})]}),e("p",{children:"We are unable to reach the Phoenix server. Please ensure that Phoenix is running and try again."})]})}function hb({error:n}){return s(H,{children:[s(h,{direction:"column",width:"100%",alignItems:"center",children:[e(yl,{graphicKey:"error"}),e("h1",{children:"Something went wrong"})]}),e("p",{children:"We strive to do our very best but 🐛 bugs happen. It would mean a lot to us if you could file a an issue. If you feel comfortable, please include the error details below in your issue. We will get back to you as soon as we can."}),e("p",{css:T`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:s("span",{css:T`
            display: inline-flex;
            flex-direction: row;
            align-items: baseline;
            gap: 0.2em;
          `,children:["💙 the",e(en,{href:"mailto:phoenix-devs@arize.com",children:"phoenix team"})]})}),s("div",{css:T`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(en,{href:"https://github.com/Arize-ai/phoenix/issues/new?assignees=&labels=bug&template=bug_report.md&title=%5BBUG%5D",children:"file an issue with us"}),e(M,{variant:"primary",size:"S",onPress:()=>{window.location.href="/"},children:"Return Home"})]}),s("details",{open:!0,children:[e("summary",{children:"error details"}),e("pre",{css:T`
            white-space: pre-wrap;
            overflow-wrap: break-word;
            overflow: hidden;
            overflow-y: auto;
            max-height: 500px;
          `,children:n instanceof Error?n.message:null})]})]})}const mc=function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],a=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:n,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelRootQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ModelRootQuery",selections:a},params:{cacheID:"c3baccc5527002697b40a06eef432a4d",id:null,metadata:{},name:"ModelRootQuery",operationKind:"query",text:`query ModelRootQuery {
  model {
    primaryInferences {
      name
      startTime
      endTime
    }
    referenceInferences {
      name
      startTime
      endTime
    }
    corpusInferences {
      name
      startTime
      endTime
    }
  }
}
`}}}();mc.hash="b73d8f3f532a0c6f88863f3c6dd5734f";const kb=mc;function Hv(){const n=x.useLazyLoadQuery(kb,{}),{model:{primaryInferences:a,referenceInferences:l,corpusInferences:t}}=n;return e(Zp,{primaryInferences:a,referenceInferences:l??null,corpusInferences:t??null,children:e(Jp,{timeRangeBounds:{start:new Date(a.startTime),end:new Date(a.endTime)},children:e(Oe,{})})})}function Gv(){return e(Nk,{children:e(Lk,{children:e(Oe,{})})})}function Wv(){return e(Xp,{children:e(Oe,{})})}const pc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={kind:"Variable",name:"timeRange",variableName:"timeRange"},t=[l];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageProjectsQuery",selections:[{args:a,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageProjectsQuery",selections:[{alias:null,args:a,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"ead527a5c3ddda0f6c906c99183edf06",id:null,metadata:{},name:"ProjectsPageProjectsQuery",operationKind:"query",text:`query ProjectsPageProjectsQuery(
  $after: String = null
  $first: Int = 50
  $timeRange: TimeRange
) {
  ...ProjectsPageProjectsFragment_2HEEH6
}

fragment ProjectsPageProjectsFragment_2HEEH6 on Query {
  projects(first: $first, after: $after) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        traceCount(timeRange: $timeRange)
        endTime
        latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
        tokenCountTotal(timeRange: $timeRange)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();pc.hash="56c501357948255461a24411fb6b5847";const gc=function(){var n=["projects"],a={kind:"Variable",name:"timeRange",variableName:"timeRange"},l=[a];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:pc}},name:"ProjectsPageProjectsFragment",selections:[{alias:"projects",args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"__ProjectsPage_projects_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},a],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();gc.hash="56c501357948255461a24411fb6b5847";const yc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Literal",name:"first",value:50}],l={kind:"Variable",name:"timeRange",variableName:"timeRange"},t=[l];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageQuery",selections:[{args:null,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageQuery",selections:[{alias:null,args:a,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"projects(first:50)"},{alias:null,args:a,filters:null,handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"35a420462b10b0f0158d042fd39bfabb",id:null,metadata:{},name:"ProjectsPageQuery",operationKind:"query",text:`query ProjectsPageQuery(
  $timeRange: TimeRange!
) {
  ...ProjectsPageProjectsFragment
}

fragment ProjectsPageProjectsFragment on Query {
  projects(first: 50) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        traceCount(timeRange: $timeRange)
        endTime
        latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
        tokenCountTotal(timeRange: $timeRange)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();yc.hash="c28f5ced0b3ec4b3b8277d0aac29de2d";const bb="https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-tracing";function Sb(){const[n,a]=m.useState(null);return s("div",{children:[e(M,{leadingVisual:e(_,{svg:e(er,{})}),size:"S",onPress:()=>{a(e(vb,{}))},children:"New Project"}),e(Y,{isDismissable:!0,type:"slideOver",onDismiss:()=>a(null),children:n})]})}function vb(){const[n,a]=m.useState("Python");return e(X,{title:"Create a New Project",size:"L",children:s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-200",children:e(vl,{language:n,onChange:a})}),e(C,{paddingBottom:"size-100",children:s(v,{children:["Projects are created when you log your first trace via OpenTelemetry. See the"," ",e(en,{href:bb,children:"documentation"})," ","for a complete guide."]})}),n==="Python"?e(wr,{}):e(Er,{})]})})}const fc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuClearMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuClearMutation",selections:a},params:{cacheID:"63319b4e42b499db2447817f1dc821fb",id:null,metadata:{},name:"ProjectActionMenuClearMutation",operationKind:"mutation",text:`mutation ProjectActionMenuClearMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}}();fc.hash="c43eec4d6b882468c611dd9ebf3b095e";const hc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"}],a=[{alias:null,args:[{kind:"Variable",name:"id",variableName:"projectId"}],concreteType:"Query",kind:"LinkedField",name:"deleteProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuDeleteMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuDeleteMutation",selections:a},params:{cacheID:"8b00ab3aaef4c5fb3de24f7295d38499",id:null,metadata:{},name:"ProjectActionMenuDeleteMutation",operationKind:"mutation",text:`mutation ProjectActionMenuDeleteMutation(
  $projectId: GlobalID!
) {
  deleteProject(id: $projectId) {
    __typename
  }
}
`}}}();hc.hash="3bf82e90b3f2d3485b4efb954e30b2cf";const kc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RemoveProjectDataFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RemoveProjectDataFormMutation",selections:a},params:{cacheID:"1b27a3f7535c3f3943b0f2248d1505a6",id:null,metadata:{},name:"RemoveProjectDataFormMutation",operationKind:"mutation",text:`mutation RemoveProjectDataFormMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}}();kc.hash="212501fe2d6367ec1503bd7a00c1730f";function Cb(n){const{projectId:a}=n,l=m.useRef(null),[t,i]=x.useMutation(kc),{control:r,handleSubmit:o,setError:d,formState:{isValid:c}}=Ae({defaultValues:{endDate:Zu(new Date(Date.now()-Yp).toISOString())}}),p=m.useCallback(y=>{const u=y.endDate.toDate(ut());if(!Xu(u))return d("endDate",{message:"Date is not in a valid format"});t({variables:{input:{id:a,endTime:new Date(u).toISOString()}},onCompleted:()=>{n.onComplete()},onError:g=>{alert("Failed to clear project traces: "+g)}})},[t,a,n,d]);return s("form",{onSubmit:o(p),ref:l,children:[s(C,{padding:"size-200",children:[e(v,{color:"danger",children:" This will remove all data before the following date. This cannot be undone."}),e(G,{name:"endDate",control:r,rules:{required:"field is required"},render:({field:{name:y,onChange:u,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(eg,{isInvalid:k,onChange:u,name:y,onBlur:g,value:f,granularity:"second",hideTimeZone:!0,css:T`
                .react-aria-DateInput {
                  width: 100%;
                }
              `,children:[e(W,{children:"End Date"}),e(Yu,{children:S=>e(em,{segment:S})}),b?e(Fe,{children:b.message}):e(v,{slot:"description",children:"The date up to which you want to remove data"})]})})]}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{type:"submit",variant:"danger",isDisabled:!c||i,size:"S",leadingVisual:i?e(_,{svg:e(ln,{})}):void 0,onPress:()=>{var y;(y=l.current)==null||y.requestSubmit()},children:i?"Removing...":"Remove Data"})})})]})}function Fb({projectId:n,projectName:a,onProjectDelete:l,onProjectClear:t,onProjectRemoveData:i}){const[r,o]=m.useState(null),d=a!=="default",[c]=x.useMutation(hc),[p]=x.useMutation(fc),y=m.useCallback(()=>{m.startTransition(()=>{c({variables:{projectId:n}}),l()})},[c,n,l]),u=m.useCallback(()=>{m.startTransition(()=>{p({variables:{input:{id:n}},onCompleted:()=>{t()},onError:b=>{alert("Failed to clear project: "+b)}})})},[p,n,t]),g=m.useCallback(()=>{o(s(X,{size:"S",title:"Delete Project",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to delete project ${a}? This cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{y(),o(null)},children:"Delete Project"})})})]}))},[y,a]),f=m.useCallback(()=>{o(s(X,{size:"S",title:"Clear Project",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to clear project ${a}? All traces and evaluations for this project will be deleted. This cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{u(),o(null)},children:"Clear"})})})]}))},[u,a]),k=m.useCallback(()=>{o(e(X,{size:"S",title:"Remove Data",children:e(Cb,{projectId:n,onComplete:()=>{i(),o(null)}})}))},[i,n]);return s("div",{onClick:b=>{b.preventDefault(),b.stopPropagation()},children:[s(Hn,{buttonVariant:"quiet",align:"end",onAction:b=>{switch(b){case"deleteProject":return g();case"clearProject":return f();case"removeProjectData":return k()}},disabledKeys:d?[]:["deleteProject"],children:[e(de,{textValue:"Clear Traces",children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(_,{svg:e(Rr,{})}),e(v,{children:"Clear Data"})]})},"clearProject"),e(de,{textValue:"Remove Data",children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(_,{svg:e(_l,{})}),e(v,{children:"Remove Data"})]})},"removeProjectData"),d?e(de,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(_,{svg:e(sn,{})}),e(v,{children:"Delete"})]})},"deleteProject"):null]}),e(Y,{type:"modal",isDismissable:!0,onDismiss:()=>o(null),children:r})]})}function Kb(){const n=Ge(l=>l.projectsAutoRefreshEnabled),a=Ge(l=>l.setProjectAutoRefreshEnabled);return e(xa,{labelPlacement:"start",isSelected:n,onChange:()=>{a(!n)},children:"Auto-Refresh"})}const Tb=1e4,Pb=50;function Jv(){const{timeRange:n}=Dl();return e(m.Suspense,{fallback:e(Ce,{}),children:e(Ib,{timeRange:n})})}function Ib({timeRange:n}){const a=Ge(F=>F.projectsAutoRefreshEnabled),[l,t]=mm(),i=m.useMemo(()=>{var F,P;return{start:(F=n==null?void 0:n.start)==null?void 0:F.toISOString(),end:(P=n==null?void 0:n.end)==null?void 0:P.toISOString()}},[n]),r=x.useLazyLoadQuery(yc,{timeRange:i}),{data:o,loadNext:d,hasNext:c,isLoadingNext:p,refetch:y}=x.usePaginationFragment(gc,r),u=o.projects.edges.map(F=>F.project),g=m.useRef(null),f=m.useCallback(F=>{if(F){const{scrollHeight:P,scrollTop:D,clientHeight:w}=F;P-D-w<300&&!p&&c&&d(Pb)}},[c,p,d]);ic(()=>{m.startTransition(()=>{y({},{fetchPolicy:"store-and-network"})})},a?Tb:null);const k=m.useCallback(F=>{m.startTransition(()=>{y({},{fetchPolicy:"store-and-network"}),l({variant:"success",title:"Project Deleted",message:`Project ${F} has been deleted.`})})},[l,y]),b=m.useCallback(F=>{m.startTransition(()=>{y({},{fetchPolicy:"store-and-network"}),l({variant:"success",title:"Project Cleared",message:`Project ${F} has been cleared of traces.`})})},[l,y]),S=m.useCallback(F=>{m.startTransition(()=>{y({},{fetchPolicy:"store-and-network"}),l({variant:"success",title:"Project Data Removed",message:`Old data from project ${F} have been removed.`})})},[l,y]);return s("div",{css:T`
        flex: 1 1 auto;
        overflow-y: auto;
        overflow-x: hidden;
        padding-bottom: var(--ac-global-dimension-size-750);
      `,onScroll:F=>f(F.target),ref:g,children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",width:"100%",borderBottomColor:"grey-200",borderBottomWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",alignItems:"center",gap:"size-100",children:[e(Kb,{}),e(Sb,{}),e(Mr,{})]})}),e(C,{padding:"size-200",width:"100%",children:e("ul",{css:T`
            display: flex;
            flex-direction: row;
            gap: var(--ac-global-dimension-size-200);
            flex-wrap: wrap;
          `,children:u.map(F=>e("li",{children:e(Qe,{to:`/projects/${F.id}`,css:T`
                  text-decoration: none;
                `,children:e(Db,{project:F,onProjectDelete:()=>k(F.name),onProjectClear:()=>b(F.name),onProjectRemoveData:()=>S(F.name)})})},F.id))})}),t]})}function xb({gradientStartColor:n,gradientEndColor:a}){return e("div",{css:T`
        border-radius: 50%;
        width: 32px;
        height: 32px;
        background: linear-gradient(
          136.27deg,
          ${n} 14.03%,
          ${a} 84.38%
        );
        flex-shrink: 0;
      `})}function Db({project:n,onProjectDelete:a,onProjectClear:l,onProjectRemoveData:t}){const{endTime:i,traceCount:r,tokenCountTotal:o,latencyMsP50:d,gradientStartColor:c,gradientEndColor:p}=n,y=m.useMemo(()=>i?`Last updated  ${nm(new Date(i),new Date,{addSuffix:!0})}`:"No traces uploaded yet.",[i]);return s("div",{css:T`
        padding: var(--ac-global-dimension-size-200);
        border: 1px solid var(--ac-global-color-grey-400);
        background-color: var(--ac-global-color-grey-100);
        border-radius: var(--ac-global-rounding-medium);
        height: var(--ac-global-dimension-size-1250);
        width: var(--ac-global-dimension-size-3600);
        transition: border-color 0.2s;
        &:hover {
          border-color: var(--ac-global-color-primary);
        }
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      `,children:[s(h,{direction:"row",justifyContent:"space-between",alignItems:"start",children:[s(h,{direction:"row",gap:"size-100",alignItems:"center",minWidth:0,children:[e(xb,{gradientStartColor:c,gradientEndColor:p}),s(h,{direction:"column",minWidth:0,children:[e(te,{level:2,css:T`
                overflow: hidden;
                white-space: nowrap;
                text-overflow: ellipsis;
              `,children:n.name}),e(v,{color:"text-700",size:"XS",fontStyle:"italic",children:y})]})]}),e(Fb,{projectId:n.id,projectName:n.name,onProjectDelete:a,onProjectClear:l,onProjectRemoveData:t})]}),s(h,{direction:"row",justifyContent:"space-between",children:[s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(v,{size:"L",children:oa(r)})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Tokens"}),e(v,{size:"L",children:oa(o)})]}),s(h,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),d!=null?e(Re,{latencyMs:d,size:"L"}):e(v,{size:"L",children:"--"})]})]})]})}const bc=function(){var n=[{kind:"Literal",name:"first",value:100},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetsPageQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetsPageQuery",selections:[{alias:null,args:n,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:'datasets(first:100,sort:{"col":"createdAt","dir":"desc"})'},{alias:null,args:n,filters:["sort"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"695b221e981c4795492d79faa7d007e4",id:null,metadata:{},name:"DatasetsPageQuery",operationKind:"query",text:`query DatasetsPageQuery {
  ...DatasetsTable_datasets
}

fragment DatasetsTable_datasets on Query {
  datasets(first: 100, sort: {col: createdAt, dir: desc}) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();bc.hash="985853a7939f44c0cefdd1a91472c67e";function _b(n){const a=n.split(`
`);return a.length>0?a[0].split(",").map(l=>l.trim()):[]}function Lb(n){const{onDatasetCreated:a,onDatasetCreateError:l}=n,[t,i]=m.useState([]),{control:r,handleSubmit:o,resetField:d,formState:{isDirty:c,isValid:p}}=Ae({defaultValues:{name:"Dataset "+new Date().toISOString(),input_keys:[],output_keys:[],metadata_keys:[],description:"",metadata:{}}}),y=m.useCallback(u=>{const g=new FormData;return g.append("file",u.file[0]),g.append("name",u.name),g.append("description",u.description),g.append("metadata",JSON.stringify(u.metadata)),u.input_keys.forEach(f=>{g.append("input_keys[]",f)}),u.output_keys.forEach(f=>{g.append("output_keys[]",f)}),u.metadata_keys.forEach(f=>{g.append("metadata_keys[]",f)}),fetch("/v1/datasets/upload?sync=true",{method:"POST",body:g}).then(f=>{if(!f.ok)throw l(new Error(f.statusText||"Failed to create dataset"));return f.json()}).then(f=>{a({name:u.name,id:f.data.dataset_id})})},[l,a]);return s(Xe,{onSubmit:o(y),children:[s("div",{css:T`
          padding: var(--ac-global-dimension-size-200);
          .ac-dropdown-button {
            width: 100%;
          }
        `,children:[e(G,{name:"name",control:r,rules:{required:"field is required"},render:({field:{onChange:u,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{isInvalid:k,onChange:u,onBlur:g,value:f.toString(),children:[e(W,{children:"Dataset Name"}),e(ae,{placeholder:"e.x. Golden Dataset"}),b!=null&&b.message?e(Fe,{children:b.message}):e(v,{slot:"description",children:"The name of the dataset"})]})}),e(G,{name:"description",control:r,render:({field:{onChange:u,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{isInvalid:k,onChange:u,onBlur:g,value:f.toString(),children:[e(W,{children:"Description"}),e(ca,{placeholder:"e.x. A dataset for structured data extraction"}),b!=null&&b.message?e(Fe,{children:b.message}):e(v,{slot:"description",children:"The description of the dataset"})]})}),e(G,{control:r,name:"file",rules:{required:"CSV file is required"},render:({field:{value:u,onChange:g,...f},fieldState:{invalid:k,error:b}})=>e(Bn,{label:"CSV file",validationState:k?"invalid":"valid",errorMessage:b==null?void 0:b.message,children:e("input",{...f,onChange:S=>{var P;g(S.target.files),d("input_keys"),d("output_keys"),d("metadata_keys");const F=(P=S.target.files)==null?void 0:P[0];if(F){const D=new FileReader;D.onload=function(w){if(!w.target)return;const K=w.target.result,I=_b(K);i(I)},D.readAsText(F)}},type:"file",id:"file",accept:".csv"})})}),e(G,{name:"input_keys",control:r,rules:{required:"field is required"},render:({field:{value:u,onChange:g},fieldState:{invalid:f,error:k}})=>e(Xl,{label:"input keys",validationState:f?"invalid":"valid",description:"the columns to use as input",columns:t,selectedColumns:u,onChange:g,errorMessage:k==null?void 0:k.message})}),e(G,{name:"output_keys",control:r,render:({field:{value:u,onChange:g},fieldState:{invalid:f,error:k}})=>e(Xl,{label:"output keys",validationState:f?"invalid":"valid",description:"the columns to use as output",columns:t,selectedColumns:u,onChange:g,errorMessage:k==null?void 0:k.message})}),e(G,{name:"metadata_keys",control:r,render:({field:{value:u,onChange:g},fieldState:{invalid:f,error:k}})=>e(Xl,{label:"metadata keys",validationState:f?"invalid":"valid",description:"the columns to use as metadata",columns:t,selectedColumns:u,onChange:g,errorMessage:k==null?void 0:k.message})})]}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{type:"submit",isDisabled:!p,variant:c?"primary":"default",size:"S",children:"Create Dataset"})})})]})}function Xl(n){const{columns:a,selectedColumns:l,onChange:t,label:i,validationState:r,description:o,errorMessage:d,...c}=n,p=a.length===0,y=m.useMemo(()=>p?"No columns to select":l.length>0?`${l.join(", ")}`:"No columns selected",[l,p]);return e(Bn,{label:i,isDisabled:p,validationState:r,description:o,errorMessage:d,children:e(ft,{isDisabled:p,...c,menu:e(hl,{selectionMode:"multiple",onSelectionChange:u=>{t(Array.from(u))},selectedKeys:new Set(l),children:a.map(u=>e(de,{children:u},u))}),triggerProps:{placement:"bottom end"},children:y})})}const Sc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"sort",variableName:"sort"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetsTableDatasetsQuery",selections:[{args:a,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetsTableDatasetsQuery",selections:[{alias:null,args:a,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:["sort"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"5ac1688f54e51f9bb3247c83e23d98fb",id:null,metadata:{},name:"DatasetsTableDatasetsQuery",operationKind:"query",text:`query DatasetsTableDatasetsQuery(
  $after: String = null
  $first: Int = 100
  $sort: DatasetSort = {col: createdAt, dir: desc}
) {
  ...DatasetsTable_datasets_dWkdd
}

fragment DatasetsTable_datasets_dWkdd on Query {
  datasets(first: $first, after: $after, sort: $sort) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Sc.hash="fa378bc7ec26f5e877e6cf90e5ee553d";const vc=function(){var n=["datasets"];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Sc}},name:"DatasetsTable_datasets",selections:[{alias:"datasets",args:[{kind:"Variable",name:"sort",variableName:"sort"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"__DatasetsTable_datasets_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();vc.hash="fa378bc7ec26f5e877e6cf90e5ee553d";const Cc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{alias:null,args:[{fields:[{kind:"Variable",name:"datasetId",variableName:"datasetId"}],kind:"ObjectValue",name:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeleteDatasetDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeleteDatasetDialogMutation",selections:a},params:{cacheID:"3d32b97acd630dd7dbc9c85a632a1d49",id:null,metadata:{},name:"DeleteDatasetDialogMutation",operationKind:"mutation",text:`mutation DeleteDatasetDialogMutation(
  $datasetId: GlobalID!
) {
  deleteDataset(input: {datasetId: $datasetId}) {
    __typename
  }
}
`}}}();Cc.hash="7066cca7015a7e344b77862b0bdab21c";function wb({datasetId:n,datasetName:a,onDatasetDelete:l,onDatasetDeleteError:t}){const[i,r]=x.useMutation(Cc),o=m.useCallback(()=>{m.startTransition(()=>{i({variables:{datasetId:n},onCompleted:()=>{l()},onError:d=>{t(d)}})})},[i,n,l,t]);return s(X,{size:"S",title:"Delete Dataset",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to delete dataset ${a}? This will also delete all associated experiments and traces, and it cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{o()},isDisabled:r,leadingVisual:e(_,{svg:r?e(ln,{}):e(sn,{})}),children:"Delete Dataset"})})})]})}function Eb({datasetName:n,datasetId:a,datasetDescription:l,datasetMetadata:t,onDatasetEdited:i,onDatasetEditError:r}){return e(X,{title:"Edit Dataset",size:"M",children:e(ng,{datasetName:n,datasetId:a,datasetDescription:l,datasetMetadata:t,onDatasetEdited:i,onDatasetEditError:r})})}function Vb(n){const{datasetId:a,datasetName:l,datasetDescription:t,datasetMetadata:i,onDatasetDelete:r,onDatasetDeleteError:o,onDatasetEdit:d,onDatasetEditError:c}=n,[p,y]=m.useState(null),u=m.useCallback(()=>{y(e(wb,{datasetId:a,datasetName:l,onDatasetDelete:()=>{r(),y(null)},onDatasetDeleteError:o}))},[a,l,r,o]),g=m.useCallback(()=>{y(e(Eb,{datasetId:a,datasetName:l,datasetDescription:t,datasetMetadata:i,onDatasetEdited:()=>{d(),y(null)},onDatasetEditError:c}))},[t,a,i,l,d,c]);return s("div",{onClick:f=>{f.preventDefault(),f.stopPropagation()},children:[s(Hn,{align:"end",buttonSize:"compact",onAction:f=>{switch(f){case"deleteDataset":u();break;case"editDataset":g();break}},children:[e(de,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(_,{svg:e(sn,{})}),e(v,{children:"Delete"})]})},"deleteDataset"),e(de,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(_,{svg:e(Ct,{})}),e(v,{children:"Edit"})]})},"editDataset")]}),e(Y,{type:"modal",isDismissable:!0,onDismiss:()=>y(null),children:p})]})}const Ni=100;function Mb(n){const a=n.id;if(a!=="createdAt"&&a!=="name")throw new Error("Invalid sort column");return{col:a,dir:n.desc?"desc":"asc"}}function Rb(n){const[a,l]=m.useState([]),t=m.useRef(null),i=se(),r=Se(),o=Te(),{data:d,loadNext:c,hasNext:p,isLoadingNext:y,refetch:u}=x.usePaginationFragment(vc,n.query),g=m.useMemo(()=>d.datasets.edges.map(F=>F.node),[d]),f=Ie.useCallback(F=>{if(F){const{scrollHeight:P,scrollTop:D,clientHeight:w}=F;P-D-w<300&&!y&&p&&c(Ni)}},[p,y,c]),k=xe({columns:[{header:"name",accessorKey:"name",cell:({row:F})=>{const D=F.original.experimentCount>0?`${F.original.id}/experiments`:`${F.original.id}/examples`;return e(Qe,{to:D,children:F.original.name})}},{header:"description",accessorKey:"description",enableSorting:!1},{header:"created at",accessorKey:"createdAt",cell:Me},{header:"example count",accessorKey:"exampleCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"experiment count",accessorKey:"experimentCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:Fa},{header:"",id:"actions",enableSorting:!1,size:10,cell:({row:F})=>e(Vb,{datasetId:F.original.id,datasetName:F.original.name,datasetDescription:F.original.description,datasetMetadata:F.original.metadata,onDatasetEdit:()=>{r({title:"Dataset updated",message:`${F.original.name} has been successfully updated.`}),u({},{fetchPolicy:"store-and-network"})},onDatasetEditError:P=>{const D=Pe(P);o({title:"Dataset update failed",message:(D==null?void 0:D[0])??P.message})},onDatasetDelete:()=>{r({title:"Dataset deleted",message:`${F.original.name} has been successfully deleted.`}),u({},{fetchPolicy:"store-and-network"})},onDatasetDeleteError:P=>{const D=Pe(P);o({title:"Dataset deletion failed",message:(D==null?void 0:D[0])??P.message})}})}],data:g,state:{sorting:a},getCoreRowModel:De(),getSortedRowModel:kn(),onSortingChange:l,manualSorting:!0});m.useEffect(()=>{const F=a[0];m.startTransition(()=>{u({sort:F?Mb(F):{col:"createdAt",dir:"desc"},after:null,first:Ni},{fetchPolicy:"store-and-network"})})},[a,u]);const b=k.getRowModel().rows,S=b.length===0;return e("div",{css:T`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:F=>f(F.target),ref:t,children:s("table",{css:Gn,children:[e("thead",{children:k.getHeaderGroups().map(F=>e("tr",{children:F.headers.map(P=>{var D;return e("th",{colSpan:P.colSpan,children:P.isPlaceholder?null:s("div",{className:P.column.getCanSort()?"cursor-pointer":"",onClick:P.column.getToggleSortingHandler(),style:{textAlign:(D=P.column.columnDef.meta)==null?void 0:D.textAlign},children:[Z(P.column.columnDef.header,P.getContext()),P.column.getIsSorted()?e(_,{className:"sort-icon",svg:P.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]})},P.id)})},F.id))}),S?e(rn,{}):e("tbody",{children:b.map(F=>e("tr",{onClick:()=>{const D=F.original.experimentCount>0?`${F.original.id}/experiments`:`${F.original.id}/examples`;i(D)},children:F.getVisibleCells().map(P=>{var D;return e("td",{align:(D=P.column.columnDef.meta)==null?void 0:D.textAlign,children:Z(P.column.columnDef.cell,P.getContext())},P.id)})},F.id))})]})})}function Zv(){return e(m.Suspense,{fallback:e(Ce,{}),children:e(Ab,{})})}function Ab(){const[n,a]=m.useState(0),l=x.useLazyLoadQuery(bc,{},{fetchKey:n,fetchPolicy:"store-and-network"}),t=m.useCallback(()=>{a(i=>i+1)},[a]);return s(h,{direction:"column",height:"100%",children:[e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",children:[e(te,{level:1,children:"Datasets"}),e(Nb,{onDatasetCreated:t})]})}),e(Rb,{query:l})]})}function Nb({onDatasetCreated:n}){const a=se(),l=Se(),t=Te(),[i,r]=m.useState(null),o=()=>{r(e(X,{size:"S",title:"New Dataset",children:e(Vr,{onDatasetCreated:c=>{l({title:"Dataset created",message:`${c.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${c.id}`)}}}),r(null),n()},onDatasetCreateError:c=>{const p=Pe(c);t({title:"Dataset creation failed",message:(p==null?void 0:p[0])??c.message})}})}))},d=()=>{r(e(X,{size:"M",title:"New Dataset from CSV",children:e(Lb,{onDatasetCreated:c=>{l({title:"Dataset created",message:`${c.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${c.id}`)}}}),r(null),n()},onDatasetCreateError:c=>{const p=Pe(c);t({title:"Dataset creation failed",message:(p==null?void 0:p[0])??c.message})}})}))};return s(H,{children:[s(Hn,{buttonText:"Create Dataset",align:"end",icon:e(_,{svg:e(St,{})}),onAction:c=>{switch(c){case"newDataset":o();break;case"datasetFromCSV":d();break}},children:[e(de,{children:"New Dataset"},"newDataset"),e(de,{children:"Dataset from CSV"},"datasetFromCSV")]}),e(Y,{type:"modal",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const Fc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"d7075240e4dae8871997e57616c05302",id:null,metadata:{},name:"datasetStore_latestVersionQuery",operationKind:"query",text:`query datasetStore_latestVersionQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}}();Fc.hash="a1349b92d8b0c745f5e8039c55b048c7";const zb=n=>{const a=(l,t)=>({...n,isRefreshingLatestVersion:!1,refreshLatestVersion:async()=>{const i=t();l({isRefreshingLatestVersion:!0});const r=await $b({datasetId:i.datasetId});l({latestVersion:r,isRefreshingLatestVersion:!1})}});return Bi()(am(a))};async function $b({datasetId:n}){var i;const a=await x.fetchQuery(be,Fc,{datasetId:n}).toPromise(),l=(i=a==null?void 0:a.dataset.latestVersions)==null?void 0:i.edges;return l&&l.length&&l[0].version||null}const Kc=m.createContext(null);function Ob({children:n,...a}){const[l]=m.useState(()=>zb(a));return e(Kc.Provider,{value:l,children:n})}function da(n,a){const l=m.useContext(Kc);if(!l)throw new Error("Missing DatasetContext.Provider in the tree");return Wa(l,n,a)}const Tc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"AddDatasetExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"AddDatasetExampleDialogMutation",selections:a},params:{cacheID:"718cf02ccb39b279132822bf503e51e6",id:null,metadata:{},name:"AddDatasetExampleDialogMutation",operationKind:"mutation",text:`mutation AddDatasetExampleDialogMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    __typename
  }
}
`}}}();Tc.hash="8d99470f590cd5d28701fa6e3c0330e6";const Yl={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function Qb(n){const{datasetId:a,onCompleted:l}=n,[t,i]=m.useState(null),[r,o]=x.useMutation(Tc),{control:d,setError:c,handleSubmit:p,formState:{isValid:y}}=Ae({defaultValues:{input:"{}",output:"{}",metadata:"{}"}}),u=m.useCallback(g=>{if(i(null),!Fn(g==null?void 0:g.input))return c("input",{message:"Input must be a valid JSON object"});if(!Fn(g==null?void 0:g.output))return c("output",{message:"Output must be a valid JSON object"});if(!Fn(g==null?void 0:g.metadata))return c("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{datasetId:a,examples:[{input:JSON.parse(g.input),output:JSON.parse(g.output),metadata:JSON.parse(g.metadata)}],datasetVersionDescription:g.description}},onCompleted:()=>{l()},onError:f=>{const k=Pe(f);i((k==null?void 0:k[0])??f.message)}})},[r,a,c,l]);return s(X,{size:"L",title:"Add Example",children:[e("div",{css:T`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:s(h,{direction:"column",gap:"size-200",children:[t?e(ye,{variant:"danger",children:t}):null,e(G,{control:d,name:"input",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(O,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...Yl,children:[b?e(ye,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(je,{value:k,onChange:g,onBlur:f})]})}),e(G,{control:d,name:"output",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(O,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...Yl,backgroundColor:"green-100",borderColor:"green-700",children:[b?e(ye,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(je,{value:k,onChange:g,onBlur:f})]})}),e(G,{control:d,name:"metadata",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(O,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...Yl,children:[b?e(ye,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(je,{value:k,onChange:g,onBlur:f})]})}),e(G,{control:d,name:"description",render:({field:{onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(J,{value:k,onChange:g,onBlur:f,isInvalid:b,children:[e(W,{children:"Version Description"}),e(ca,{}),S?e(Fe,{children:S.message}):e(v,{slot:"description",children:"A description of the changes made. Will be displayed in the version history."})]})})]})})})}),e(C,{padding:"size-200",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",gap:"size-100",children:e(M,{variant:"primary",size:"S",isDisabled:!y||o,leadingVisual:o?e(_,{svg:e(ln,{})}):null,onPress:()=>p(u)(),children:o?"Adding Example...":"Add Example"})})})]})}function jb(n){const{datasetId:a,onAddExampleCompleted:l}=n,[t,i]=m.useState(null),r=m.useCallback(()=>{i(e(Qb,{datasetId:a,onCompleted:()=>{l(),i(null)}}))},[a,l]);return s(H,{children:[e(M,{leadingVisual:e(_,{svg:e(bn,{})}),size:"S",onPress:r,children:"Add Example"}),e(Y,{isDismissable:!0,onDismiss:()=>{i(null)},children:t})]})}function qb(){const n=da(i=>i.datasetId),a=da(i=>i.latestVersion);let l=`${it}/v1/datasets/${n}/examples`;a&&(l+=`?version-id=${a.id}`);const t=m.useMemo(()=>`import phoenix as px
client = px.Client()
# Get the current dataset version
dataset = client.get_dataset(id="${n}"${a?`, version_id="${a.id}"`:""})`,[n,a]);return e("div",{css:T`
        button.ac-dropdown-button {
          min-width: 80px;
          .ac-dropdown-button__text {
            padding-right: 10px;
          }
        }
      `,children:s(ua,{placement:"bottom right",children:[e(mt,{addonBefore:e(_,{svg:e(kl,{})}),children:"Code"}),e(gl,{children:s("section",{css:T`
              width: 500px;
              .ac-field {
                flex: 1 1 auto;
              }
            `,children:[e(C,{padding:"size-200",children:s(Xe,{children:[s(h,{direction:"row",gap:"size-100",alignItems:"end",width:"100%",children:[s(J,{isReadOnly:!0,value:n,children:[e(W,{children:"Dataset ID"}),e(ae,{})]}),e(re,{text:n,size:"M"})]}),s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{isReadOnly:!0,value:(a==null?void 0:a.id)||"No Versions",isInvalid:!a,children:[e(W,{children:"Version ID"}),e(ae,{})]}),e(re,{text:(a==null?void 0:a.id)||"No Versions",isDisabled:!a,size:"M"})]})]})}),s(He,{children:[e(ne,{name:"Python",children:e(C,{margin:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"small",children:e(mn,{value:t})})}),e(ne,{name:"REST",children:e(C,{padding:"size-200",children:e(Xe,{children:s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{isReadOnly:!0,value:l,children:[e(W,{children:"URL"}),e(ae,{})]}),e(re,{text:l,size:"M"})]})})})})]})]})})]})})}const Pc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetHistoryDialogQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,{args:null,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetHistoryDialogQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"versions(first:100)"},{alias:null,args:i,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"df94b4e72c0187fd0fd1c8416af19354",id:null,metadata:{},name:"DatasetHistoryDialogQuery",operationKind:"query",text:`query DatasetHistoryDialogQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      id
      ...DatasetHistoryTable_versions
    }
    __isNode: __typename
    id
  }
}

fragment DatasetHistoryTable_versions on Dataset {
  versions(first: 100) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Pc.hash="7215c18bda690418c5ecbcb3131a288e";const Ic=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"e8e3a05b4e86c8eaeea98172405fdc7e",id:null,metadata:{},name:"DatasetHistoryTableVersionsQuery",operationKind:"query",text:`query DatasetHistoryTableVersionsQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...DatasetHistoryTable_versions_2HEEH6
    __isNode: __typename
    id
  }
}

fragment DatasetHistoryTable_versions_2HEEH6 on Dataset {
  versions(first: $first, after: $after) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Ic.hash="37e453bc58759a1e89bc5862c460de6b";const xc=function(){var n=["versions"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Ic,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DatasetHistoryTable_versions",selections:[{alias:"versions",args:null,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"__DatasetHistoryTable_versions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();xc.hash="37e453bc58759a1e89bc5862c460de6b";const Ub=100;function Bb(n){const a=m.useRef(null),{data:l,loadNext:t,hasNext:i,isLoadingNext:r}=x.usePaginationFragment(xc,n.dataset),o=m.useMemo(()=>l.versions.edges.map(u=>u.node),[l]),d=Ie.useCallback(u=>{if(u){const{scrollHeight:g,scrollTop:f,clientHeight:k}=u;g-f-k<300&&!r&&i&&t(Ub)}},[i,r,t]),c=xe({columns:[{header:"version ID",accessorKey:"id"},{header:"description",accessorKey:"description"},{header:"created at",accessorKey:"createdAt",cell:Me}],data:o,getCoreRowModel:De(),getSortedRowModel:kn()}),p=c.getRowModel().rows,y=p.length===0;return e("div",{css:T`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:u=>d(u.target),ref:a,children:s("table",{css:tn,children:[e("thead",{children:c.getHeaderGroups().map(u=>e("tr",{children:u.headers.map(g=>e("th",{colSpan:g.colSpan,children:g.isPlaceholder?null:s("div",{className:g.column.getCanSort()?"cursor-pointer":"",onClick:g.column.getToggleSortingHandler(),style:{left:g.getStart(),width:g.getSize()},children:[Z(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(_,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]})},g.id))},u.id))}),y?e(rn,{}):e("tbody",{children:p.map(u=>e("tr",{children:u.getVisibleCells().map(g=>e("td",{children:Z(g.column.columnDef.cell,g.getContext())},g.id))},u.id))})]})})}function Hb(n){const{datasetId:a}=n,l=x.useLazyLoadQuery(Pc,{datasetId:a});return e(X,{size:"L",title:"Dataset History",children:e("div",{css:T`
          height: 500px;
        `,children:e(Bb,{dataset:l.dataset})})})}function Gb(n){const{datasetId:a}=n,[l,t]=m.useState(null);return s(H,{children:[s(fe,{children:[e(M,{leadingVisual:e(_,{svg:e(ag,{})}),"aria-label":"Version History",onPress:()=>{t(e(Hb,{datasetId:a}))}}),e(Ve,{children:"Dataset Version History"})]}),e(m.Suspense,{fallback:null,children:e(Y,{type:"modal",isDismissable:!0,onDismiss:()=>{t(null)},children:l})})]})}const Wb=`pip install arize-phoenix>=${window.Config.platformVersion}`;function Jb({isAuthEnabled:n}){let a=`import os
# Set the phoenix collector endpoint. Commonly http://localhost:6006 
os.environ["PHOENIX_COLLECTOR_ENDPOINT"] = "<your-phoenix-url>"`;return n&&(a+=`
# Configure access
os.environ["PHOENIX_API_KEY"] = "<your-api-key>"`),a}const Zb=`from phoenix.experiments.types import Example
# Define your task
# Typically should be an LLM call or a call to your application
def my_task(example: Example) -> str:
    # This is just an example of how to return a JSON serializable value
    return f"Hello {example.input['person']}"`,Xb=`# Define an evaluator. This just an example.
def exact_match(input, output) -> float:
    return 1.0 if output is f"Hello {input}" else 0.0

# Store the evaluators for later use
evaluators = [exact_match]`,Yb=`# Run an experiment
from phoenix.experiments import run_experiment

experiment = run_experiment(dataset, my_task, evaluators=evaluators)`;function Dc(){const[n,a]=m.useState(null),l=m.useCallback(()=>{a(e(X,{title:"Run Experiment",size:"XL",children:e(eS,{})}))},[]);return s(H,{children:[e(M,{size:"S",leadingVisual:e(_,{svg:e(yr,{})}),onPress:l,children:"Run Experiment"}),e(Y,{isDismissable:!0,type:"slideOver",onDismiss:()=>{a(null)},children:n})]})}function eS(){const n=da(i=>i.datasetName),a=da(i=>i.latestVersion),l=window.Config.authenticationEnabled,t=m.useMemo(()=>`import phoenix as px
# Initialize a phoenix client
client = px.Client()
# Get the current dataset version. You can omit the version for the latest.
dataset = client.get_dataset(name="${n}"${a?`, version_id="${a.id}"`:""})`,[n,a]);return s(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-100",children:e(v,{children:"Install Phoenix"})}),e(Be,{children:e(mn,{value:Wb})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Point to a running instance of Phoenix"})}),e(Be,{children:e(mn,{value:Jb({isAuthEnabled:l})})}),e(lg,{children:e(C,{paddingBottom:"size-100",paddingTop:"size-100",children:e(Ar,{fallback:s(v,{children:["Your personal API keys can be created and managed on your"," ",e(en,{href:"/profile",children:"Profile"})]}),children:s(v,{children:["System API keys can be created and managed in"," ",e(en,{href:"/settings",children:"Settings"})]})})})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Pull down this dataset"})}),e(Be,{children:e(mn,{value:t})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Define your task"})}),e(Be,{children:e(mn,{value:Zb})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Define evaluators"})}),e(Be,{children:e(mn,{value:Xb})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(v,{children:"Run an experiment"})}),e(Be,{children:e(mn,{value:Yb})})]})}function Xv(){const n=Ue(),a=m.useMemo(()=>{const l=n.dataset.latestVersions;return l!=null&&l.edges&&l.edges.length?l.edges[0].version:null},[n]);return e(Ob,{datasetId:n.dataset.id,datasetName:n.dataset.name,latestVersion:a,children:e(m.Suspense,{fallback:e(Ce,{}),children:e(aS,{dataset:n.dataset})})})}const nS=T`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function aS({dataset:n}){const a=n.id,l=da(c=>c.refreshLatestVersion),t=Se(),i=se(),r=m.useCallback(c=>{c===0?i(`/datasets/${a}/experiments`):c===1&&i(`/datasets/${a}/examples`)},[i,a]),d=Ui().pathname.includes("examples")?1:0;return s("main",{css:nS,children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-50",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(h,{direction:"column",justifyContent:"space-between",children:e(h,{direction:"row",gap:"size-200",alignItems:"center",children:s(h,{direction:"column",children:[e(v,{elementType:"h1",size:"L",weight:"heavy",children:n.name}),e(v,{color:"text-700",children:n.description||"--"})]})})}),s(h,{direction:"row",gap:"size-100",children:[s(Hn,{align:"end",icon:e(_,{svg:e(Et,{})}),onAction:c=>{switch(c){case"csv":window.open(`/v1/datasets/${n.id}/csv`,"_blank");break;case"openai-ft":window.open(`/v1/datasets/${n.id}/jsonl/openai_ft`,"_blank");break;case"openai-evals":window.open(`/v1/datasets/${n.id}/jsonl/openai_evals`,"_blank");break}},children:[e(de,{children:"Download CSV"},"csv"),e(de,{children:"Download OpenAI Fine-Tuning JSONL"},"openai-ft"),e(de,{children:"Download OpenAI Evals JSONL"},"openai-evals")]}),e(Gb,{datasetId:n.id}),e(qb,{}),e(Dc,{}),e(M,{leadingVisual:e(_,{svg:e(pa,{})}),onPress:()=>{i(`/playground?datasetId=${n.id}`)},children:"Playground"}),e(jb,{datasetId:n.id,onAddExampleCompleted:()=>{t({title:"Example added",message:"The example has been added successfully and the version has been updated."}),l()}})]})]})}),s(He,{onChange:r,defaultIndex:d,children:[e(ne,{name:"Experiments",extra:e(un,{children:n.experimentCount}),children:e(m.Suspense,{children:e(Oe,{})})}),e(ne,{name:"Examples",extra:e(un,{children:n.exampleCount}),children:e(m.Suspense,{children:e(Oe,{})})})]})]})}const _c=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,i],storageKey:null}]},params:{cacheID:"5b221627cf7e63f41fbec41027cc0951",id:null,metadata:{},name:"datasetLoaderQuery",operationKind:"query",text:`query datasetLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      name
      description
      exampleCount
      experimentCount
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}}();_c.hash="469da2debdebd608c88a6ef83c2540aa";async function Yv(n){const{datasetId:a}=n.params;return await x.fetchQuery(be,_c,{id:a}).toPromise()}function e2(){const{exampleId:n,datasetId:a}=an(),l=se();return e(Wt,{exampleId:n,onDismiss:()=>{l(`/datasets/${a}/examples`)}})}const Lc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{args:null,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"examples(first:100)"},{alias:null,args:i,filters:["datasetVersionId"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"7e303fa9a3c09ccd6a3dc1f3dbb2afb3",id:null,metadata:{},name:"examplesLoaderQuery",operationKind:"query",text:`query examplesLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ...ExamplesTableFragment
  }
}

fragment ExamplesTableFragment on Dataset {
  examples(first: 100) {
    edges {
      example: node {
        id
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Lc.hash="6406bbf43a2e850b384ba9573d8e69de";async function n2(n){const{datasetId:a}=n.params;return await x.fetchQuery(be,Lc,{id:a}).toPromise()}const wc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExamplesTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExamplesTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:["datasetVersionId"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"ca59c018695d41ca01b5f9d453386886",id:null,metadata:{},name:"ExamplesTableQuery",operationKind:"query",text:`query ExamplesTableQuery(
  $after: String = null
  $datasetVersionId: GlobalID
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExamplesTableFragment_4a6F8Z
    __isNode: __typename
    id
  }
}

fragment ExamplesTableFragment_4a6F8Z on Dataset {
  examples(datasetVersionId: $datasetVersionId, first: $first, after: $after) {
    edges {
      example: node {
        id
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();wc.hash="e04e697cdb44ab2dd115f4562211f6a4";const Ec=function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:wc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__ExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();Ec.hash="e04e697cdb44ab2dd115f4562211f6a4";const Vc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDatasetExamples",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a},params:{cacheID:"b63159f3c325b9af3dc469692f9329e5",id:null,metadata:{},name:"ExampleSelectionToolbarDeleteExamplesMutation",operationKind:"mutation",text:`mutation ExampleSelectionToolbarDeleteExamplesMutation(
  $input: DeleteDatasetExamplesInput!
) {
  deleteDatasetExamples(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();Vc.hash="455bf9e5dc4b9cc655095dc829ef7e12";function lS(n){const a=da(f=>f.refreshLatestVersion),{selectedExamples:l,onExamplesDeleted:t,onClearSelection:i}=n,[r,o]=m.useState(null),d=Se(),c=Te(),[p,y]=x.useMutation(Vc),u=l.length!==1,g=m.useCallback(()=>{p({variables:{input:{exampleIds:l.map(f=>f.id)}},onCompleted:()=>{d({title:"Examples Deleted",message:`${l.length} example${u?"s":""} have been deleted.`}),t(),i(),a()},onError:f=>{const k=Pe(f);c({title:"An error occurred",message:`Failed to delete examples: ${(k==null?void 0:k[0])??f.message}`})}})},[p,l,d,u,t,i,a,c]);return s("div",{css:T`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(C,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(v,{children:`${l.length} example${u?"s":""} selected`}),s(h,{direction:"row",gap:"size-100",children:[e(M,{variant:"default",size:"S",onPress:i,children:"Cancel"}),e(M,{variant:"danger",size:"S",leadingVisual:e(_,{svg:y?e(ln,{}):e(sn,{})}),isDisabled:y,onPress:g,children:y?"Deleting...":"Delete Example"+(u?"s":"")})]})]})}),e(Y,{onDismiss:()=>{o(null)},children:r})]})}const tS=100;function iS({dataset:n}){const a=da(w=>w.latestVersion),l=m.useRef(null),[t,i]=Ie.useState({}),{data:r,loadNext:o,hasNext:d,isLoadingNext:c,refetch:p}=x.usePaginationFragment(Ec,n);m.useEffect(()=>{m.startTransition(()=>{p({datasetVersionId:(a==null?void 0:a.id)||null},{fetchPolicy:"store-and-network"})})},[a,p]);const y=m.useMemo(()=>r.examples.edges.map(w=>{const K=w.example,I=K.revision;return{id:K.id,input:I.input,output:I.output,metadata:I.metadata}}),[r]),g=xe({columns:[{id:"select",header:({table:w})=>e(Qn,{checked:w.getIsAllRowsSelected(),indeterminate:w.getIsSomeRowsSelected(),onChange:w.getToggleAllRowsSelectedHandler()}),cell:({row:w})=>e(Qn,{checked:w.getIsSelected(),disabled:!w.getCanSelect(),indeterminate:w.getIsSomeSelected(),onChange:w.getToggleSelectedHandler()})},{header:"example id",accessorKey:"id",cell:({getValue:w,row:K})=>{const I=K.original.id;return e(Qe,{to:`${I}`,children:w()})}},{header:"input",accessorKey:"input",cell:Fa},{header:"output",accessorKey:"output",cell:Fa},{header:"metadata",accessorKey:"metadata",cell:Fa}],data:y,state:{rowSelection:t},onRowSelectionChange:i,getCoreRowModel:De()}),f=g.getRowModel().rows,k=f.length===0,b=g.getSelectedRowModel().rows,S=b.map(w=>w.original),F=m.useCallback(()=>{i({})},[i]),P=m.useCallback(w=>{if(w){const{scrollHeight:K,scrollTop:I,clientHeight:E}=w;K-I-E<300&&!c&&d&&o(tS)}},[d,c,o]),D=se();return s("div",{css:T`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:l,onScroll:w=>P(w.target),children:[s("table",{css:Gn,children:[e("thead",{children:g.getHeaderGroups().map(w=>e("tr",{children:w.headers.map(K=>e("th",{children:e("div",{children:Z(K.column.columnDef.header,K.getContext())})},K.id))},w.id))}),k?e(rn,{}):e("tbody",{children:f.map(w=>e("tr",{onClick:()=>{D(`${w.original.id}`)},children:w.getVisibleCells().map(K=>e("td",{children:Z(K.column.columnDef.cell,K.getContext())},K.id))},w.id))})]}),b.length?e(lS,{selectedExamples:S,onClearSelection:F,onExamplesDeleted:()=>{p({},{fetchPolicy:"store-and-network"})}}):null]})}function a2(){const n=Ue();return s(H,{children:[e(iS,{dataset:n.dataset})," ",e(m.Suspense,{children:e(Oe,{})})]})}const Mc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},r=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"experimentsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"ExperimentsTableFragment"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"experimentsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:r,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experiments(first:100)"},{alias:null,args:r,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"91f92395f5df4858554b124deed3f47a",id:null,metadata:{},name:"experimentsLoaderQuery",operationKind:"query",text:`query experimentsLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      ...ExperimentsTableFragment
    }
  }
}

fragment ExperimentsTableFragment on Dataset {
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: 100) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        averageRunLatencyMs
        project {
          id
        }
        annotationSummaries {
          annotationName
          meanScore
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Mc.hash="1461484d9e1232cbb99e1251edabbec3";async function l2(n){const{datasetId:a}=n.params;return await x.fetchQuery(be,Mc,{id:a}).toPromise()}const Rc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"ExperimentsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:l,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[i],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"1db5ce5523fa9a472c91d093b0e6160e",id:null,metadata:{},name:"ExperimentsTableQuery",operationKind:"query",text:`query ExperimentsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExperimentsTableFragment_2HEEH6
    __isNode: __typename
    id
  }
}

fragment ExperimentsTableFragment_2HEEH6 on Dataset {
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: $first, after: $after) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        averageRunLatencyMs
        project {
          id
        }
        annotationSummaries {
          annotationName
          meanScore
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Rc.hash="c7c7580fe40888ceb86a1701fe4eedf4";const Ac=function(){var n=["experiments"],a={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Rc,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExperimentsTableFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:"experiments",args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"__ExperimentsTable_experiments_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},l],type:"Dataset",abstractKey:null}}();Ac.hash="c7c7580fe40888ceb86a1701fe4eedf4";function rS({getValue:n}){const a=n(),l=a!==null?a*100:null,t=m.useMemo(()=>{if(l!==null)return l>=80?"red-1100":l>0?"orange-1100":"green-1100"},[l]);return e(v,{color:t,children:tt(l)})}const Nc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ExperimentMutationPayload",kind:"LinkedField",name:"deleteExperiments",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a},params:{cacheID:"3af24cbaf3208c0d5ad1cd9313dd3823",id:null,metadata:{},name:"ExperimentSelectionToolbarDeleteExperimentsMutation",operationKind:"mutation",text:`mutation ExperimentSelectionToolbarDeleteExperimentsMutation(
  $input: DeleteExperimentsInput!
) {
  deleteExperiments(input: $input) {
    __typename
  }
}
`}}}();Nc.hash="4ab310746eb51c6a3fcb799d2c972762";function sS(n){const a=se(),[l,t]=m.useState(null),[i,r]=x.useMutation(Nc),{datasetId:o,selectedExperiments:d,onClearSelection:c,onExperimentsDeleted:p}=n,y=d.length!==1,u=Se(),g=Te(),f=m.useCallback(()=>{i({variables:{input:{experimentIds:d.map(b=>b.id)}},onCompleted:()=>{u({title:"Experiments Deleted",message:`${d.length} experiment${y?"s":""} have been deleted.`}),p(),c()},onError:b=>{const S=Pe(b);g({title:"An error occurred",message:`Failed to delete experiments: ${(S==null?void 0:S[0])??b.message}`})}})},[i,y,g,u,c,p,d]),k=m.useCallback(()=>{t(s(X,{size:"S",title:"Delete Experiments",children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete these experiments? This will also delete all associated annotations and traces, and it cannot be undone."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(M,{variant:"danger",onPress:()=>{f(),t(null)},children:"Delete Experiments"})})})]}))},[f]);return s("div",{css:T`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(C,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:s(h,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(v,{children:`${d.length} experiment${y?"s":""} selected`}),s(h,{direction:"row",gap:"size-100",children:[e(M,{variant:"default",size:"S",onPress:c,children:"Cancel"}),e(M,{variant:"danger",size:"S",leadingVisual:e(_,{svg:r?e(ln,{}):e(sn,{})}),isDisabled:r,onPress:k,children:r?"Deleting...":"Delete"}),e(M,{variant:"primary",size:"S",onPress:()=>{a(`/datasets/${o}/compare?${d.map(b=>`experimentId=${b.id}`).join("&")}`)},leadingVisual:e(_,{svg:e(tg,{})}),children:"Compare Experiments"})]})]})}),e(Y,{onDismiss:()=>{t(null)},children:l})]})}const oS=100;function dS(){return e("tbody",{className:"is-empty",children:e("tr",{children:s("td",{colSpan:100,css:T`
            text-align: center;
            padding: var(--ac-global-dimension-size-400) !important;
            button {
              margin-top: var(--ac-global-dimension-size-200);
              margin-left: auto;
              margin-right: auto;
            }
          `,children:["No experiments for this dataset. To see how to run experiments on a dataset, check out the documentation.",e(Dc,{})]})})})}function cS({dataset:n}){const a=m.useRef(null),[l,t]=m.useState({}),{data:i,loadNext:r,hasNext:o,isLoadingNext:d,refetch:c}=x.usePaginationFragment(Ac,n),p=m.useMemo(()=>i.experiments.edges.map(K=>{const I=K.experiment.annotationSummaries.reduce((E,V)=>(E[V.annotationName]=V,E),{});return{...K.experiment,annotationSummaryMap:I}}),[i.experiments.edges]),y=[{id:"select",header:({table:K})=>e(Qn,{checked:K.getIsAllRowsSelected(),indeterminate:K.getIsSomeRowsSelected(),onChange:K.getToggleAllRowsSelectedHandler()}),cell:({row:K})=>e(Qn,{checked:K.getIsSelected(),disabled:!K.getCanSelect(),indeterminate:K.getIsSomeSelected(),onChange:K.getToggleSelectedHandler()})},{header:"name",accessorKey:"name",minSize:200,cell:({getValue:K,row:I})=>{const E=I.original.id,V=I.original.sequenceNumber;return s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Ll,{sequenceNumber:V}),e(Qe,{to:`/datasets/${n.id}/compare?experimentId=${E}`,children:K()})]})}},{header:"description",accessorKey:"description",minSize:300,cell:Ke},{header:"created at",accessorKey:"createdAt",cell:Me}],u=i.experimentAnnotationSummaries.map(K=>{const{annotationName:I,minScore:E,maxScore:V}=K;return{header:()=>s(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",justifyContent:"end",children:[e(v,{children:I}),e(ig,{annotationName:I})]}),id:`annotation-${I}`,meta:{textAlign:"right"},cell:({row:Q})=>{const R=Q.original.annotationSummaryMap[I];return!R||R.meanScore==null?e("span",{css:T`
                  float: right;
                `,children:"--"}):e(uS,{annotationName:I,value:R.meanScore,min:E,max:V})}}}),g=[{header:"run count",accessorKey:"runCount",meta:{textAlign:"right"},cell:Lr},{header:"avg latency",accessorKey:"averageRunLatencyMs",meta:{textAlign:"right"},cell:({getValue:K})=>{const I=K();return I===null||typeof I!="number"?"--":e(Re,{latencyMs:I})}},{header:"error rate",accessorKey:"errorRate",meta:{textAlign:"right"},cell:rS},{header:"metadata",accessorKey:"metadata",minSize:200,cell:Fa},{id:"actions",cell:({row:K})=>{const I=K.original.project,E=K.original.metadata;return e(Nr,{projectId:(I==null?void 0:I.id)||null,experimentId:K.original.id,metadata:E})}}],f=xe({columns:[...y,...u,...g],data:p,getCoreRowModel:De(),state:{rowSelection:l},onRowSelectionChange:t}),k=f.getRowModel().rows,b=f.getSelectedRowModel().rows,S=b.map(K=>K.original),F=m.useCallback(()=>{t({})},[t]),P=k.length===0,D=m.useCallback(K=>{if(K){const{scrollHeight:I,scrollTop:E,clientHeight:V}=K;I-E-V<300&&!d&&o&&r(oS)}},[o,d,r]),w=se();return s("div",{css:T`
        flex: 1 1 auto;
        overflow: auto;
        width: table.getTotalSize();
      `,ref:a,onScroll:K=>D(K.target),children:[s("table",{css:Gn,children:[e("thead",{children:f.getHeaderGroups().map(K=>e("tr",{children:K.headers.map(I=>{var E,V;return e("th",{align:(V=(E=I.column.columnDef)==null?void 0:E.meta)==null?void 0:V.textAlign,children:e("div",{children:Z(I.column.columnDef.header,I.getContext())})},I.id)})},K.id))}),P?e(dS,{}):e("tbody",{children:k.map(K=>e("tr",{onClick:()=>{w(`/datasets/${n.id}/compare?experimentId=${K.original.id}`)},children:K.getVisibleCells().map(I=>e("td",{children:Z(I.column.columnDef.cell,I.getContext())},I.id))},K.id))})]}),b.length?e(sS,{datasetId:n.id,selectedExperiments:S,onClearSelection:F,onExperimentsDeleted:()=>{c({},{fetchPolicy:"store-and-network"})}}):null]})}function uS({annotationName:n,value:a,min:l,max:t}){const i=Dr(n),r=m.useMemo(()=>{const o=typeof l=="number"?l:0,d=typeof t=="number"?t:1;if(o===d&&d===a)return 100;const c=d-o||1;return(a-o)/c*100},[a,l,t]);return s(fe,{children:[e(qe,{children:s("div",{css:T`
            float: right;
            --mod-barloader-fill-color: ${i};
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: var(--ac-global-dimension-size-100);
          `,children:[Sa(a),e(pm,{width:"40px",value:r,"aria-label":"where the mean score lands between overall min max"})]})}),e(ma,{children:s(C,{width:"size-2400",children:[e(te,{level:3,weight:"heavy",children:n}),s(h,{direction:"column",children:[s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"Mean Score"}),e(v,{size:"XS",children:Sa(a)})]}),s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"All Experiments Min"}),e(v,{size:"XS",children:Sa(l)})]}),s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"All Experiments Max"}),e(v,{size:"XS",children:Sa(t)})]}),s(h,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"Mean Score Percentile"}),e(v,{size:"XS",children:_r(r)})]})]})]})})]})}function t2(){const n=Ue();return s(H,{children:[e(cS,{dataset:n.dataset}),e(m.Suspense,{children:e(Oe,{})})]})}const zc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"datasetId"},a={defaultValue:null,kind:"LocalArgument",name:"experimentIds"},l={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:"comparisons",args:[{kind:"Variable",name:"experimentIds",variableName:"experimentIds"},{kind:"Variable",name:"filterCondition",variableName:"filterCondition"}],concreteType:"ExperimentComparison",kind:"LinkedField",name:"compareExperiments",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[t,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RunComparisonItem",kind:"LinkedField",name:"runComparisonItems",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},i,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[t,r,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},d=[{kind:"Variable",name:"id",variableName:"datasetId"}],c={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,r,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"ExperimentCompareTableQuery",selections:[o,{alias:"dataset",args:d,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,l],kind:"Operation",name:"ExperimentCompareTableQuery",selections:[o,{alias:"dataset",args:d,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,c],storageKey:null}]},params:{cacheID:"2858d6862ebdeb9248578effd1944942",id:null,metadata:{},name:"ExperimentCompareTableQuery",operationKind:"query",text:`query ExperimentCompareTableQuery(
  $experimentIds: [GlobalID!]!
  $datasetId: GlobalID!
  $filterCondition: String
) {
  comparisons: compareExperiments(experimentIds: $experimentIds, filterCondition: $filterCondition) {
    example {
      id
      revision {
        input
        referenceOutput: output
      }
    }
    runComparisonItems {
      experimentId
      runs {
        output
        error
        startTime
        endTime
        trace {
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              score
              label
              annotatorKind
              explanation
              trace {
                traceId
                projectId
              }
            }
          }
        }
      }
    }
  }
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      experiments {
        edges {
          experiment: node {
            id
            name
            sequenceNumber
            metadata
            project {
              id
            }
          }
        }
      }
    }
  }
}
`}}}();zc.hash="3a013b01c738ae156d59ed0d0dcced72";const $c=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"condition"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"}],a=[{alias:null,args:[{kind:"Variable",name:"condition",variableName:"condition"},{kind:"Variable",name:"experimentIds",variableName:"experimentIds"}],concreteType:"ValidationResult",kind:"LinkedField",name:"validateExperimentRunFilterCondition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isValid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentRunFilterConditionFieldValidationQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentRunFilterConditionFieldValidationQuery",selections:a},params:{cacheID:"215d8f5d35b74d08ed0935cc97450385",id:null,metadata:{},name:"ExperimentRunFilterConditionFieldValidationQuery",operationKind:"query",text:`query ExperimentRunFilterConditionFieldValidationQuery(
  $condition: String!
  $experimentIds: [GlobalID!]!
) {
  validateExperimentRunFilterCondition(condition: $condition, experimentIds: $experimentIds) {
    isValid
    errorMessage
  }
}
`}}}();$c.hash="ebd42c04f1fa695bbd658ed88c167854";const Oc=m.createContext(null);function mS(){const n=m.useContext(Oc);if(n===null)throw new Error("useExperimentRunFilterCondition must be used within a ExperimentRunFilterConditionProvider");return n}function pS(n){const[a,l]=m.useState(""),t=m.useCallback(r=>{m.startTransition(()=>{l(r)})},[]),i=m.useCallback(r=>{m.startTransition(()=>{a.length>0?l(a+" and "+r):l(r)})},[a]);return e(Oc.Provider,{value:{filterCondition:a,setFilterCondition:t,appendFilterCondition:i},children:n.children})}const Qc=T`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,jc=T`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function gS(n){const a=n.matchBefore(/\w*/);return!a||a.from==a.to&&!n.explicit?null:{from:a.from,options:[{label:"input",type:"variable",info:"The input of the dataset example"},{label:"reference_output",type:"variable",info:"The reference output of the dataset example"},{label:"metadata",type:"variable",info:"The metadata of the dataset example"},{label:"output",type:"variable",info:"The output of the experiment run"},{label:"error",type:"variable",info:"The error message of the experiment run (if exists)"},{label:"latency_ms",type:"variable",info:"The duration of the experiment run in milliseconds"},{label:"evals",type:"variable",info:"The evaluations of the experiment run"},{label:"search input",type:"text",apply:"'' in input",detail:"macro"},{label:"search reference output",type:"text",apply:"'' in reference_output",detail:"macro"},{label:"search output",type:"text",apply:"'' in output",detail:"macro"},{label:"has error",type:"text",apply:"error is not None",detail:"macro"},{label:"Latency >= 10s",type:"text",apply:"latency_ms >= 10_000",detail:"macro"},{label:"Hallucinations",type:"text",apply:"evals['hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Metadata",type:"text",apply:"metadata['category'] == 'hard_examples'",detail:"macro"}]}}async function yS(n,a){if(!n)return{isValid:!0,errorMessage:null};const l=await Ja.fetchQuery(be,$c,{condition:n,experimentIds:a}).toPromise();if(!l)throw new Error("Filter condition validation is null");return l.validateExperimentRunFilterCondition}const fS=[At.of([{key:"Enter",run:n=>!0}]),Ya(),qr({override:[gS]})];function hS(n){const{onValidCondition:a,placeholder:l=`filter condition (e.g., evals["Hallucination"].label == 'hallucinated')`}=n,[t,i]=m.useState(!1),[r,o]=m.useState(""),{filterCondition:d,setFilterCondition:c,appendFilterCondition:p}=mS(),y=m.useDeferredValue(d),{theme:u}=En(),g=u==="dark"?Xn:void 0,[f]=hn(),k=f.getAll("experimentId");m.useEffect(()=>{yS(y,k).then(F=>{F!=null&&F.isValid?(o(""),m.startTransition(()=>{a(y)})):o((F==null?void 0:F.errorMessage)??"Invalid filter condition")})},[a,y,k]);const b=r!=="";return s("div",{"data-is-focused":t,"data-is-invalid":b,css:jc,children:[s(h,{direction:"row",children:[e(yt,{children:e(_,{svg:e(Mt,{})})}),e(Yn,{css:Qc,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>i(!0),onBlur:()=>i(!1),value:d,onChange:c,height:"36px",width:"100%",theme:g,placeholder:l,extensions:fS}),e("button",{css:T`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${d!==""?"visible":"hidden"};
          `,onClick:()=>c(""),className:"button--reset",children:e(_,{svg:e(_l,{})})}),s(ua,{placement:"bottom right",children:[e(qe,{children:e("button",{css:T`
                color: var(--ac-global-text-color-700);
                background-color: var(--ac-global-color-grey-400);
                padding-left: var(--ac-global-dimension-static-size-100);
                padding-right: var(--ac-global-dimension-static-size-100);
                height: 100%;
              `,className:"button--reset",children:e(_,{svg:e(bn,{})})})}),e(kS,{onAddFilterConditionSnippet:p})]})]}),s(fe,{isOpen:b&&t,placement:"bottom",children:[e(qe,{children:e("div",{})}),e(ma,{children:r!=""?e(v,{color:"danger",children:r}):e(v,{color:"success",children:"Valid Expression"})})]})]})}function kS(n){const{onAddFilterConditionSnippet:a}=n;return e(C,{width:"500px",paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",borderRadius:"medium",borderWidth:"thin",borderColor:"light",backgroundColor:"light",children:s(Xe,{children:[e(Rn,{label:"filter by substring",initialSnippet:"'search term' in output['key']",onAddFilterConditionSnippet:a},"substring"),e(Rn,{label:"filter on errors",initialSnippet:"error is not None",onAddFilterConditionSnippet:a},"errors"),e(Rn,{label:"filter by evaluation label",initialSnippet:"evals['hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"eval_label"),e(Rn,{label:"filter by evaluation score",initialSnippet:"evals['hallucination'].score >= 0.5",onAddFilterConditionSnippet:a},"eval_score"),e(Rn,{label:"filter by evaluation explanation",initialSnippet:"'search term' in evals['hallucination'].explanation",onAddFilterConditionSnippet:a},"eval_explanation"),e(Rn,{label:"filter for lower scores than first experiment",initialSnippet:"evals['hallucination'].score < experiments[0].evals['hallucination'].score",onAddFilterConditionSnippet:a},"compare_experiments"),e(Rn,{label:"filter by metadata",initialSnippet:"metadata['category'] == 'hard_examples'",onAddFilterConditionSnippet:a},"metadata"),e(Rn,{label:"filter by latency",initialSnippet:"latency_ms >= 10_000",onAddFilterConditionSnippet:a},"latency")]})})}function Rn(n){const{initialSnippet:a,onAddFilterConditionSnippet:l}=n,[t,i]=m.useState(a),{theme:r}=En(),o=r==="light"?void 0:Xn;return e(Bn,{label:n.label,children:s(h,{direction:"row",width:"100%",gap:"size-100",children:[e("div",{css:T(jc,T`
              flex: 1 1 auto;
            `),children:e(Yn,{value:t,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[Ya()],editable:!0,onChange:i,theme:o,css:Qc})}),e(M,{"aria-label":"Add to filter condition",variant:"default",onPress:()=>l(t),leadingVisual:e(_,{svg:e(bn,{})})})]})})}const et={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}},bS=T`
  flex: 1 1 auto;
  overflow: auto;
  // Make sure the table fills up the remaining space
  table {
    min-width: 100%;
    td {
      vertical-align: top;
    }
  }
`,SS=T`
  display: flex;
  flex-direction: row;
  align-items: center;
  color: var(--ac-global-color-primary);
  gap: var(--ac-global-dimension-size-50);
`;function vS(n){const{datasetId:a,experimentIds:l,displayFullText:t}=n,[i,r]=m.useState(""),o=x.useLazyLoadQuery(zc,{experimentIds:l,datasetId:a,filterCondition:i}),d=m.useMemo(()=>{var P,D;return((D=(P=o.dataset)==null?void 0:P.experiments)==null?void 0:D.edges.reduce((w,K)=>{var I,E;return w[K.experiment.id]={...K.experiment,projectId:((E=(I=K.experiment)==null?void 0:I.project)==null?void 0:E.id)||null},w},{}))||{}},[o]),c=m.useMemo(()=>o.comparisons.map(P=>{const D=P.runComparisonItems.reduce((w,K)=>(w[K.experimentId]=K,w),{});return{...P,id:P.example.id,input:P.example.revision.input,referenceOutput:P.example.revision.referenceOutput,runComparisonMap:D}}),[o]),[p,y]=m.useState(null),u=m.useMemo(()=>[{header:"input",accessorKey:"input",minWidth:500,cell:({row:P})=>e(gi,{controls:s(fe,{children:[e(M,{size:"S","aria-label":"View example details",leadingVisual:e(_,{svg:e(Ba,{})}),onPress:()=>{m.startTransition(()=>{y(e(m.Suspense,{children:e(Wt,{exampleId:P.original.example.id,onDismiss:()=>{y(null)}})}))})}}),e(Ve,{children:"View Example"})]}),children:e(ni,{children:e(Xa,{json:P.original.input,disableTitle:!0,space:t?2:0})})})},{header:"reference output",accessorKey:"referenceOutput",minWidth:500,cell:t?TS:Fa}],[t]),g=m.useMemo(()=>l.map(P=>({header:()=>{var E,V,Q,R;const D=(E=d[P])==null?void 0:E.name,w=(V=d[P])==null?void 0:V.metadata,K=(Q=d[P])==null?void 0:Q.projectId,I=((R=d[P])==null?void 0:R.sequenceNumber)||0;return s(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",justifyContent:"space-between",children:[s(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",children:[e(Ll,{sequenceNumber:I}),e(v,{children:D})]}),e(Nr,{experimentId:P,metadata:w,isQuiet:!0,projectId:K})]})},accessorKey:P,minSize:500,cell:({row:D})=>{var q,ee;const w=D.original.runComparisonMap[P],K=(w==null?void 0:w.runs.length)||0;if(K===0)return e(zi,{});if(K>1)return e(v,{color:"warning",children:`${K} runs`});const I=w==null?void 0:w.runs[0];let E=null;const V=(q=I==null?void 0:I.trace)==null?void 0:q.traceId,Q=(ee=I==null?void 0:I.trace)==null?void 0:ee.projectId;return V&&Q&&(E=s(fe,{children:[e(M,{variant:"default",className:"trace-button",size:"S","aria-label":"View run trace",leadingVisual:e(_,{svg:e(Fl,{})}),onPress:()=>{m.startTransition(()=>{y(e(Hc,{traceId:V,projectId:Q,title:"Experiment Run Trace"}))})}}),e(Ve,{children:"View Trace"})]})),I?e(gi,{controls:s(H,{children:[s(fe,{children:[e(M,{variant:"default",className:"expand-button",size:"S","aria-label":"View example run details",leadingVisual:e(_,{svg:e(Ba,{})}),onPress:()=>{m.startTransition(()=>{y(e(PS,{selectedExample:D.original,datasetId:a,experimentInfoById:d}))})}}),e(Ve,{children:"View run details"})]}),E]}),children:e(KS,{...I,displayFullText:t,setDialog:y})}):e(zi,{})}})),[l,d,a,t]),f=m.useMemo(()=>[...u,...g],[u,g]),k=xe({columns:f,data:c,getCoreRowModel:De(),columnResizeMode:"onChange"}),b=Ie.useMemo(()=>{const P=k.getFlatHeaders(),D={};for(let w=0;w<P.length;w++){const K=P[w];D[`--header-${K.id}-size`]=K.getSize(),D[`--col-${K.column.id}-size`]=K.column.getSize()}return D},[k.getState().columnSizingInfo,k.getState().columnSizing]),F=k.getRowModel().rows.length===0;return s(h,{direction:"column",height:"100%",children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:e(hS,{onValidCondition:r})}),s("div",{css:bS,children:[s("table",{css:T(tn,pr),style:{...b,width:k.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:k.getHeaderGroups().map(P=>e("tr",{children:P.headers.map(D=>s("th",{style:{width:`calc(var(--header-${D==null?void 0:D.id}-size) * 1px)`},children:[e("div",{children:Z(D.column.columnDef.header,D.getContext())}),e("div",{onMouseDown:D.getResizeHandler(),onTouchStart:D.getResizeHandler(),className:`resizer ${D.column.getIsResizing()?"isResizing":""}`})]},D.id))},P.id))}),F?e(rn,{}):k.getState().columnSizingInfo.isResizingColumn?e(CS,{table:k}):e(qc,{table:k})]}),e(Y,{isDismissable:!0,type:"slideOver",onDismiss:()=>{y(null)},children:p})]})]})}function qc({table:n}){return e("tbody",{children:n.getRowModel().rows.map(a=>e("tr",{children:a.getVisibleCells().map(l=>e("td",{style:{width:`calc(var(--col-${l.column.id}-size) * 1px)`,wordBreak:"break-all"},children:Z(l.column.columnDef.cell,l.getContext())},l.id))},a.id))})}const CS=Ie.memo(qc,(n,a)=>n.table.options.data===a.table.options.data);function FS(n){const{datasetId:a,exampleId:l}=n,t=se();return e("div",{onClick:i=>{i.preventDefault(),i.stopPropagation()},children:e(Hn,{buttonSize:"compact",align:"end",onAction:i=>{switch(i){case"gotoExample":return t(`/datasets/${a}/examples/${l}`);default:ke()}},children:e(de,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(_,{svg:e(sg,{})}),e(v,{children:"Go to example"})]})},"gotoExample")})})}function KS(n){const{output:a,error:l,startTime:t,endTime:i,annotations:r,displayFullText:o,setDialog:d}=n;if(l)return e(Uc,{error:l});const c=r!=null&&r.edges.length?r.edges.map(p=>p.annotation):[];return s(h,{direction:"column",gap:"size-100",height:"100%",justifyContent:"space-between",children:[e(ni,{children:e(Xa,{json:a,disableTitle:!0,space:o?2:0})}),s("ul",{css:T`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-static-size-100);
          align-items: center;
          flex-wrap: wrap;
        `,children:[e("li",{children:e(Bc,{startTime:t,endTime:i})},"run-latency"),c.map(p=>e("li",{children:e(Da,{annotation:p,extra:p.trace&&e(C,{paddingTop:"size-100",children:s("div",{css:SS,children:[e(_,{svg:e(xn,{})}),e("span",{children:"Click to view evaluator trace"})]})}),children:e(wn,{annotation:p,onClick:()=>{const y=p.trace;y&&m.startTransition(()=>{d(e(Hc,{traceId:y.traceId,projectId:y.projectId,title:`Evaluator Trace: ${p.name}`}))})}})})},p.id))]})]})}function Uc({error:n}){return s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(_,{svg:e(Ft,{}),color:"danger"}),e(v,{color:"danger",children:n})]})}function Bc({startTime:n,endTime:a}){const l=m.useMemo(()=>{let t=null;return n&&a&&(t=new Date(a).getTime()-new Date(n).getTime()),t},[n,a]);return l===null?null:e(Re,{latencyMs:l})}function zi(){return s(h,{direction:"row",gap:"size-50",children:[e(_,{svg:e(rg,{}),color:"grey-800"}),e(v,{color:"text-700",children:"not run"})]})}function TS({getValue:n}){const a=n();return e(ni,{children:e(Xa,{json:a,space:2})})}function ni({children:n}){return e("div",{css:T`
        max-height: 300px;
        overflow-y: auto;
      `,children:n})}function PS({selectedExample:n,datasetId:a,experimentInfoById:l}){return e(X,{title:`Comparing Experiments for Example: ${n.id}`,size:"fullscreen",extra:e(FS,{datasetId:a,exampleId:n.id}),children:s(Pn,{direction:"vertical",autoSaveId:"example-compare-panel-group",children:[e(Le,{defaultSize:35,children:e("div",{css:T`
              overflow-y: auto;
              height: 100%;
            `,children:e(C,{overflow:"hidden",padding:"size-200",children:s(h,{direction:"row",gap:"size-200",flex:"1 1 auto",children:[e(C,{width:"50%",children:e(O,{title:"Input",...et,bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},extra:e(re,{text:JSON.stringify(n.input)}),children:e(Je,{value:JSON.stringify(n.input,null,2)})})}),e(C,{width:"50%",children:e(O,{title:"Reference Output",...et,extra:e(re,{text:JSON.stringify(n.referenceOutput)}),bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},children:e(Je,{value:JSON.stringify(n.referenceOutput,null,2)})})})]})})})}),e(Tn,{css:Wn}),e(Le,{defaultSize:65,children:s(h,{direction:"column",height:"100%",children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(te,{level:2,children:"Experiments"})}),e("div",{css:T`
                overflow-y: auto;
                height: 100%;
                padding: var(--ac-global-dimension-static-size-200);
              `,children:e("ul",{css:T`
                  display: flex;
                  flex-direction: column;
                  gap: var(--ac-global-dimension-static-size-200);
                `,children:n.runComparisonItems.map(t=>{const i=l[t.experimentId];return e("li",{children:e(O,{...et,title:i==null?void 0:i.name,titleExtra:e(Ll,{sequenceNumber:(i==null?void 0:i.sequenceNumber)||0}),children:e("ul",{children:t.runs.map((r,o)=>{var d;return e("li",{children:s(h,{direction:"row",children:[e(C,{flex:!0,children:r.error?e(C,{padding:"size-200",children:e(Uc,{error:r.error})}):e(Je,{value:JSON.stringify(r.output,null,2)})}),s(ia,{width:"size-3000",children:[e(Bc,{startTime:r.startTime,endTime:r.endTime}),e("ul",{css:T`
                                      margin-top: var(
                                        --ac-global-dimension-static-size-100
                                      );
                                      display: flex;
                                      flex-direction: column;
                                      justify-content: flex-start;
                                      align-items: flex-end;
                                      gap: var(
                                        --ac-global-dimension-static-size-100
                                      );
                                    `,children:(d=r.annotations)==null?void 0:d.edges.map(c=>e("li",{children:e(wn,{annotation:c.annotation})},c.annotation.id))})]})]})},o)})})})},t.experimentId)})})})]})})]})})}function Hc({traceId:n,projectId:a,title:l}){const t=se();return e(X,{title:l,size:"fullscreen",extra:e(M,{onPress:()=>t(`/projects/${a}/traces/${n}`),children:"View Trace in Project"}),children:e(Zt,{traceId:n,projectId:a})})}const Gc={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExperimentMultiSelector__experiments",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null};Gc.hash="1aa376b1e9425f49268ac231dc2c0412";function IS(n){const{dataset:a,selectedExperimentIds:l,onChange:t,label:i,validationState:r,description:o,errorMessage:d,...c}=n,p=x.useFragment(Gc,a),y=m.useMemo(()=>p.experiments.edges.map(f=>f.experiment),[p]),u=y.length===0,g=m.useMemo(()=>{if(u)return"No experiments";const f=l.length;return f>0?`${f} experiment${f>1?"s":""}`:"No experiments selected"},[l,u]);return e(Bn,{label:i,isDisabled:u,validationState:r,description:o,errorMessage:d,children:e(ft,{isDisabled:u,...c,menu:e(hl,{selectionMode:"multiple",onSelectionChange:f=>{t(Array.from(f))},selectedKeys:new Set(l),children:y.map(f=>e(de,{textValue:f.name,children:s(h,{direction:"column",gap:"size-50",children:[s(h,{direction:"row",gap:"size-100",children:[e(Ll,{sequenceNumber:f.sequenceNumber}),e(v,{children:f.name})]}),e(v,{size:"XS",color:"text-700",children:new Date(f.createdAt).toLocaleString()})]})},f.id))}),triggerProps:{placement:"bottom start"},children:g})})}function i2(){const n=Ue(),[a,l]=m.useState(!1),[t,i]=hn(),r=t.getAll("experimentId"),o=r.length>0;return s("main",{css:T`
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(C,{padding:"size-200",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:s(h,{direction:"column",gap:"size-100",children:[e(te,{level:1,children:"Compare Experiments"}),s(h,{direction:"row",justifyContent:"space-between",alignItems:"end",children:[e(IS,{dataset:n.dataset,selectedExperimentIds:r,label:"experiments",onChange:d=>{m.startTransition(()=>{t.delete("experimentId"),d.forEach(c=>{t.append("experimentId",c)}),i(t)})}}),e(xa,{onChange:d=>{l(d)},defaultSelected:!1,labelPlacement:"start",children:"Full Text"})]})]})}),o?e(pS,{children:e(m.Suspense,{fallback:e(Ce,{}),children:e(vS,{datasetId:n.dataset.id,experimentIds:r,displayFullText:a})})}):e(C,{padding:"size-200",children:e(ye,{variant:"info",title:"No Experiment Selected",children:"Please select one or more experiments."})})]})}const Wc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"experimentCompareLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[t,{args:null,kind:"FragmentSpread",name:"ExperimentMultiSelector__experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"experimentCompareLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[t,{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"7e89f99f940098a21985137aae870de7",id:null,metadata:{},name:"experimentCompareLoaderQuery",operationKind:"query",text:`query experimentCompareLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      name
      ...ExperimentMultiSelector__experiments
    }
  }
}

fragment ExperimentMultiSelector__experiments on Dataset {
  experiments {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        createdAt
      }
    }
  }
}
`}}}();Wc.hash="fa02088830fd16688f0f2fba9a0009eb";async function r2(n){const{datasetId:a}=n.params;return await x.fetchQuery(be,Wc,{id:a}).toPromise()}const Jc=function(){var n={defaultValue:null,kind:"LocalArgument",name:"description"},a={defaultValue:null,kind:"LocalArgument",name:"expiresAt"},l={defaultValue:null,kind:"LocalArgument",name:"name"},t=[{fields:[{kind:"Variable",name:"description",variableName:"description"},{kind:"Variable",name:"expiresAt",variableName:"expiresAt"},{kind:"Variable",name:"name",variableName:"name"}],kind:"ObjectValue",name:"input"}],i={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[r],storageKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:t,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],storageKey:null},o],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,n,a],kind:"Operation",name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:t,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],storageKey:null},o],storageKey:null}]},params:{cacheID:"799e8f0a627c6ae06e2a87c051d299d0",id:null,metadata:{},name:"APIKeysCardCreateSystemAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysCardCreateSystemAPIKeyMutation(
  $name: String!
  $description: String = null
  $expiresAt: DateTime = null
) {
  createSystemApiKey(input: {name: $name, description: $description, expiresAt: $expiresAt}) {
    jwt
    query {
      ...SystemAPIKeysTableFragment
    }
    apiKey {
      id
    }
  }
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}
`}}}();Jc.hash="a6f84fa9e14f363d2e7317d3d6507590";const Zc=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"APIKeysCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"},{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"APIKeysCardQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[n,a,l,t,i],storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[n,a,l,t,i,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"a8cfba9eaaac34bc497efaacbff45c05",id:null,metadata:{},name:"APIKeysCardQuery",operationKind:"query",text:`query APIKeysCardQuery {
  ...SystemAPIKeysTableFragment
  ...UserAPIKeysTableFragment
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}}}();Zc.hash="ad967afd45af0d5976982c70eaadb330";const Xc=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteSystemApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"a8c45c42b5becca8efa65334285a2f97",id:null,metadata:{},name:"SystemAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation SystemAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteSystemApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}}();Xc.hash="55ab8200b5bfda0aa73594ad5cfce96f";const Yc={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SystemAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SystemAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}]},params:{cacheID:"94e06b8cd5879701a5d73bee083ad614",id:null,metadata:{},name:"SystemAPIKeysTableQuery",operationKind:"query",text:`query SystemAPIKeysTableQuery {
  ...SystemAPIKeysTableFragment
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}
`}};Yc.hash="de0fc04de739f0adfcbdeaff28b16265";const eu={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:Yc}},name:"SystemAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};eu.hash="de0fc04de739f0adfcbdeaff28b16265";function xS({query:n}){const[a,l]=x.useRefetchableFragment(eu,n),t=Te(),i=Se(),[r]=x.useMutation(Xc),o=m.useCallback(g=>{r({variables:{input:{id:g}},onCompleted:()=>{i({title:"System key deleted",message:"The system key has been deleted and is no longer active."}),m.startTransition(()=>{l({},{fetchPolicy:"network-only"})})},onError:f=>{const k=Pe(f);t({title:"Error deleting system key",message:(k==null?void 0:k[0])??f.message})}})},[r,t,i,l]),d=m.useMemo(()=>[...a.systemApiKeys],[a]),c=m.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:Ke},{header:"Created At",accessorKey:"createdAt",cell:Me},{header:"Expires At",accessorKey:"expiresAt",cell:Me},{header:"",accessorKey:"id",size:10,cell:({row:f})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(Rt,{handleDelete:()=>{o(f.original.id)}})}),meta:{textAlign:"right"}}],[o]),p=xe({columns:c,data:d,getCoreRowModel:De()}),y=p.getRowModel().rows,u=p.getRowModel().rows.length===0;return s("table",{css:tn,children:[e("thead",{children:p.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(f=>e("th",{colSpan:f.colSpan,children:f.isPlaceholder?null:s("div",{className:f.column.getCanSort()?"cursor-pointer":"",onClick:f.column.getToggleSortingHandler(),style:{left:f.getStart(),width:f.getSize()},children:[Z(f.column.columnDef.header,f.getContext()),f.column.getIsSorted()?e(_,{className:"sort-icon",svg:f.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]})},f.id))},g.id))}),u?e(rn,{message:"No Keys"}):e("tbody",{children:y.map(g=>e("tr",{children:g.getVisibleCells().map(f=>e("td",{children:Z(f.column.columnDef.cell,f.getContext())},f.id))},g.id))})]})}const nu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"d137498515ff43864f5525b3c1847376",id:null,metadata:{},name:"UserAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation UserAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}}();nu.hash="9b1d898d1d9858016bed85000ce3906e";const au={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UserAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"e70d413b072841dff8565a332590a549",id:null,metadata:{},name:"UserAPIKeysTableQuery",operationKind:"query",text:`query UserAPIKeysTableQuery {
  ...UserAPIKeysTableFragment
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}};au.hash="c2b3a579bcb0ba915523ecb35cae3b44";const lu={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:au}},name:"UserAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};lu.hash="c2b3a579bcb0ba915523ecb35cae3b44";const $i=70;function DS({query:n}){const[a,l]=x.useRefetchableFragment(lu,n),t=Te(),i=Se(),[r]=x.useMutation(nu),o=m.useCallback(g=>{r({variables:{input:{id:g}},onCompleted:()=>{i({title:"User key deleted",message:"The user key has been deleted and is no longer active."}),m.startTransition(()=>{l({},{fetchPolicy:"network-only"})})},onError:f=>{const k=Pe(f);t({title:"Error deleting user key",message:(k==null?void 0:k[0])??f.message})}})},[r,t,i,l]),d=m.useMemo(()=>[...a.userApiKeys],[a]),c=m.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:Ke},{header:"Description",accessorKey:"description",cell:Ke},{header:"Created At",accessorKey:"createdAt",size:$i,cell:Me},{header:"Expires At",accessorKey:"expiresAt",size:$i,cell:Me},{header:"User",size:120,accessorKey:"user.email",cell:Ke},{header:"",accessorKey:"id",size:10,cell:({row:f})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(Rt,{handleDelete:()=>{o(f.original.id)}})}),meta:{textAlign:"right"}}],[o]),p=xe({columns:c,data:d,getCoreRowModel:De()}),y=p.getRowModel().rows,u=p.getRowModel().rows.length===0;return s("table",{css:tn,children:[e("thead",{children:p.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(f=>e("th",{colSpan:f.colSpan,children:f.isPlaceholder?null:s("div",{className:f.column.getCanSort()?"cursor-pointer":"",onClick:f.column.getToggleSortingHandler(),style:{left:f.getStart(),width:f.getSize()},children:[Z(f.column.columnDef.header,f.getContext()),f.column.getIsSorted()?e(_,{className:"sort-icon",svg:f.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]})},f.id))},g.id))}),u?e(rn,{message:"No Keys"}):e("tbody",{children:y.map(g=>e("tr",{children:g.getVisibleCells().map(f=>e("td",{children:Z(f.column.columnDef.cell,f.getContext())},f.id))},g.id))})]})}function _S(){const n=x.useLazyLoadQuery(Zc,{},{fetchPolicy:"network-only"});return s(He,{children:[e(ne,{title:"System Keys",name:"System Keys",children:e(xS,{query:n})}),e(ne,{title:"User Keys",name:"User Keys",children:e(DS,{query:n})})]})}function LS(){const[n,a]=m.useState(null),l=Te(),t=c=>{a(e(zr,{jwt:c}))},[i,r]=x.useMutation(Jc),o=m.useCallback(c=>{var p;i({variables:{...c,expiresAt:((p=c.expiresAt)==null?void 0:p.toDate(ut()).toISOString())||null},onCompleted:y=>{t(y.createSystemApiKey.jwt)},onError:y=>{l({title:"Error creating system key",message:y.message})}})},[i,l]);return s("div",{children:[e(pt,{title:"API Keys",variant:"compact",extra:e(M,{size:"S",leadingVisual:e(_,{svg:e(bn,{})}),onPress:()=>{a(e($r,{onSubmit:o,isCommitting:r,defaultName:"System"}))},children:"System Key"}),children:e(m.Suspense,{fallback:e(C,{padding:"size-100",children:e(Ce,{})}),children:e(_S,{})})}),e(Y,{onDismiss:()=>{a(null)},children:n})]})}const tu={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"GenerativeProvidersCard_data",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyEnvVar",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeySet",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};tu.hash="0168d590171b96e7a2e41449a41754be";function wS({query:n}){const[a,l]=m.useState(null),t=Pa(y=>y),i=Pa(y=>y.setCredential),r=x.useFragment(tu,n),o=m.useMemo(()=>[...r.modelProviders],[r]),d=m.useMemo(()=>[{header:"Name",accessorKey:"name",cell:({row:y})=>s(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(_t,{provider:y.original.key,height:18}),y.original.name]})},{header:"Environment Variable",accessorKey:"apiKeyEnvVar",cell:({row:y})=>e(v,{children:y.original.apiKeyEnvVar})},{header:"configuration",accessorKey:"apiKeySet",cell:({row:y})=>y.original.dependenciesInstalled?t[y.original.key]?e(v,{color:"success",children:"local"}):y.original.apiKeySet?e(v,{color:"success",children:"configured on the server"}):e(v,{color:"text-700",children:"not configured"}):e(v,{color:"warning",children:"missing dependencies"})},{header:"",accessorKey:"id",cell:({row:y})=>e(h,{direction:"row",justifyContent:"end",gap:"size-100",width:"100%",children:e(M,{size:"S",leadingVisual:e(_,{svg:e(Cl,{})}),onPress:()=>{l(y.original)}})})}],[t]),c=xe({columns:d,data:o,getCoreRowModel:De(),getSortedRowModel:kn()}),p=c.getRowModel().rows;return s(O,{title:"AI Providers",bodyStyle:{padding:0},variant:"compact",children:[s("table",{css:tn,children:[e("thead",{children:c.getHeaderGroups().map(y=>e("tr",{children:y.headers.map(u=>e("th",{colSpan:u.colSpan,children:u.isPlaceholder?null:e("div",{children:Z(u.column.columnDef.header,u.getContext())})},u.id))},y.id))}),e("tbody",{children:p.map(y=>e("tr",{children:y.getVisibleCells().map(u=>e("td",{children:Z(u.column.columnDef.cell,u.getContext())},u.id))},y.id))})]}),e(Y,{type:"modal",isDismissable:!0,onDismiss:()=>l(null),children:a&&s(X,{title:`Set ${a.name} API Key`,size:"S",children:[s(C,{padding:"size-200",children:[e(C,{paddingBottom:"size-100",children:s(v,{size:"XS",children:["Set the credentials for the ",a.name," API. These credentials will be stored entirely in your browser and will only be sent to the server during API requests."]})}),s(J,{onChange:y=>{i({provider:a.key,value:y})},value:t[a.key],type:"password",children:[e(W,{children:`${a.name} API Key`}),e(ae,{placeholder:`e.g. ${a.apiKeyEnvVar}`}),e(v,{slot:"description",children:"The API key will be stored locally in your browser"})]})]}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"light",children:e(h,{direction:"row",justifyContent:"end",gap:"size-100",children:e(M,{variant:"primary",size:"S",onPress:()=>{l(null)},children:"Set API Key"})})})]})})]})}const iu={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsersCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UsersCardQuery",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"926faf98cad4bc437a919677347e277c",id:null,metadata:{},name:"UsersCardQuery",operationKind:"query",text:`query UsersCardQuery {
  ...UsersTable_users
}

fragment UsersTable_users on Query {
  users {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
        }
      }
    }
  }
}
`}};iu.hash="2b3e260c950dd1a6a1a6883ff6fb78c4";const ru=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"createUser",plural:!1,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"NewUserDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"NewUserDialogMutation",selections:a},params:{cacheID:"a9bf3794a5355d9d0e0a3acebe7f3809",id:null,metadata:{},name:"NewUserDialogMutation",operationKind:"mutation",text:`mutation NewUserDialogMutation(
  $input: CreateUserInput!
) {
  createUser(input: $input) {
    user {
      id
      email
    }
  }
}
`}}}();ru.hash="97d1aefa41e8831e57b6bb0d1a078a7c";function ES({onNewUserCreated:n,onNewUserCreationError:a,onDismiss:l}){const[t,i]=x.useMutation(ru),r=m.useCallback(o=>{t({variables:{input:{email:o.email,username:o.username,password:o.password,role:o.role}},onCompleted:d=>{n(d.createUser.user.email)},onError:d=>{a(d)}})},[t,n,a]);return e(Y,{onDismiss:l,isDismissable:!0,type:"modal",isKeyboardDismissDisabled:!0,children:e(X,{title:"Add user",children:e(og,{onSubmit:r,isSubmitting:i})})})}const su={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsersTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UsersTableQuery",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"d3f85064b63f026a47a8ef139638b933",id:null,metadata:{},name:"UsersTableQuery",operationKind:"query",text:`query UsersTableQuery {
  ...UsersTable_users
}

fragment UsersTable_users on Query {
  users {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
        }
      }
    }
  }
}
`}};su.hash="acd5e44c43deb927fea733697593c97d";const ou={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:su}},name:"UsersTable_users",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};ou.hash="acd5e44c43deb927fea733697593c97d";const du=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],kind:"ScalarField",name:"deleteUsers",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeleteUserDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeleteUserDialogMutation",selections:a},params:{cacheID:"00d3d0f3855e92e529bc446d0f426123",id:null,metadata:{},name:"DeleteUserDialogMutation",operationKind:"mutation",text:`mutation DeleteUserDialogMutation(
  $input: DeleteUsersInput!
) {
  deleteUsers(input: $input)
}
`}}}();du.hash="a718ceab0ec0a7d461f6cd5e5b178a1f";function VS({userId:n,onDeleted:a,onClose:l}){const[t,i]=x.useMutation(du),r=Se(),o=Te(),d=m.useCallback(()=>{t({variables:{input:{userIds:[n]}},onCompleted:()=>{r({title:"User deleted",message:"User has been deleted."}),a(),l()},onError:c=>{const p=Pe(c);o({title:"Failed to delete user",message:(p==null?void 0:p[0])??c.message})}})},[t,o,r,l,a,n]);return s(X,{title:"Delete User",isDismissable:!0,onDismiss:l,children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete this user? This action cannot be undone."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{variant:"default",onPress:l,children:"Cancel"}),e(M,{variant:"danger",onPress:()=>{d()},isDisabled:i,children:"Delete user"})]})})]})}const cu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordDialogMutation",selections:a},params:{cacheID:"6ccff8dd53d97eeb41f656bcd2758da1",id:null,metadata:{},name:"ResetPasswordDialogMutation",operationKind:"mutation",text:`mutation ResetPasswordDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    __typename
  }
}
`}}}();cu.hash="85b22da61ec094c28e97db2759622b69";const za=4;function MS({userId:n,onClose:a}){const l=Te(),t=Se(),[i,r]=x.useMutation(cu),{control:o,handleSubmit:d,formState:{isDirty:c}}=Ae({defaultValues:{newPassword:"",confirmPassword:""}}),p=m.useCallback(y=>{i({variables:{input:{userId:n,newPassword:y.newPassword}},onCompleted:()=>{t({title:"Password reset",message:"Users password has been reset."}),a()},onError:u=>{l({title:"Failed to reset password",message:u.message})}})},[i,l,t,a,n]);return e(X,{title:"Reset Password",isDismissable:!0,onDismiss:a,children:e(Xe,{children:s(C,{padding:"size-200",children:[s(h,{direction:"column",gap:"size-100",children:[e(G,{name:"newPassword",control:o,rules:{required:"Password is required",minLength:{value:za,message:`Password must be at least ${za} characters`}},render:({field:{name:y,onChange:u,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{isInvalid:k,onChange:u,name:y,onBlur:g,value:f.toString(),type:"password",id:"new-password",autoComplete:"new-password",children:[e(W,{children:"New Password"}),e(ae,{placeholder:"New password"}),b!=null&&b.message?e(Fe,{children:b.message}):s(v,{slot:"description",children:["Password must be at least ",za," characters"]})]})}),e(G,{name:"confirmPassword",control:o,rules:{required:"Password is required",minLength:{value:za,message:`Password must be at least ${za} characters`},validate:(y,u)=>y===u.newPassword||"Passwords do not match"},render:({field:{name:y,onChange:u,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{isInvalid:k,onChange:u,name:y,onBlur:g,value:f.toString(),type:"password",children:[e(W,{children:"Confirm Password"}),e(ae,{placeholder:"Repeat new password"}),b!=null&&b.message?e(Fe,{children:b.message}):e(v,{slot:"description",children:"Repeat new password to confirm"})]})})]}),e(C,{paddingTop:"size-200",children:e(h,{direction:"row",gap:"size-100",justifyContent:"end",children:e(M,{variant:c?"primary":"default",type:"submit",isDisabled:r,onPress:()=>d(p)(),children:r?"Resetting...":"Reset Password"})})})]})})})}function RS(n){return n==="LOCAL"}function AS(n){const{userId:a,onUserDeleted:l,authMethod:t}=n,[i,r]=m.useState(null),o=m.useCallback(()=>{r(e(VS,{userId:a,onClose:()=>r(null),onDeleted:()=>{l(),r(null)}}))},[a,l]),d=m.useCallback(()=>{r(e(MS,{userId:a,onClose:()=>r(null)}))},[a]),c=m.useMemo(()=>{const p=e(de,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(_,{svg:e(sn,{})}),e(H,{children:"Delete"})]})},"deleteUser"),y=e(de,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(_,{svg:e(Rr,{})}),e(H,{children:"Reset Password"})]})},"resetPassword"),u=[p];return RS(t)&&u.push(y),u},[t]);return s("div",{onClick:p=>{p.preventDefault(),p.stopPropagation()},children:[e(Hn,{align:"end","aria-label":"User Actions",buttonSize:"compact",onAction:p=>{switch(p){case"deleteUser":o();break;case"resetPassword":d();break}},children:c}),e(Y,{type:"modal",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const uu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserRoleChangeDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserRoleChangeDialogMutation",selections:a},params:{cacheID:"44e970c967f83a0b7a6bd1cbafc3a936",id:null,metadata:{},name:"UserRoleChangeDialogMutation",operationKind:"mutation",text:`mutation UserRoleChangeDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    __typename
  }
}
`}}}();uu.hash="468eff05b42e39b55f9aa5b9a7d2c483";function NS({userId:n,email:a,currentRole:l,newRole:t,onRoleChanged:i,onClose:r}){const[o,d]=x.useMutation(uu),c=Se(),p=Te(),y=m.useCallback(()=>{o({variables:{input:{userId:n,newRole:t}},onCompleted:()=>{c({title:"Role Changed",message:"Users role has been changed."}),i(),r()},onError:u=>{p({title:"Failed to delete user",message:u.message})}})},[o,t,p,c,r,i,n]);return s(X,{title:"Confirm role change",children:[e(C,{padding:"size-200",children:s(v,{children:[`Are you sure you want to change the role for ${a} from `," ",e("b",{children:rt(l)})," to"," ",e("b",{children:rt(t)}),"?"]})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{onPress:r,size:"S",children:"Cancel"}),e(M,{variant:"primary",size:"S",onPress:()=>{y()},isDisabled:d,children:"Change role"})]})})]})}const zS=55,$S=T`
  text-decoration: none;
  color: var(--ac-global-color-grey-600);
  font-size: 12px;
  &:hover {
    text-decoration: underline;
  }
`,OS=T`
  height: ${zS}px;
`,Oi=n=>n.email==="admin@localhost"||n.username==="admin";function QS({query:n}){const[a,l]=m.useState(null),[t,i]=x.useRefetchableFragment(ou,n),r=m.useMemo(()=>t.users.edges.map(({user:u})=>({id:u.id,email:u.email,username:u.username,profilePictureUrl:u.profilePictureUrl,createdAt:u.createdAt,role:u.role.name,authMethod:u.authMethod})),[t]),o=m.useCallback(()=>{m.startTransition(()=>{i({},{fetchPolicy:"network-only"})})},[i]),d=m.useMemo(()=>[{header:"user",accessorKey:"username",cell:({row:u})=>s(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(vt,{name:u.original.username,profilePictureUrl:u.original.profilePictureUrl,size:20}),e("span",{children:u.original.username}),e("a",{href:`mailto:${u.original.email}`,css:$S,children:u.original.email})]})},{header:"method",accessorKey:"authMethod",size:10,cell:({row:u})=>u.original.authMethod.toLowerCase()},{header:"role",accessorKey:"role",cell:({row:u})=>Oi(u.original)?rt(u.original.role):e(cg,{includeLabel:!1,onChange:g=>{g!==u.original.role&&l(e(NS,{onClose:()=>l(null),onRoleChanged:o,currentRole:u.original.role,newRole:g,email:u.original.email,userId:u.original.id}))},role:dg(u.original.role)?u.original.role:void 0})},{header:"created at",accessorKey:"createdAt",cell:Me},{header:"",accessorKey:"id",size:10,cell:({row:u})=>Oi(u.original)?null:e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(AS,{userId:u.original.id,onUserDeleted:o,authMethod:u.original.authMethod})}),meta:{textAlign:"right"}}],[o]),c=xe({columns:d,data:r,getCoreRowModel:De(),getSortedRowModel:kn()}),p=c.getRowModel().rows,y=c.getRowModel().rows.length===0;return s("table",{css:tn,children:[e("thead",{children:c.getHeaderGroups().map(u=>e("tr",{children:u.headers.map(g=>e("th",{colSpan:g.colSpan,children:g.isPlaceholder?null:s("div",{className:g.column.getCanSort()?"cursor-pointer":"",onClick:g.column.getToggleSortingHandler(),style:{left:g.getStart(),width:g.getSize()},children:[Z(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(_,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]})},g.id))},u.id))}),y?e(rn,{}):e("tbody",{children:p.map(u=>e("tr",{css:OS,children:u.getVisibleCells().map(g=>e("td",{children:Z(g.column.columnDef.cell,g.getContext())},g.id))},u.id))}),e(Y,{onDismiss:()=>l(null),isDismissable:!0,type:"modal",children:a})]})}function jS(){const[n,a]=m.useState(0),[l,t]=m.useState(null),i=Se(),r=Te(),o=x.useLazyLoadQuery(iu,{},{fetchKey:n,fetchPolicy:"store-and-network"});return s(O,{title:"Users",variant:"compact",bodyStyle:{padding:0,overflowX:"auto"},extra:e(M,{onPress:()=>{t(e(ES,{onDismiss:()=>{t(null)},onNewUserCreated:d=>{t(null),i({title:"User added",message:`User ${d} has been added.`}),a(c=>c+1)},onNewUserCreationError:d=>{const c=Pe(d);r({title:"Error adding user",message:(c==null?void 0:c[0])??d.message})}}))},size:"S",leadingVisual:e(_,{svg:e(bn,{})}),children:"Add User"}),children:[e(m.Suspense,{fallback:e(C,{padding:"size-200",children:e(Ce,{})}),children:e(QS,{query:o})}),e(Y,{onDismiss:()=>{t(null)},children:l})]})}const qS=T`
  overflow-y: auto;
`,US=T`
  padding: var(--ac-global-dimension-size-400);
  max-width: 1000px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`,BS=T`
  .ac-field {
    // Hacky solution to make the text fields fill the remaining space
    width: calc(100% - var(--ac-global-dimension-size-600));
  }
`;function s2(){const n=Ue();return e("main",{css:qS,children:e("div",{css:US,children:s(h,{direction:"column",gap:"size-200",width:"100%",children:[e(O,{title:"Platform Settings",variant:"compact",children:s("form",{css:BS,children:[s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{value:it,isReadOnly:!0,children:[e(W,{children:"Hostname"}),e(ae,{}),e(v,{slot:"description",children:"Connect to Phoenix over HTTP"})]}),e(nt,{text:it})]}),s(h,{direction:"row",gap:"size-100",alignItems:"end",children:[s(J,{value:il,isReadOnly:!0,children:[e(W,{children:"Platform Version"}),e(ae,{}),e(v,{slot:"description",children:"The version of the Phoenix server"})]}),e(nt,{text:il})]}),s(h,{direction:"row",gap:"size-100",alignItems:"end",justifyContent:"center",children:[s(J,{value:`pip install 'arize-phoenix==${il}'`,isReadOnly:!0,children:[e(W,{children:"Python Version"}),e(ae,{}),e(v,{slot:"description",children:"The version of the Python client library to use to connect to this Phoenix"})]}),e(nt,{text:il})]})]})}),e(Ar,{children:s(H,{children:[e(LS,{}),e(jS,{})]})}),e(wS,{query:n})]})})})}function nt(n){return e(C,{paddingBottom:"19px",flex:"none",children:e(re,{text:n.text,size:"M"})})}const mu={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"GenerativeProvidersCard_data"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsPageLoaderQuery",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyEnvVar",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeySet",storageKey:null}],storageKey:null}]},params:{cacheID:"bc46c0b83314efc75f5723890a95ca29",id:null,metadata:{},name:"settingsPageLoaderQuery",operationKind:"query",text:`query settingsPageLoaderQuery {
  ...GenerativeProvidersCard_data
}

fragment GenerativeProvidersCard_data on Query {
  modelProviders {
    name
    key
    dependenciesInstalled
    dependencies
    apiKeyEnvVar
    apiKeySet
  }
}
`}};mu.hash="e63f789fe54d58eb540bf0ab1c8d6a7f";async function o2(){return await x.fetchQuery(be,mu,{}).toPromise()}const Qi=window.Config.basename,ji={width:"100%",height:"100%",border:"none",backgroundColor:"white"};function d2(){return s("div",{css:T`
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        height: 100%;
        .ac-tabs {
          flex: 1 1 auto;
        }
        .ac-tabs__pane-container,
        .ac-tabs__pane-container > div {
          flex: 1 1 auto;
          height: 100%;
        }
      `,children:[e(ye,{variant:"info",banner:!0,icon:e(_,{svg:e(ug,{})}),children:"These APIs are under active development and are subject to change."}),s(He,{children:[e(ne,{name:"REST",children:({isSelected:n})=>n&&e("iframe",{src:`${Qi}/docs`,style:ji})}),e(ne,{name:"GraphQL",children:({isSelected:n})=>n&&e("iframe",{src:`${Qi}/graphql`,style:ji})})]})]})}function Nl({children:n}){return s("main",{css:T`
        padding-top: 200px;
        width: 100%;
        height: 100vh;
        overflow: hidden;
        background: radial-gradient(
          90% 60% at 50% 30%,
          rgba(5, 145, 193, 0.4) 0%,
          transparent 100%
        );
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        box-sizing: border-box;
      `,children:[e(C,{borderColor:"light",borderWidth:"thin",width:"size-5000",padding:"size-400",backgroundColor:"dark",marginStart:"auto",marginEnd:"auto",borderRadius:"medium",overflow:"auto",children:n}),s("footer",{css:T`
          display: flex;
          justify-content: center;
          padding: var(--ac-global-dimension-size-400);
          gap: var(--ac-global-dimension-size-200);
          a {
            color: var(--ac-global-text-color-700);
            transition: color 0.2s ease-in-out;
            text-decoration: none;
            &:hover {
              color: var(--ac-global-text-color-900);
              text-decoration: underline;
            }
          }
        `,children:[e("a",{href:"https://docs.arize.com/phoenix",children:"Documentation"}),"|",e("a",{href:"https://join.slack.com/t/arize-ai/shared_invite/zt-1px8dcmlf-fmThhDFD_V_48oU7ALan4Q",children:"Community"}),"|",e("a",{href:"https://twitter.com/ArizePhoenix",children:"Social"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix",children:"GitHub"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix/releases",children:`arize-phoenix v${window.Config.platformVersion}`})]})]})}function HS(n){const a=se(),{initialError:l,onSubmit:t}=n,[i,r]=m.useState(l),[o,d]=m.useState(!1),c=m.useCallback(async u=>{t==null||t(),r(null),d(!0);try{const f=await fetch(Za("/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!f.ok){const k=f.status===429?"Too many requests. Please try again later.":"Invalid login";r(k);return}}catch{r("Invalid login");return}finally{d(()=>!1)}const g=mg();a(g)},[a,t,r]),{control:p,handleSubmit:y}=Ae({defaultValues:{email:"",password:""}});return s(H,{children:[i?s(C,{paddingBottom:"size-100",children:[e(ye,{variant:"danger",children:i})," "]}):null,e(Xe,{children:s(h,{direction:"column",gap:"size-100",children:[e(G,{name:"email",control:p,render:({field:{onChange:u,value:g}})=>s(J,{name:"email",isRequired:!0,type:"email",onChange:u,value:g,autoComplete:"email",children:[e(W,{children:"Email"}),e(ae,{placeholder:"your email address"})]})}),s("div",{css:T`
              position: relative;
              a {
                position: absolute;
                float: right;
                right: 0;
                top: var(--ac-global-dimension-size-50);
                font-size: 12px;
              }
            `,children:[e(G,{name:"password",control:p,render:({field:{onChange:u,value:g}})=>s(J,{name:"password",type:"password",isRequired:!0,onChange:u,value:g,onKeyDown:f=>{f.key==="Enter"&&y(c)()},autoComplete:"password",children:[e(W,{children:"Password"}),e(ae,{placeholder:"your password"})]})}),e(Qe,{to:"/forgot-password",children:"Forgot your password?"})]}),e(M,{variant:"primary",isDisabled:o,leadingVisual:o?e(_,{svg:e(ln,{})}):void 0,onPress:()=>y(c)(),children:o?"Logging In":"Log In"})]})})]})}const GS=T`
  button {
    width: 100%;
  }
  i {
    display: block;
    width: 20px;
    height: 20px;
    padding-right: var(--ac-global-dimension-size-50);
  }
  &[data-provider^="aws"],
  &[data-provider^="google"] {
    button {
      background-color: white;
      color: black;
      &:hover {
        background-color: #ececec !important;
      }
    }
  }
`;function WS({idpName:n,idpDisplayName:a,returnUrl:l}){return e("form",{action:Za(`/oauth2/${n}/login${l?`?returnUrl=${l}`:""}`),method:"post",css:GS,"data-provider":n,children:s(M,{variant:"default",type:"submit",leadingVisual:e(JS,{idpName:n}),children:["Login with ",a]})})}function JS({idpName:n}){return n==="github"||n==="google"||n==="microsoft_entra_id"||n.startsWith("aws")?e("i",{children:e("div",{css:T`
          display: inline-block;
          width: 20px;
          height: 20px;
          position: relative;
          background-size: contain;
          background-repeat: no-repeat;
          background-position: 50%;
          &[data-provider^="github"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='20' height='20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 0C4.477 0 0 4.36 0 9.74c0 4.304 2.865 7.955 6.839 9.243.5.09.682-.211.682-.47 0-.23-.008-.843-.013-1.656-2.782.588-3.369-1.306-3.369-1.306-.454-1.125-1.11-1.425-1.11-1.425-.908-.604.069-.592.069-.592 1.003.069 1.531 1.004 1.531 1.004.892 1.488 2.341 1.059 2.91.81.092-.63.35-1.06.636-1.303-2.22-.245-4.555-1.081-4.555-4.814 0-1.063.39-1.933 1.029-2.613-.103-.247-.446-1.238.098-2.578 0 0 .84-.262 2.75.998A9.818 9.818 0 0 1 10 4.71c.85.004 1.705.112 2.504.328 1.909-1.26 2.747-.998 2.747-.998.546 1.34.203 2.331.1 2.578.64.68 1.028 1.55 1.028 2.613 0 3.742-2.339 4.566-4.566 4.807.359.3.678.895.678 1.804 0 1.301-.012 2.352-.012 2.671 0 .261.18.564.688.47C17.137 17.69 20 14.042 20 9.74 20 4.36 15.522 0 10 0z' fill='%23161514' fill-rule='evenodd'/%3E%3C/svg%3E");
          }

          &[data-provider^="google"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 48 48'%3E%3Cdefs%3E%3Cpath id='a' d='M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z'/%3E%3C/defs%3E%3CclipPath id='b'%3E%3Cuse xlink:href='%23a' overflow='visible'/%3E%3C/clipPath%3E%3Cpath clip-path='url(%23b)' fill='%23FBBC05' d='M0 37V11l17 13z'/%3E%3Cpath clip-path='url(%23b)' fill='%23EA4335' d='M0 11l17 13 7-6.1L48 14V0H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%2334A853' d='M0 37l30-23 7.9 1L48 0v48H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%234285F4' d='M48 48L17 24l-4-3 35-10z'/%3E%3C/svg%3E");
          }
          &[data-provider^="microsoft"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='21' height='21'%3E%3Cpath fill='%23f25022' d='M1 1h9v9H1z'/%3E%3Cpath fill='%2300a4ef' d='M1 11h9v9H1z'/%3E%3Cpath fill='%237fba00' d='M11 1h9v9h-9z'/%3E%3Cpath fill='%23ffb900' d='M11 11h9v9h-9z'/%3E%3C/svg%3E");
          }
          &[data-provider^="aws"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='400' height='334' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M236.578 94.824c-9.683.765-20.854 1.502-32.021 3.006-17.12 2.211-34.24 5.219-48.386 11.907-27.544 11.208-46.163 35.053-46.163 70.114 0 44.018 28.298 66.354 64.026 66.354 11.93 0 21.606-1.466 30.522-3.71 14.156-4.481 26.07-12.67 40.209-27.596 8.192 11.205 10.413 16.428 24.575 28.338 3.725 1.502 7.448 1.502 10.413-.742 8.932-7.458 24.561-20.873 32.773-28.33 3.71-3.012 2.955-7.463.739-11.204-8.198-10.435-16.381-19.401-16.381-39.506V96.324c0-28.359 2.214-54.453-18.614-73.822C261.147 6.815 234.34.86 213.5.86h-8.947c-37.965 2.247-78.169 18.635-87.122 65.629-1.462 5.955 3.012 8.198 5.989 8.962l41.677 5.224c4.471-.773 6.691-4.491 7.432-8.233 3.74-16.388 17.136-24.583 32.024-26.087h2.998c8.905 0 18.586 3.743 23.813 11.168 5.932 8.965 5.21 20.904 5.21 31.339v5.961h.004v.001zm0 43.278c0 17.162.723 30.571-8.195 45.461-5.208 10.437-14.141 17.154-23.827 19.4-1.481 0-3.698.766-5.947.766-16.371 0-26.077-12.673-26.077-31.334 0-23.856 14.159-35.056 32.023-40.277 9.687-2.241 20.86-2.982 32.021-2.982v8.966h.002z'/%3E%3Cpath d='M373.71 315.303c18.201-15.398 25.89-43.349 26.29-57.939v-2.44c0-3.255-.803-5.661-1.6-6.88-3.646-4.445-30.369-8.523-53.402-1.627-6.468 2.045-12.146 4.865-17.396 8.507-4.051 2.854-3.238 6.464.802 6.08 4.447-.823 10.126-1.208 16.594-2.048 14.159-1.18 30.742-1.592 34.784 3.662 5.642 6.87-6.468 36.868-11.749 49.838-1.593 4.065 2.03 5.696 5.677 2.847z' fill='%23FE9900'/%3E%3Cpath d='M2.008 257.364c52.17 47.404 120.925 75.775 197.791 75.775 47.725 0 102.727-13.381 145.199-38.899 5.676-3.27 11.316-6.912 16.565-10.952 7.286-5.25.817-13.38-6.463-10.147-3.229 1.215-6.873 2.857-10.103 4.066-46.539 18.248-95.441 26.76-140.762 26.76-72.008 0-141.56-19.87-197.786-52.684-5.259-2.822-8.907 2.428-4.441 6.081z' fill='%23FE9900'/%3E%3C/svg%3E");
          }
        `,"data-provider":n})}):null}function ai(){return s("svg",{width:"253",height:"63",viewBox:"0 0 682 169",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[s("g",{clipPath:"url(#clip0_290_1904)",children:[e("path",{d:"M147.458 105.593C147.022 103.63 146.028 101.824 144.492 100.222C143.901 99.6064 143.244 99.0233 142.529 98.4978C142.184 98.2432 141.815 98.005 141.437 97.7669C140.969 97.4712 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3897 133.699 92.9299 133.157 92.4535C131.851 91.312 130.972 90.3348 130.315 89.3C130.102 88.9715 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8957C129.173 87.7233 128.869 87.6494 128.565 87.6986C128.097 87.789 127.736 88.1667 127.678 88.6431C127.637 89.0126 127.637 89.4068 127.687 89.8092C127.719 90.0474 127.588 90.2773 127.366 90.3758C127.317 90.4005 127.259 90.4087 127.21 90.4169C126.898 90.4498 126.619 90.6222 126.438 90.885C126.257 91.1478 126.208 91.4681 126.282 91.7719C126.348 92.0347 126.438 92.2236 126.512 92.3714L126.578 92.5028C126.627 92.5931 126.676 92.6917 126.726 92.782C126.873 93.0612 127.021 93.3405 127.202 93.6033C127.547 94.1042 127.933 94.6052 128.393 95.1389C128.541 95.3114 128.565 95.5578 128.459 95.7549C128.352 95.952 128.13 96.0669 127.908 96.0341C125.321 95.681 122.996 95.0979 120.836 94.3013C120.59 94.211 120.335 94.1206 120.097 94.0221C118.158 93.2009 121.658 89.7189 123.259 87.247C130.282 76.4479 131.736 64.0802 131.794 51.5647C131.851 39.4681 130.545 27.5357 128.138 15.7593V15.7429C126.569 5.87173 125.239 2.168 124.401 0.796558C124.22 0.435219 124.023 0.205276 123.818 0.0985162C123.588 -0.0575166 123.465 0.0163937 123.465 0.0163937C123.013 0.0328182 122.495 0.435219 121.871 1.08399C119.251 3.83509 119.399 7.11178 120.122 10.5363C123.432 26.0903 125.921 41.7346 124.787 57.7157C124.007 68.7365 121.953 79.3468 114.248 87.9779C113.789 88.4952 113.287 88.9798 112.786 89.4725C112.211 90.0391 111.316 91.1396 110.651 90.6797C109.764 90.0638 110.552 88.7991 110.831 88.1421C115.341 77.5729 116.639 66.5275 115.949 55.1453C115.932 54.8825 115.908 54.6197 115.891 54.3569V54.3405C115.883 54.1269 115.858 53.9298 115.842 53.7245C115.727 52.2217 115.587 50.7189 115.398 49.2242C113.46 31.1655 111.127 29.9911 111.127 29.9911C110.971 29.8515 110.782 29.7448 110.528 29.6955C109.304 29.4409 108.638 30.5167 108.096 31.3297C105.648 34.9924 106.733 38.8932 107.521 42.753C110.289 56.2703 110.33 69.6645 105.583 82.8124C105.147 84.0113 104.63 85.1775 104.08 86.3272C103.496 87.5508 103.119 89.0783 101.131 88.4213C99.2662 87.8054 99.7918 86.3929 100.03 85.1036C100.654 81.8269 101.155 78.542 101.467 75.2489V75.2653C101.509 74.9368 101.525 74.6247 101.55 74.3127C101.599 73.746 101.632 73.1712 101.665 72.6045C101.689 72.1282 101.714 71.6601 101.739 71.2002C101.747 70.9621 101.763 70.7321 101.763 70.494C102.141 60.0562 100.383 55.3095 99.7179 53.9052C99.644 53.7328 99.5619 53.5767 99.4715 53.4371C98.7815 52.4024 97.6398 52.5256 96.6541 53.5028C94.8388 55.2931 93.8367 57.4118 94.2967 60.0808C95.6438 67.8496 94.8552 75.5445 93.4096 83.1983C93.2124 84.2249 92.7524 86.0973 90.5593 85.6127C89.0644 85.2842 88.7194 84.6437 88.6372 83.3461C88.6537 82.3689 88.6372 81.3916 88.6044 80.4144C88.6044 80.3897 88.6044 80.3651 88.6044 80.3405C88.6044 80.2009 88.588 80.0612 88.588 79.9299C88.588 79.8559 88.5797 79.7902 88.5715 79.7245C88.5058 78.3942 88.399 77.0556 88.2347 75.717C88.2183 75.5856 88.1937 75.4624 88.1773 75.331C87.3394 67.7921 86.247 67.0612 86.247 67.0612C85.5488 66.1497 84.4563 66.3057 83.5117 67.2419C81.6964 69.0322 80.7764 71.1427 81.1543 73.8199C81.4336 75.7745 81.3596 75.175 81.5568 76.8831C81.7128 77.7618 81.8771 79.3632 81.8935 79.8724C81.8525 80.324 81.7375 80.7182 81.4582 81.0139C80.53 82.0076 79.0351 80.9892 77.9015 80.5211C55.9209 71.4302 37.1108 58.6683 20.691 42.523C14.2513 35.945 3.25273 22.6329 3.25273 22.6329C2.84203 22.1566 2.33276 21.8856 1.55243 22.2223C0.114982 22.8383 0.156052 24.6778 0.0246278 26.2217C-0.23822 29.3177 1.42101 31.5597 3.21987 33.662C28.0179 62.5856 58.2783 83.3708 94.8059 93.7675L101.377 95.5085C101.451 95.5249 101.533 95.5496 101.607 95.566C101.624 95.566 101.632 95.566 101.64 95.5742L107.299 97.077L107.456 97.1181C107.267 97.1756 107.061 97.2167 106.839 97.2577C100.613 98.4895 88.2923 96.223 78.3944 93.9153C73.4988 92.8888 68.6854 91.6405 63.9788 90.1541C63.7653 90.0884 63.642 90.0556 63.642 90.0556C45.3577 84.2331 28.6093 74.7972 13.9556 60.4093C12.5674 59.0461 11.286 57.5761 10.0211 56.0897C8.86289 54.71 6.47262 51.8275 5.643 50.8338C5.55265 50.7024 5.45408 50.5875 5.35551 50.4807C5.10909 50.2261 4.80517 50.0619 4.36983 50.1604C3.3513 50.3986 3.05559 51.4498 2.86667 52.3367C2.1192 55.9008 3.25273 58.8983 5.65122 61.5755C20.6582 78.3942 39.4929 89.1358 60.6439 96.1819C72.6528 100.181 85.0067 102.612 97.6069 104.164C90.0911 106.595 82.3617 107.334 74.5667 107.137C59.4775 106.759 45.3248 103.138 32.0264 96.6746C27.1226 94.1535 22.5556 91.3449 21.3564 90.5894C20.6664 90.1213 19.9518 89.8338 19.2454 90.3758C17.9229 91.4024 18.8347 93.2009 19.2618 94.6051C20.075 97.307 21.956 99.1712 24.3956 100.46C46.0641 111.917 68.9401 116.499 93.2946 112.434C95.7588 112.023 98.0998 111.572 100.679 110.701C96.6048 114.224 91.89 116.524 86.9369 118.339C71.6835 123.915 56.5287 123.693 41.4314 119.915C36.5851 118.618 30.9668 116.507 30.9668 116.507C30.1536 116.154 29.3486 116.031 28.7243 116.926C27.6237 118.503 28.5847 120.145 29.5375 121.632C31.7882 125.138 36.1416 125.483 39.5832 126.674C40.7578 127.052 37.5544 129.187 36.5276 129.975C31.5335 133.794 26.6462 137.284 21.6767 140.98L18.424 143.378C17.8654 143.764 17.3726 144.199 17.6272 145.004C17.9229 145.915 18.8675 146.08 19.7875 146.268C23.3442 147.008 26.3833 145.825 29.1925 143.723C35.2134 139.214 41.3493 134.837 47.2387 130.156C49.4811 128.374 51.5182 128.522 54.582 129.31C46.9183 135.083 39.7475 140.495 32.5685 145.899C25.2827 151.376 17.9969 156.854 10.711 162.323L5.89764 165.888C5.82371 165.937 5.758 165.986 5.69229 166.044L5.61836 166.093C5.20766 166.421 4.90374 166.791 4.9941 167.267C5.19123 168.351 6.4644 168.622 7.50758 168.803C11.8117 169.542 14.4813 167.924 17.4219 165.715C32.1496 154.661 46.9266 143.682 61.5721 132.521C64.8577 130.016 68.2337 128.604 72.9731 129.138C68.9401 132.152 65.0631 135.051 61.2436 137.908L50.8611 145.587C50.7871 145.636 50.7132 145.694 50.6475 145.751C50.0972 146.186 49.7111 146.695 49.9247 147.451C50.3189 148.822 51.97 148.987 53.3745 149.2C55.9537 149.586 58.1387 148.675 60.1675 147.164C61.3339 146.293 62.5085 145.439 63.6831 144.593L79.5361 132.004C79.5361 132.004 83.2817 129.327 87.6187 126.871C88.0048 126.633 88.3908 126.387 88.7851 126.148C88.9494 126.075 89.3601 125.886 89.9843 125.59C90.4525 125.352 90.9207 125.114 91.3807 124.892C92.0625 124.547 92.851 124.128 93.7381 123.644C96.2927 122.584 103.611 119.168 109.657 112.73C112.532 110.512 116.581 107.613 119.735 106.217H119.752C119.99 106.111 120.228 106.012 120.458 105.93C120.458 105.93 120.475 105.93 120.483 105.922C120.639 105.864 120.787 105.815 120.935 105.766L121.337 105.61C122.479 105.289 124.335 105.166 124.582 107.679C124.623 108.295 124.615 108.927 124.541 109.593C124.491 110.093 124.393 110.627 124.319 111.054C124.245 111.465 124.417 111.876 124.746 112.122C124.795 112.163 124.853 112.196 124.91 112.22C125.346 112.434 125.871 112.335 126.2 111.974C126.323 111.834 126.446 111.703 126.569 111.572C128.122 109.937 129.699 108.804 131.375 108.114C133.822 107.104 136.303 107.096 138.94 108.106C140.197 108.582 141.379 109.239 142.554 110.102C143.055 110.471 143.556 110.882 144.057 111.334C144.353 111.605 144.648 111.9 144.911 112.163L144.952 112.204L145.166 112.418C145.166 112.418 145.248 112.491 145.289 112.524C145.536 112.705 145.856 112.779 146.168 112.713C146.529 112.631 146.825 112.376 146.957 112.032C146.981 111.966 147.006 111.9 147.031 111.834C147.778 109.617 147.934 107.581 147.499 105.593H147.458Z",fill:"url(#paint0_linear_290_1904)"}),e("path",{d:"M120.113 94.0303C120.195 94.0632 120.269 94.096 120.351 94.1207C120.269 94.0878 120.187 94.0632 120.113 94.0303Z",fill:"#FEDBB5"}),e("path",{d:"M111.283 87.1238C111.283 87.1238 111.267 87.1567 111.267 87.1731C111.267 87.1567 111.283 87.1402 111.283 87.1238Z",fill:"#FEDBB5"}),e("path",{d:"M123.383 87.1074C123.383 87.1074 123.358 87.1487 123.341 87.1652C123.358 87.1487 123.366 87.1239 123.383 87.1074Z",fill:"#FEDBB5"}),e("path",{d:"M104.104 86.3354C103.965 86.6229 103.841 86.9267 103.71 87.2142C103.85 86.9267 103.973 86.6229 104.104 86.3354Z",fill:"#FEDBB5"}),e("path",{d:"M89.0233 84.7422C89.0233 84.7422 89.0233 84.7505 89.0316 84.7588C89.0316 84.7588 89.0316 84.7505 89.0233 84.7422Z",fill:"#FEDBB5"}),e("path",{d:"M89.0644 84.7998C89.1876 84.964 89.3437 85.1118 89.5408 85.235C89.3437 85.1118 89.1876 84.9722 89.0644 84.7998ZM89.0644 84.7833C89.0644 84.7833 89.0644 84.7833 89.0644 84.7915C89.0644 84.7915 89.0644 84.7915 89.0644 84.7833ZM89.0562 84.7751C89.0562 84.7751 89.0562 84.7751 89.0562 84.7833C89.0562 84.7833 89.0562 84.7833 89.0562 84.7751ZM88.6947 83.3626C88.6947 83.3626 88.6947 83.3708 88.6947 83.379C88.6947 83.379 88.6947 83.3708 88.6947 83.3626ZM79.1665 81.0878C79.1665 81.0878 79.1829 81.0878 79.1829 81.096C79.6429 81.2931 80.1029 81.4492 80.53 81.4492C80.7107 81.4492 80.8832 81.4245 81.0393 81.3588C80.875 81.4245 80.7025 81.4492 80.53 81.4492C80.0947 81.4492 79.6265 81.2849 79.1665 81.0878ZM88.629 79.6507C88.629 79.6507 88.629 79.6507 88.629 79.6589C88.629 79.6589 88.629 79.6589 88.629 79.6507Z",fill:"#E5B4A6"}),e("path",{d:"M120.36 94.1206C120.36 94.1206 120.434 94.1535 120.475 94.1617C120.475 94.1617 120.401 94.1289 120.36 94.1206ZM110.273 89.8749C110.273 90.187 110.38 90.4662 110.684 90.6797C110.79 90.7536 110.905 90.7865 111.029 90.7865C111.209 90.7865 111.398 90.7126 111.595 90.5894C111.406 90.7126 111.218 90.7865 111.029 90.7865C110.905 90.7865 110.79 90.7536 110.684 90.6797C110.38 90.4744 110.273 90.187 110.273 89.8749ZM110.914 88.0189C110.914 88.0189 110.881 88.1011 110.864 88.1421C110.881 88.1011 110.897 88.06 110.914 88.0189ZM111.226 87.2798C111.127 87.5262 111.02 87.7726 110.914 88.0189C111.02 87.7726 111.119 87.5262 111.226 87.2798ZM111.267 87.1731C111.267 87.1731 111.234 87.2388 111.226 87.2798C111.242 87.247 111.259 87.2141 111.267 87.1731ZM123.341 87.1731C123.341 87.1731 123.341 87.1813 123.333 87.1895C123.333 87.1895 123.333 87.1813 123.341 87.1731ZM123.391 87.0992C123.391 87.0992 123.391 87.1074 123.382 87.1156C123.382 87.1156 123.382 87.1074 123.391 87.0992ZM111.308 87.0992C111.308 87.0992 111.3 87.132 111.291 87.1402C111.291 87.1238 111.3 87.1074 111.308 87.0992ZM99.8001 86.7707C99.8001 87.4769 100.079 88.0928 101.155 88.446C101.484 88.5527 101.771 88.602 102.026 88.602C102.93 88.602 103.365 87.9615 103.71 87.2306C103.357 87.9697 102.921 88.602 102.026 88.602C101.78 88.602 101.492 88.5527 101.155 88.446C100.088 88.0928 99.8001 87.4769 99.8001 86.7707ZM92.7689 84.9886C92.4486 85.4074 91.9722 85.7195 91.2575 85.7195C91.1836 85.7195 91.1097 85.7195 91.0358 85.7113C91.1097 85.7113 91.1836 85.7195 91.2575 85.7195C91.9722 85.7195 92.4486 85.4157 92.7689 84.9886ZM106.651 79.7081C106.651 79.7081 106.651 79.7081 106.642 79.7081C106.322 80.7511 105.985 81.8023 105.616 82.8452C105.993 81.8023 106.338 80.7593 106.659 79.7081M94.1571 79.1251C93.9846 80.2748 93.7875 81.4163 93.5739 82.566C93.7875 81.4245 93.9846 80.2748 94.1571 79.1251ZM122.191 73.6311C120.623 78.7884 118.175 83.65 114.29 88.0025C113.83 88.5199 113.329 89.0044 112.828 89.4972C113.329 89.0126 113.821 88.5199 114.29 88.0025C118.175 83.65 120.623 78.7884 122.2 73.6311",fill:"#E5B4A6"}),e("path",{opacity:"0.4",d:"M2.20136 22.0745C2.00423 22.0745 1.79066 22.1238 1.55246 22.2223C0.53392 22.6658 0.254644 23.7252 0.139648 24.8503C5.61017 32.0196 27.213 58.4548 61.1943 76.5875C61.1943 76.5875 94.4692 94.1453 127.933 96.0423C125.346 95.6892 123.021 95.1061 120.861 94.3095C120.729 94.2602 120.606 94.2192 120.475 94.1699C108.318 91.542 97.9519 88.2571 90.6168 85.6292C90.7565 85.662 90.8961 85.6784 91.0193 85.6949C90.8879 85.6867 90.7401 85.662 90.5922 85.6292C90.1486 85.5306 89.8037 85.4074 89.5408 85.2432C83.7417 83.1244 80.0454 81.4984 79.1583 81.096C78.7312 80.9153 78.3123 80.6936 77.9344 80.5376C55.9538 71.4466 37.1437 58.6848 20.7239 42.5395C14.2513 35.945 3.25275 22.633 3.25275 22.633C2.97348 22.3045 2.6367 22.0745 2.20136 22.0745Z",fill:"url(#paint1_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M4.62448 50.1358C4.55056 50.1358 4.46842 50.144 4.37806 50.1687C3.35953 50.4068 3.06382 51.458 2.8749 52.3449C2.84204 52.5009 2.80919 52.6652 2.78455 52.8212C19.7711 75.832 42.5732 85.235 42.5732 85.235C65.3341 95.952 84.0128 98.12 95.3892 98.12C100.096 98.12 103.554 97.7505 105.533 97.463C104.63 97.5616 103.636 97.6109 102.568 97.6109C95.8984 97.6109 86.362 95.7795 78.4026 93.9235C73.5071 92.897 68.6937 91.6488 63.987 90.1623C63.7735 90.0966 63.6503 90.0638 63.6503 90.0638C45.3659 84.2413 28.6176 74.8054 13.9638 60.4175C12.5756 59.0543 11.2942 57.5843 10.0293 56.0979C8.87112 54.7182 6.48084 51.8357 5.65123 50.8421C5.56088 50.7107 5.46231 50.5957 5.36374 50.4889C5.16661 50.2836 4.9284 50.1358 4.62448 50.1358Z",fill:"url(#paint2_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M20.0669 90.1049C19.7958 90.1049 19.5247 90.187 19.2537 90.4005C18.1037 91.2874 18.6458 92.7738 19.0812 94.0632C27.5991 99.2287 47.132 109.289 70.2626 109.289C79.0023 109.289 88.243 107.86 97.607 104.189C90.8469 106.382 83.9061 107.195 76.9077 107.195C76.1274 107.195 75.3471 107.186 74.5667 107.162C59.4776 106.784 45.3249 103.162 32.0264 96.6993C27.1227 94.1781 22.5557 91.3695 21.3565 90.614C20.9293 90.3266 20.5022 90.1049 20.0669 90.1049Z",fill:"url(#paint3_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M99.1759 111.949C95.4632 114.791 91.2987 116.762 86.937 118.355C78.7559 121.344 70.5994 122.666 62.4675 122.666C55.4363 122.666 48.4298 121.681 41.4315 119.932C36.5852 118.634 30.9668 116.524 30.9668 116.524C30.6136 116.368 30.2604 116.261 29.9237 116.261C29.4883 116.261 29.0776 116.442 28.7326 116.951C28.2234 117.682 28.1577 118.429 28.3219 119.168C33.6939 121.665 45.2181 126.099 59.2723 126.099C71.4536 126.099 85.5406 122.765 99.1759 111.949Z",fill:"url(#paint4_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M62.9356 129.368C49.7358 129.368 39.7557 126.699 38.4908 126.346C38.8604 126.452 39.2218 126.567 39.5833 126.69C40.7579 127.068 37.5544 129.203 36.5276 129.992C32.8396 132.817 29.2008 135.461 25.5537 138.138H36.7576C40.2897 135.527 43.8052 132.907 47.2387 130.172C48.5119 129.154 49.7275 128.768 51.0993 128.768C52.1342 128.768 53.2678 128.99 54.582 129.335C46.9184 135.108 39.7475 140.52 32.5685 145.924C28.3711 149.077 24.1738 152.231 19.9764 155.384H31.246C41.3821 147.804 51.51 140.216 61.5721 132.546C63.8967 130.78 66.2623 129.557 69.1208 129.179C67.0016 129.318 64.9316 129.376 62.9439 129.376L62.9356 129.368Z",fill:"url(#paint5_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M60.5782 138.409H71.47L79.5115 132.02C79.5115 132.02 83.2571 129.343 87.5941 126.888C87.9801 126.649 88.3662 126.403 88.7605 126.165C88.9248 126.091 89.3354 125.902 89.9597 125.606C90.4279 125.368 90.8961 125.13 91.3561 124.908C92.0625 124.547 92.8921 124.112 93.8121 123.603C86.0499 126.855 78.0987 128.44 70.739 129.056C70.8375 129.056 70.9443 129.056 71.0429 129.056C71.6589 129.056 72.2996 129.088 72.965 129.162C68.9319 132.176 65.0549 135.075 61.2354 137.933L60.5782 138.418V138.409Z",fill:"url(#paint6_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M88.6701 83.3544C88.6865 82.3771 88.6701 81.3999 88.6373 80.4226V80.3487C88.6373 80.2091 88.6208 80.0695 88.6208 79.9381L88.6044 79.7328C88.5633 78.9115 88.4976 78.0903 88.4237 77.2609C85.8281 76.1687 83.3803 74.7726 81.1215 73.1301C81.1379 73.3601 81.1461 73.59 81.179 73.8364C81.4582 75.7909 81.3843 75.1914 81.5814 76.8995C81.7375 77.7783 81.9018 79.3797 81.9182 79.8888C81.8771 80.3405 81.7621 80.7347 81.4829 81.0303C81.1954 81.3342 80.8586 81.4491 80.4972 81.4491C80.0619 81.4491 79.5937 81.2849 79.1337 81.0878C79.9961 81.4738 83.7007 83.108 89.5408 85.2432C88.9165 84.8572 88.7194 84.2742 88.6619 83.3626L88.6701 83.3544Z",fill:"url(#paint7_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M131.022 64.885C128.59 68.2685 125.6 71.2331 122.175 73.6146C120.606 78.7719 118.158 83.6336 114.273 87.9861C113.813 88.5035 113.312 88.988 112.811 89.4807C112.326 89.9488 111.628 90.8029 111.02 90.8029C110.897 90.8029 110.782 90.77 110.675 90.6961C109.788 90.0802 110.577 88.8155 110.856 88.1585C112.31 84.7505 113.427 81.2931 114.257 77.7865C111.825 78.698 109.271 79.3386 106.634 79.6999C106.314 80.7429 105.977 81.794 105.607 82.837C105.172 84.036 104.655 85.2021 104.104 86.3518C103.62 87.3702 103.275 88.602 102.018 88.602C101.771 88.602 101.484 88.5527 101.147 88.446C99.2827 87.83 99.8084 86.4175 100.047 85.1282C100.367 83.4201 100.663 81.7119 100.909 79.9956C98.5927 79.9217 96.3256 79.626 94.1325 79.1168C93.9271 80.4883 93.6889 81.8515 93.4261 83.2148C93.2536 84.1263 92.8675 85.7113 91.2412 85.7113C91.044 85.7113 90.8305 85.6867 90.6005 85.6374C97.9356 88.2735 108.293 91.5584 120.458 94.1863C120.335 94.1371 120.22 94.096 120.105 94.0467C118.167 93.2255 121.666 89.7435 123.268 87.2716C127.777 80.3323 129.987 72.7523 131.005 64.8932L131.022 64.885Z",fill:"url(#paint8_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M129.206 102.497C127.687 102.497 126.151 102.645 124.647 102.916C124.36 102.965 124.081 102.99 123.818 102.99C123.391 102.99 122.988 102.924 122.61 102.809C122.668 102.883 122.734 102.957 122.791 103.039C123.448 103.959 123.793 104.961 123.925 106.004C124.089 106.184 124.229 106.406 124.344 106.694C124.344 106.694 124.344 106.694 124.344 106.71C124.344 106.71 124.344 106.71 124.344 106.718C124.344 106.718 124.344 106.718 124.344 106.726C124.344 106.726 124.344 106.726 124.344 106.735C124.344 106.735 124.344 106.735 124.344 106.743C124.344 106.743 124.344 106.743 124.344 106.751C124.344 106.751 124.344 106.751 124.344 106.759C124.344 106.759 124.344 106.759 124.344 106.768V106.784C124.344 106.784 124.344 106.784 124.344 106.792C124.344 106.792 124.344 106.792 124.344 106.8C124.344 106.8 124.344 106.8 124.344 106.809C124.344 106.809 124.344 106.809 124.344 106.817C124.344 106.817 124.344 106.817 124.344 106.825C124.344 106.825 124.344 106.833 124.344 106.841C124.344 106.841 124.344 106.841 124.344 106.858C124.344 106.858 124.344 106.858 124.344 106.866C124.344 106.866 124.344 106.866 124.344 106.874C124.344 106.874 124.344 106.874 124.344 106.882C124.344 106.882 124.344 106.883 124.344 106.891C124.344 106.891 124.344 106.891 124.344 106.899C124.344 106.899 124.344 106.899 124.344 106.907C124.344 106.907 124.344 106.907 124.344 106.915C124.344 106.915 124.344 106.915 124.344 106.924C124.344 106.924 124.344 106.924 124.344 106.932C124.344 106.932 124.344 106.932 124.344 106.94C124.344 106.94 124.344 106.94 124.344 106.948C124.344 106.948 124.344 106.948 124.344 106.965C124.344 106.965 124.344 106.973 124.344 106.981C124.344 106.981 124.344 106.989 124.344 106.997V107.014C124.344 107.014 124.344 107.022 124.344 107.03C124.344 107.03 124.344 107.039 124.344 107.047C124.344 107.047 124.344 107.055 124.344 107.063C124.344 107.063 124.344 107.071 124.344 107.08C124.344 107.08 124.344 107.088 124.344 107.096C124.344 107.096 124.344 107.104 124.344 107.112C124.344 107.112 124.344 107.121 124.344 107.129C124.344 107.145 124.344 107.162 124.344 107.178C124.344 107.178 124.344 107.186 124.344 107.195C124.344 107.195 124.344 107.227 124.344 107.244C124.344 107.244 124.344 107.252 124.344 107.26V107.277C124.344 107.277 124.344 107.301 124.344 107.31C124.344 107.31 124.344 107.318 124.344 107.326V107.342V107.359C124.36 107.597 124.368 107.843 124.368 108.09C124.368 108.476 124.344 108.87 124.302 109.272C124.253 109.773 124.155 110.307 124.081 110.734C124.072 110.8 124.064 110.865 124.064 110.923C124.064 111.268 124.229 111.588 124.508 111.793L124.672 111.892C124.828 111.966 124.992 112.007 125.157 112.007C125.461 112.007 125.748 111.884 125.962 111.654C126.085 111.514 126.208 111.383 126.331 111.251C127.884 109.617 129.461 108.484 131.136 107.794C132.369 107.285 133.601 107.03 134.857 107.03C136.114 107.03 137.387 107.285 138.702 107.786C139.958 108.262 141.141 108.919 142.316 109.781C142.817 110.151 143.318 110.562 143.819 111.013C144.115 111.284 144.41 111.58 144.673 111.843L144.714 111.884L144.928 112.097L145.051 112.204C145.232 112.335 145.453 112.409 145.675 112.418C144.632 110.192 143.318 108.123 141.461 106.513C137.946 103.466 133.51 102.177 129.001 102.177",fill:"url(#paint9_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M128.779 87.6905L128.582 87.7069C128.114 87.7972 127.752 88.175 127.695 88.6513C127.654 89.0208 127.654 89.415 127.703 89.8174C127.72 89.9488 127.687 90.072 127.629 90.1706C129.51 92.9627 133.584 97.9065 139.769 99.7789C139.769 99.7789 149.331 104.78 146.916 112.032L146.99 111.834C147.737 109.617 147.893 107.581 147.458 105.593C147.022 103.63 146.029 101.824 144.492 100.222C143.901 99.6064 143.244 99.0234 142.529 98.4978C142.184 98.2432 141.815 98.0051 141.437 97.7669C140.969 97.4713 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3898 133.699 92.9299 133.157 92.4536C131.851 91.3121 130.972 90.3348 130.315 89.3001C130.102 88.9716 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8958C129.231 87.7562 129.001 87.6823 128.763 87.6823",fill:"url(#paint10_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M116.647 107.893L118.586 106.768L126.734 95.8535C126.734 95.8535 122.274 95.0076 120.122 94.0303C120.122 94.0303 117.887 104.222 109.632 112.738L112.672 110.488C113.887 109.634 114.988 108.903 116.647 107.893Z",fill:"url(#paint11_linear_290_1904)"}),e("path",{d:"M209.416 49.9962H230.197C245.221 49.9962 252.104 57.7157 252.104 73.5818V81.4409C252.104 97.307 245.221 105.027 230.197 105.027H218.123V148.264H209.416V49.9962ZM230.197 97.0196C239.323 97.0196 243.397 92.9463 243.397 81.8598V73.0152C243.397 62.0682 239.323 57.8553 230.197 57.8553H218.123V97.0196H230.197Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M284.114 49.9962H292.821V93.0941H319.64V49.9962H328.346V148.256H319.64V100.953H292.821V148.256H284.114V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M362.451 125.656V72.5963C362.451 57.0177 370.312 48.5919 384.497 48.5919C398.683 48.5919 406.544 57.0177 406.544 72.5963V125.656C406.544 141.234 398.683 149.66 384.497 149.66C370.312 149.66 362.451 141.234 362.451 125.656ZM397.829 126.214V72.0297C397.829 61.5016 393.056 56.451 384.489 56.451C375.922 56.451 371.15 61.5016 371.15 72.0297V126.214C371.15 136.742 375.922 141.653 384.489 141.653C393.056 141.653 397.829 136.742 397.829 126.214Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M440.796 49.9962H480.108V57.8553H449.503V93.0859H474.638V100.945H449.503V140.249H480.108V148.248H440.796V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M511.56 49.9962H523.076L548.629 125.935V49.9962H556.769V148.256H547.504L519.56 64.458V148.256H511.56V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M592.007 49.9962H600.714V148.256H592.007V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M651.674 98.1447L632.437 49.9962H641.702L657.144 89.0209L672.726 49.9962H681.154L661.917 98.1447L681.992 148.256H672.726L656.438 106.989L640.01 148.256H631.591L651.666 98.1447H651.674Z",fill:"var(--ac-global-text-color-900)"})]}),s("defs",{children:[s("linearGradient",{id:"paint0_linear_290_1904",x1:"22.0956",y1:"10.3474",x2:"97.4433",y2:"140.879",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#14BAB6"}),e("stop",{offset:"0.5",stopColor:"#00ADEE"}),e("stop",{offset:"1",stopColor:"#0095C4"})]}),s("linearGradient",{id:"paint1_linear_290_1904",x1:"95.422",y1:"114.807",x2:"31.8741",y2:"4.70214",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint2_linear_290_1904",x1:"76.6695",y1:"114.126",x2:"30.8746",y2:"34.7951",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint3_linear_290_1904",x1:"70.3612",y1:"119.915",x2:"44.7991",y2:"75.6384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint4_linear_290_1904",x1:"71.4208",y1:"128.85",x2:"55.5071",y2:"101.279",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint5_linear_290_1904",x1:"44.5363",y1:"126.346",x2:"44.5363",y2:"155.384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.9"}),e("stop",{offset:"0.22",stopColor:"#231F20",stopOpacity:"0.4"}),e("stop",{offset:"0.42",stopColor:"#231F20",stopOpacity:"0.1"}),e("stop",{offset:"0.65",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint6_linear_290_1904",x1:"77.1952",y1:"123.603",x2:"77.1952",y2:"138.409",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint7_linear_290_1904",x1:"84.3413",y1:"85.235",x2:"84.3413",y2:"73.1301",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.95"}),e("stop",{offset:"0.51",stopColor:"#231F20",stopOpacity:"0.26"}),e("stop",{offset:"0.81",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint8_linear_290_1904",x1:"110.815",y1:"94.1699",x2:"110.815",y2:"64.885",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.18",stopColor:"#231F20",stopOpacity:"0.48"}),e("stop",{offset:"0.38",stopColor:"#231F20",stopOpacity:"0.12"}),e("stop",{offset:"0.58",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint9_linear_290_1904",x1:"138.077",y1:"117.246",x2:"127.969",y2:"99.7278",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),s("linearGradient",{id:"paint10_linear_290_1904",x1:"146.226",y1:"112.434",x2:"131.084",y2:"86.1931",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),s("linearGradient",{id:"paint11_linear_290_1904",x1:"106.889",y1:"107.999",x2:"128.941",y2:"95.2581",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.31",stopColor:"#231F20",stopOpacity:"0.5"}),e("stop",{offset:"0.67",stopColor:"#231F20",stopOpacity:"0.13"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),e("clipPath",{id:"clip0_290_1904",children:e("rect",{width:"682",height:"169",fill:"white"})})]})]})}const ZS=T`
  text-align: center;
  margin-top: var(--ac-global-dimension-size-200);
  margin-bottom: var(--ac-global-dimension-size-200);
  color: var(--ac-global-text-color-700);
`,XS=T`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  flex-wrap: wrap;
  justify-content: center;
`;function c2(){const n=window.Config.oAuth2Idps,a=n.length>0,[l,t]=hn(),i=l.get("returnUrl"),r=l.get("message");return s(Nl,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(ai,{})})}),r&&e(C,{paddingBottom:"size-100",children:e(ye,{variant:"success",children:r})}),e(HS,{initialError:l.get("error"),onSubmit:()=>{t(o=>{const d=new URLSearchParams(o);return d.delete("message"),d.delete("error"),d})}}),a&&s(H,{children:[e("div",{css:ZS,children:"or"}),e("ul",{css:XS,children:n.map(o=>e("li",{children:e(WS,{idpName:o.name,idpDisplayName:o.displayName,returnUrl:i},o.name)},o.name))})]})]})}const pu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordFormMutation",selections:a},params:{cacheID:"d09af5e3a2a3d10f117373e25bef11e6",id:null,metadata:{},name:"ResetPasswordFormMutation",operationKind:"mutation",text:`mutation ResetPasswordFormMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}}();pu.hash="f8f5c30b0e00c17cdda7557c73c3c2d3";const gu={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ResetPasswordFormQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};gu.hash="1161643b76edb6ef437d8f136038cf21";const $a=4;function YS(n){var p;const a=se(),l=Te(),t=x.useFragment(gu,n.query),[i,r]=x.useMutation(pu),{control:o,handleSubmit:d}=Ae({defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}}),c=m.useCallback(y=>{i({variables:{input:{currentPassword:y.currentPassword,newPassword:y.newPassword}},onCompleted:()=>{const u=Or({path:"/login",searchParams:{message:"Password has been reset."}});a(u)},onError:u=>{l({title:"Failed to reset password",message:u.message})}})},[i,a,l]);return s(fl,{onSubmit:d(c),children:[e(lt,{children:s(J,{name:"email",type:"email",autoComplete:"email",isRequired:!0,isReadOnly:!0,value:(p=t.viewer)==null?void 0:p.email,children:[e(W,{children:"Email"}),e(ae,{})]})}),e(G,{name:"currentPassword",control:o,rules:{required:"the current is required"},render:({field:{name:y,onChange:u,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{type:"password",name:y,isRequired:!0,isInvalid:k,onChange:u,onBlur:g,value:f,id:"current-password",autoComplete:"current-password",children:[e(W,{children:"Old Password"}),e(ae,{}),b?e(Fe,{children:b==null?void 0:b.message}):e(v,{slot:"description",children:"The current password"})]})}),e(G,{name:"newPassword",control:o,rules:{required:"Password is required",minLength:{value:$a,message:`Password must be at least ${$a} characters`},validate:(y,u)=>y!==u.currentPassword||"New password must be different"},render:({field:{name:y,onChange:u,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{type:"password",isRequired:!0,name:y,isInvalid:k,onChange:u,onBlur:g,defaultValue:f,id:"new-password",autoComplete:"new-password",children:[e(W,{children:"New Password"}),e(ae,{}),b?e(Fe,{children:b==null?void 0:b.message}):s(v,{slot:"description",children:["Password must be at least ",$a," characters"]})]})}),e(G,{name:"confirmPassword",control:o,rules:{required:"Password is required",minLength:{value:$a,message:`Password must be at least ${$a} characters`},validate:(y,u)=>y===u.newPassword||"Passwords do not match"},render:({field:{name:y,onChange:u,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{isRequired:!0,type:"password",name:y,isInvalid:k,onChange:u,onBlur:g,defaultValue:f,autoComplete:"new-password",children:[e(W,{children:"Confirm Password"}),e(ae,{}),b?e(Fe,{children:b==null?void 0:b.message}):e(v,{slot:"description",children:"Confirm the new password"})]})}),s("div",{css:T`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-size-200);
          padding-top: var(--ac-global-dimension-size-100);
          & > * {
            width: 50%;
          }
        `,children:[e(M,{onPress:()=>{a(-1)},children:"Cancel"}),e(M,{variant:"primary",type:"submit",isDisabled:r,children:r?"Resetting...":"Reset Password"})]})]})}function u2(){const n=Ue();return s(Nl,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(ai,{})})}),e(YS,{query:n})]})}const Oa=4,ev="An error occurred. Please try resetting again.";function nv({resetToken:n}){const a=se(),[l,t]=m.useState(null),[i,r]=m.useState(!1),o=m.useCallback(async({resetToken:y,newPassword:u})=>{t(null),r(!0);try{const g=await fetch(Za("/auth/password-reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:y,password:u})});if(!g.ok){const f=await g.text();t(f);return}}catch{t(ev);return}finally{r(()=>!1)}a(`/login?message=${encodeURIComponent("Password has been reset.")}`)},[t,a]),{control:d,handleSubmit:c,formState:{isDirty:p}}=Ae({defaultValues:{resetToken:n,newPassword:"",confirmPassword:""}});return s(H,{children:[l?e(C,{paddingBottom:"size-100",children:e(ye,{variant:"danger",children:l})}):null,s(fl,{onSubmit:c(o),children:[e(G,{name:"newPassword",control:d,rules:{required:"Password is required",minLength:{value:Oa,message:`Password must be at least ${Oa} characters`}},render:({field:{name:y,onChange:u,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{type:"password",isRequired:!0,name:y,isInvalid:k,id:"new-password",autoComplete:"new-password",onChange:u,onBlur:g,defaultValue:f,children:[e(W,{children:"New Password"}),e(ae,{}),b?e(Fe,{children:b==null?void 0:b.message}):s(v,{slot:"description",children:["Password must be at least ",Oa," characters"]})]})}),e(G,{name:"confirmPassword",control:d,rules:{required:"Password is required",minLength:{value:Oa,message:`Password must be at least ${Oa} characters`},validate:(y,u)=>y===u.newPassword||"Passwords do not match"},render:({field:{name:y,onChange:u,onBlur:g,value:f},fieldState:{invalid:k,error:b}})=>s(J,{type:"password",isRequired:!0,name:y,isInvalid:k,onChange:u,onBlur:g,defaultValue:f,children:[e(W,{children:"Confirm Password"}),e(ae,{}),b?e(Fe,{children:b==null?void 0:b.message}):e(v,{slot:"description",children:"Confirm the new password"})]})}),e("div",{css:T`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(M,{variant:p?"primary":"default",type:"submit",isDisabled:i,children:i?"Resetting...":"Reset Password"})})]})]})}function m2(){const n=se(),[a]=hn(),l=a.get("token");return l?s(Nl,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(ai,{})})}),e(nv,{resetToken:l}),e(C,{paddingTop:"size-200",children:e(h,{direction:"column",alignItems:"center",justifyContent:"center",children:e(Qe,{to:"/login",children:"Back to Login"})})})]}):(n("/login"),null)}const yu=function(){var n={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"resetPasswordLoaderQuery",selections:[n,{args:null,kind:"FragmentSpread",name:"ResetPasswordFormQuery"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"resetPasswordLoaderQuery",selections:[n]},params:{cacheID:"558e2fa85c0dc24da6318db9ebbd7958",id:null,metadata:{},name:"resetPasswordLoaderQuery",operationKind:"query",text:`query resetPasswordLoaderQuery {
  viewer {
    id
    email
  }
  ...ResetPasswordFormQuery
}

fragment ResetPasswordFormQuery on Query {
  viewer {
    email
  }
}
`}}}();yu.hash="17bb397eaa3a44dd33996854e538f2ef";async function p2(){const n=await x.fetchQuery(be,yu,{}).toPromise();return n!=null&&n.viewer?n:Ua("/login")}function av({onResetSent:n}){const[a,l]=m.useState(null),[t,i]=m.useState(!1),r=m.useCallback(async c=>{l(null),i(!0);try{const p=await fetch(Za("/auth/password-reset-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!p.ok){const y=await p.text();l(y);return}n()}finally{i(()=>!1)}},[n,l]),{control:o,handleSubmit:d}=Ae({defaultValues:{email:""}});return s(H,{children:[a?e(C,{paddingBottom:"size-100",children:e(ye,{variant:"danger",children:a})}):null,s(Xe,{onSubmit:d(r),children:[e(G,{name:"email",control:o,render:({field:{onChange:c,value:p}})=>s(J,{name:"email",isRequired:!0,type:"email",onChange:c,value:p,children:[e(W,{children:"Email"}),e(ae,{placeholder:"your email address"}),e(v,{slot:"description",children:"Enter the email address associated with your account."})]})}),e("div",{css:T`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(M,{variant:"primary",type:"submit",isDisabled:t,children:t?"Sending...":"Send"})})]})]})}function g2(){const[n,a]=m.useState(!1),l=n?s(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(te,{level:1,children:"Check your email"}),e("p",{children:"Thanks! If an account with that email address exists, we sent you a link to reset your password."})]}):s(H,{children:[s(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(te,{level:1,children:"Forgot Password"}),e("p",{children:`Enter the email address associated with your account and we'll send you
        a link to reset your password.`})]}),e(av,{onResetSent:()=>a(!0)})]});return e(Nl,{children:s("div",{css:T`
          & a {
            text-align: center;
            width: 100%;
            display: block;
            text-align: center;
            padding-top: var(--ac-global-dimension-size-200);
          }
        `,children:[l,e(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:e(Qe,{to:"/login",children:"Back to Login"})})]})})}const fu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"572bf0f64678128defccf833e6a5d4ce",id:null,metadata:{},name:"ViewerAPIKeysCreateUserAPIKeyMutation",operationKind:"mutation",text:`mutation ViewerAPIKeysCreateUserAPIKeyMutation(
  $input: CreateUserApiKeyInput!
) {
  createUserApiKey(input: $input) {
    jwt
    apiKey {
      id
      user {
        ...APIKeysTableFragment
      }
    }
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}}();fu.hash="28061ae008e197468be6fd5f2775ccb0";const hu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[l,t,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[l,t,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"f28a00e7a6eb2e18b1f8b31c8231c2b7",id:null,metadata:{},name:"APIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    __typename
    apiKeyId
    query {
      ...UserAPIKeysTableFragment
    }
  }
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}}}();hu.hash="3a505d9d13944798a57fc873ddf0992d";const ku=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}]},params:{cacheID:"e677b5974fa137ac3a26acde353767d8",id:null,metadata:{},name:"APIKeysTableQuery",operationKind:"query",text:`query APIKeysTableQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...APIKeysTableFragment
    __isNode: __typename
    id
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}}();ku.hash="6c32098d55e4cba859dcec73f3ccd28c";const bu=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:ku,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"APIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},n],type:"User",abstractKey:null}}();bu.hash="6c32098d55e4cba859dcec73f3ccd28c";const qi=70;function lv({query:n}){const[a,l]=x.useRefetchableFragment(bu,n),t=Se(),[i]=x.useMutation(hu),r=m.useCallback(u=>{i({variables:{input:{id:u}},onCompleted:()=>{t({title:"API key deleted",message:"The key has been deleted and is no longer active."}),m.startTransition(()=>{l({},{fetchPolicy:"network-only"})})}})},[i,t,l]),o=m.useMemo(()=>[...a.apiKeys],[a]),d=m.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:Ke},{header:"Description",accessorKey:"description",cell:Ke},{header:"Created At",accessorKey:"createdAt",size:qi,cell:Me},{header:"Expires At",accessorKey:"expiresAt",size:qi,cell:Me},{header:"",accessorKey:"id",size:10,cell:({row:g})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(Rt,{handleDelete:()=>{r(g.original.id)}})}),meta:{textAlign:"right"}}],[r]),c=xe({columns:d,data:o,getCoreRowModel:De()}),p=c.getRowModel().rows,y=c.getRowModel().rows.length===0;return s("table",{css:tn,children:[e("thead",{children:c.getHeaderGroups().map(u=>e("tr",{children:u.headers.map(g=>e("th",{colSpan:g.colSpan,children:g.isPlaceholder?null:s("div",{className:g.column.getCanSort()?"cursor-pointer":"",onClick:g.column.getToggleSortingHandler(),style:{left:g.getStart(),width:g.getSize()},children:[Z(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(_,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]})},g.id))},u.id))}),y?e(rn,{message:"No Keys"}):e("tbody",{children:p.map(u=>e("tr",{children:u.getVisibleCells().map(g=>e("td",{children:Z(g.column.columnDef.cell,g.getContext())},g.id))},u.id))})]})}function tv({viewer:n}){const[a,l]=m.useState(null),t=Te(),[i,r]=x.useMutation(fu),o=m.useCallback(d=>{var c;i({variables:{input:{...d,expiresAt:((c=d.expiresAt)==null?void 0:c.toDate(ut()).toISOString())||null}},onCompleted:p=>{l(e(zr,{jwt:p.createUserApiKey.jwt}))},onError:p=>{t({title:"Error creating API key",message:p.message})}})},[i,t]);return s(O,{title:"API Keys",variant:"compact",bodyStyle:{padding:0},extra:e(M,{size:"S",leadingVisual:e(_,{svg:e(bn,{})}),onPress:()=>l(e($r,{onSubmit:o,isCommitting:r})),children:"New Key"}),children:[e(lv,{query:n}),e(Y,{onDismiss:()=>{l(null)},children:a})]})}const Su=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerProfileCardMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerProfileCardMutation",selections:a},params:{cacheID:"03f161df42c71b5924a8ee665e01cdce",id:null,metadata:{},name:"ViewerProfileCardMutation",operationKind:"mutation",text:`mutation ViewerProfileCardMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}}();Su.hash="4a11ca65151d84fe95f636763c91dc68";function iv(){const{viewer:n,refetchViewer:a}=Qr(),l=Te(),t=Se(),[i,r]=x.useMutation(Su),{control:o,handleSubmit:d,formState:{isDirty:c},reset:p}=Ae({defaultValues:{username:(n==null?void 0:n.username)||""}}),y=m.useCallback(u=>{i({variables:{input:{newUsername:u.username}},onCompleted:()=>{t({title:"Profile updated",message:"Your profile has been updated"}),p({username:u.username}),a()},onError:g=>{l({title:"Failed update profile",message:g.message})}})},[i,t,p,a,l]);return n?s(O,{title:"Profile",variant:"compact",bodyStyle:{padding:0},extra:n.authMethod==="LOCAL"&&e(Kl,{size:"S",to:"/reset-password",children:"Reset Password"}),children:[e(C,{paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",children:s(h,{direction:"row",gap:"size-200",alignItems:"center",children:[e(vt,{name:n.username||n.email,profilePictureUrl:n.profilePictureUrl}),s(h,{direction:"column",gap:"size-50",children:[e(te,{level:2,weight:"heavy",children:n.username||n.email}),e(v,{children:n.role.name.toLocaleLowerCase()})]})]})}),e(C,{children:s(Xe,{onSubmit:d(y),children:[e(C,{padding:"size-200",children:s(h,{direction:"column",gap:"size-100",children:[s(J,{value:n.email,isReadOnly:!0,size:"S",children:[e(W,{children:"Email"}),e(ae,{})]}),e(G,{name:"username",control:o,rules:{required:"A username is required as it needs to be unique"},render:({field:{name:u,onChange:g,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>s(J,{isRequired:!0,name:u,isInvalid:b,onChange:g,onBlur:f,defaultValue:k,size:"S",children:[e(W,{children:"Username"}),e(ae,{}),S?e(Fe,{children:S.message}):e(v,{slot:"description",children:"A unique username"})]})})]})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderTopColor:"dark",borderTopWidth:"thin",children:e(h,{direction:"row",gap:"size-100",justifyContent:"end",children:e(M,{variant:c?"primary":"default",size:"S",isDisabled:!c,onPress:()=>{d(y)()},children:r?"Saving...":"Save"})})})]})})]}):null}const rv=T`
  overflow-y: auto;
`,sv=T`
  padding: var(--ac-global-dimension-size-400);
  max-width: 800px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`;function y2(){const{viewer:n}=Qr();return n?e("main",{css:rv,children:e("div",{css:sv,children:s(h,{direction:"column",gap:"size-200",children:[e(iv,{}),e(tv,{viewer:n})]})})}):null}function f2(){return e(Yt,{})}function h2(){const n=Ue(),a=m.useMemo(()=>n.span.__typename==="Span"?n.span:null,[n.span]);if(!a)throw new Error("Span not found");const{playgroundInstance:l,parsingErrors:t,playgroundInput:i}=m.useMemo(()=>oy(a),[a]),r=i!=null?{input:i}:{};return s(h,{direction:"column",height:"100%",children:[e(ov,{span:a,parsingErrors:t}),e(Yt,{instances:[l],...r},a.id)]})}function ov({span:n,parsingErrors:a}){const l=se(),t=a&&a.length>0,[i,r]=m.useState(!0),[o,d]=m.useState(t);return s(h,{direction:"column",gap:"size-50",children:[i&&e(ye,{variant:"info",title:"LLM Span Replay",banner:!0,dismissable:!0,onDismissClick:()=>{r(!1)},extra:e(M,{leadingVisual:e(_,{svg:e(pg,{})}),onPress:()=>{l(`/projects/${n.project.id}/traces/${n.context.traceId}?selectedSpanNodeId=${n.id}`)},children:"Back to Trace"}),children:`Replay and iterate on your LLM call from your ${n.project.name} project`}),o&&t&&e(ye,{variant:"warning",banner:!0,dismissable:!0,onDismissClick:()=>{d(!1)},title:"The following errors occurred when parsing span attributes:",children:e("ul",{children:a.map(c=>e("li",{children:c},c))})})]})}const vu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},r={alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null}],c={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"invocationParameters",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:d,type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:d,type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:d,type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:d,type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:d,type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:d,type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:d,type:"StringListInvocationParameter",abstractKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[t,i,r,o,c],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[i,r,o,c],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"e6a9310252c290e00bfdc12151c88b3a",id:null,metadata:{},name:"spanPlaygroundPageLoaderQuery",operationKind:"query",text:`query spanPlaygroundPageLoaderQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      id
      project {
        id
        name
      }
      context {
        spanId
        traceId
      }
      attributes
      invocationParameters {
        __typename
        ... on InvocationParameterBase {
          __isInvocationParameterBase: __typename
          invocationName
          canonicalName
        }
        ... on BooleanInvocationParameter {
          invocationInputField
        }
        ... on StringInvocationParameter {
          invocationInputField
        }
        ... on BoundedFloatInvocationParameter {
          invocationInputField
        }
        ... on FloatInvocationParameter {
          invocationInputField
        }
        ... on IntInvocationParameter {
          invocationInputField
        }
        ... on JSONInvocationParameter {
          invocationInputField
        }
        ... on StringListInvocationParameter {
          invocationInputField
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();vu.hash="65ef72eb48726c70f00811d17ea6d82d";async function k2(n){const{spanId:a}=n.params;if(!a||typeof a!="string")throw new Error("Invalid spanId");return await x.fetchQuery(be,vu,{spanId:a}).toPromise()}const Cu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PromptsTablePromptsQuery",selections:[{args:a,kind:"FragmentSpread",name:"PromptsTable_prompts"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PromptsTablePromptsQuery",selections:[{alias:null,args:a,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},l,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}]},params:{cacheID:"78e88c2a2ce510e78c6c6d8e1b8523b2",id:null,metadata:{},name:"PromptsTablePromptsQuery",operationKind:"query",text:`query PromptsTablePromptsQuery(
  $after: String = null
  $first: Int = 100
) {
  ...PromptsTable_prompts_2HEEH6
}

fragment PromptsTable_prompts_2HEEH6 on Query {
  prompts(first: $first, after: $after) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Cu.hash="829c7cff273e0ebcfba1c0606c052d8b";const Fu=function(){var n=["prompts"],a={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Cu}},name:"PromptsTable_prompts",selections:[{alias:"prompts",args:null,concreteType:"PromptConnection",kind:"LinkedField",name:"__PromptsTable_prompts_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},a,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[a],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();Fu.hash="829c7cff273e0ebcfba1c0606c052d8b";const Ku=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{fields:[{kind:"Variable",name:"promptId",variableName:"promptId"}],kind:"ObjectValue",name:"input"}],l=[{kind:"Literal",name:"first",value:100}],t={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeletePromptDialogMutation",selections:[{alias:null,args:a,concreteType:"DeletePromptMutationPayload",kind:"LinkedField",name:"deletePrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptsTable_prompts"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeletePromptDialogMutation",selections:[{alias:null,args:a,concreteType:"DeletePromptMutationPayload",kind:"LinkedField",name:"deletePrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"prompts(first:100)"},{alias:null,args:l,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}],storageKey:null}],storageKey:null}]},params:{cacheID:"3afd45452374727a72b967ee1cce1632",id:null,metadata:{},name:"DeletePromptDialogMutation",operationKind:"mutation",text:`mutation DeletePromptDialogMutation(
  $promptId: GlobalID!
) {
  deletePrompt(input: {promptId: $promptId}) {
    query {
      ...PromptsTable_prompts
    }
  }
}

fragment PromptsTable_prompts on Query {
  prompts(first: 100) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Ku.hash="209a27a82eef96e2c39abfe579346bcc";function dv({promptId:n,onDeleted:a,onClose:l}){const[t,i]=x.useMutation(Ku),r=Se(),o=Te(),d=m.useCallback(()=>{t({variables:{promptId:n},onCompleted:()=>{r({title:"Delete Successful",message:"Prompt has been deleted."}),a(),l()},onError:c=>{o({title:"Failed to delete prompt",message:c.message})}})},[t,o,r,l,a,n]);return s(X,{title:"Delete Prompt",isDismissable:!0,onDismiss:l,children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete this prompt? This action cannot be undone and all services dependent on this prompt will be affected."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:s(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(M,{variant:"default",onPress:l,size:"S",children:"Cancel"}),e(M,{variant:"danger",onPress:()=>{d()},size:"S",isDisabled:i,children:"Delete Prompt"})]})})]})}function cv({onDeleted:n,promptId:a}){const[l,t]=m.useState(null),i=m.useCallback(()=>{t(e(dv,{promptId:a,onClose:()=>t(null),onDeleted:()=>{n(),t(null)}}))},[a,n]);return s(Lt,{children:[e(Hn,{align:"end","aria-label":"User Actions",buttonSize:"compact",onAction:r=>{switch(r){case"DELETE":i();break}},children:e(de,{children:s(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(_,{svg:e(sn,{})}),e(H,{children:"Delete"})]})},"DELETE")}),e(Y,{type:"modal",isDismissable:!0,onDismiss:()=>t(null),children:l})]})}const uv=100;function mv(n){const a=se(),l=m.useRef(null),{data:t,loadNext:i,hasNext:r,isLoadingNext:o,refetch:d}=x.usePaginationFragment(Fu,n.query),c=m.useMemo(()=>t.prompts.edges.map(k=>({lastUpdatedAt:k.prompt.version.createdAt,...k.prompt})),[t]),p=Ie.useCallback(k=>{if(k){const{scrollHeight:b,scrollTop:S,clientHeight:F}=k;b-S-F<300&&!o&&r&&i(uv)}},[r,o,i]),y=m.useMemo(()=>[{header:"name",accessorKey:"name",cell:({row:b})=>e(Qe,{to:`${b.original.id}`,children:b.original.name})},{header:"description",accessorKey:"description",cell:Ke},{header:"created at",accessorKey:"createdAt",cell:Me},{header:"last updated",accessorKey:"lastUpdatedAt",cell:Me},{id:"actions",header:"",size:5,accessorKey:"id",cell:({row:b})=>s(h,{direction:"row",gap:"size-100",justifyContent:"end",width:"100%",children:[e(Lt,{children:e(Kl,{leadingVisual:e(_,{svg:e(pa,{})}),size:"S","aria-label":"Open in playground",to:`${b.original.id}/playground`,children:"Playground"})}),e(cv,{promptId:b.original.id,onDeleted:()=>{d({},{fetchPolicy:"network-only"})}})]})}],[d]),u=xe({columns:y,data:c,getCoreRowModel:De(),getSortedRowModel:kn()}),g=u.getRowModel().rows,f=g.length===0;return e("div",{css:T`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:k=>p(k.target),ref:l,children:s("table",{css:Gn,children:[e("thead",{children:u.getHeaderGroups().map(k=>e("tr",{children:k.headers.map(b=>{var S;return e("th",{colSpan:b.colSpan,children:b.isPlaceholder?null:s("div",{className:b.column.getCanSort()?"cursor-pointer":"","aria-role":b.column.getCanSort()?"button":null,onClick:b.column.getToggleSortingHandler(),style:{textAlign:(S=b.column.columnDef.meta)==null?void 0:S.textAlign},children:[Z(b.column.columnDef.header,b.getContext()),b.column.getIsSorted()?e(_,{className:"sort-icon",svg:b.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]})},b.id)})},k.id))}),f?e(rn,{}):e("tbody",{children:g.map(k=>e("tr",{onClick:()=>{a(`${k.original.id}`)},children:k.getVisibleCells().map(b=>{var S;return e("td",{align:(S=b.column.columnDef.meta)==null?void 0:S.textAlign,children:Z(b.column.columnDef.cell,b.getContext())},b.id)})},k.id))})]})})}function b2(){const n=Ue();return s(h,{direction:"column",height:"100%",children:[e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",flex:"none",children:s(h,{direction:"row",justifyContent:"space-between",children:[e(te,{level:1,children:"Prompts"}),e(Kl,{size:"S",leadingVisual:e(_,{svg:e(Ca,{})}),to:"/playground",children:"Create Prompt"})]})}),e(mv,{query:n})]})}const Tu=function(){var n=[{kind:"Literal",name:"first",value:100}],a={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"promptsLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"PromptsTable_prompts"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"promptsLoaderQuery",selections:[{alias:null,args:n,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},a,{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[a],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"prompts(first:100)"},{alias:null,args:n,filters:null,handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}]},params:{cacheID:"191e9b9974109498195fdef708db636b",id:null,metadata:{},name:"promptsLoaderQuery",operationKind:"query",text:`query promptsLoaderQuery {
  ...PromptsTable_prompts
}

fragment PromptsTable_prompts on Query {
  prompts(first: 100) {
    edges {
      prompt: node {
        id
        name
        description
        createdAt
        version {
          createdAt
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Tu.hash="ed4295f193bd2a6d2402a82966d45a7f";async function S2(n){return await x.fetchQuery(be,Tu,{}).toPromise()}const Pu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},o=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},y={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},u=[t,i],g={alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:u,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,{args:null,kind:"FragmentSpread",name:"PromptIndexPage__main"},{args:null,kind:"FragmentSpread",name:"PromptVersionsPageContent__main"},{args:null,kind:"FragmentSpread",name:"PromptLayout__main"}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[r,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},i],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:o,storageKey:null},{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null}],storageKey:null},{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,d,c,p,y,g],storageKey:null}],storageKey:null}],storageKey:null},d,{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,d,p,c,y,g],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"sourcePrompt",plural:!1,selections:u,storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"cc1c86124ed137944acd05f33823e920",id:null,metadata:{},name:"promptLoaderQuery",operationKind:"query",text:`query promptLoaderQuery(
  $id: GlobalID!
) {
  prompt: node(id: $id) {
    __typename
    id
    ... on Prompt {
      name
      ...PromptIndexPage__main
      ...PromptVersionsPageContent__main
      ...PromptLayout__main
    }
  }
}

fragment EditPromptButton_data on Prompt {
  id
  description
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptIndexPage__aside on Prompt {
  description
  ...PromptLatestVersionsListFragment
  ...EditPromptButton_data
}

fragment PromptIndexPage__main on Prompt {
  promptVersions {
    edges {
      node {
        ...PromptInvocationParameters__main
        ...PromptChatMessagesCard__main
        ...PromptCodeExportCard__main
        ...PromptModelConfigurationCard__main
      }
    }
  }
  ...PromptIndexPage__aside
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptLatestVersionsListFragment on Prompt {
  latestVersions: promptVersions(first: 5) {
    edges {
      version: node {
        id
        description
        createdAt
        sequenceNumber
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptLayout__main on Prompt {
  id
  name
  description
  sourcePrompt {
    id
    name
  }
  promptVersions {
    edges {
      node {
        id
      }
    }
  }
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}

fragment PromptVersionsList__main on Prompt {
  promptVersions {
    edges {
      version: node {
        id
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptVersionsPageContent__main on Prompt {
  ...PromptVersionsList__main
}
`}}}();Pu.hash="dd012c15d97eec72a33a69900a92dc9a";async function v2(n){const{promptId:a}=n.params;return await x.fetchQuery(be,Pu,{id:a}).toPromise().catch(()=>{throw new Error("Prompt not found")})}const Iu=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionTagsConfigCard_data",selections:[n,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}}();Iu.hash="3650e60f18eb8d95b707df7bdbce99a9";const xu=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeletePromptVersionTagButtonMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"deletePromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsConfigCard_data"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeletePromptVersionTagButtonMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"deletePromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"f33f0c5c35bdfcb0a9fdb1eacff3dec8",id:null,metadata:{},name:"DeletePromptVersionTagButtonMutation",operationKind:"mutation",text:`mutation DeletePromptVersionTagButtonMutation(
  $input: DeletePromptVersionTagInput!
  $promptId: GlobalID!
) {
  deletePromptVersionTag(input: $input) {
    query {
      node(id: $promptId) {
        __typename
        ...PromptVersionTagsConfigCard_data
        __isNode: __typename
        id
      }
    }
  }
}

fragment PromptVersionTagsConfigCard_data on Prompt {
  id
  versionTags {
    id
    name
    description
    promptVersionId
  }
}
`}}}();xu.hash="9a239d04f2789c811b994f09bd0a814a";function pv({promptVersionTagId:n,promptId:a}){const l=Se(),[t,i]=x.useMutation(xu);return s(dt,{children:[e(M,{"aria-label":"Delete tag",size:"S",leadingVisual:e(_,{svg:e(sn,{})})}),s(br,{placement:"bottom end",children:[e(Sr,{}),e(ot,{children:s(C,{padding:"size-200",children:[e(C,{paddingBottom:"size-100",children:e(v,{color:"danger",size:"XS",children:"Are you sure you want to delete this tag? This will make pulling prompts by this tag no longer possible. Make sure this tag is not used before deleting."})}),e(M,{css:T`
                width: 100%;
              `,variant:"danger",size:"S",onPress:()=>t({variables:{input:{promptVersionTagId:n},promptId:a},onCompleted:()=>{l({title:"Tag Deleted",message:"The tag has been deleted"})}}),children:i?"Deleting...":"Delete Tag"})]})})]})]})}function gv({prompt:n}){const a=x.useFragment(Iu,n),l=m.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:Ke},{header:"Version",accessorKey:"promptVersionId",cell:({row:d})=>{const{promptId:c,promptVersionId:p}=d.original;return e(Qe,{to:`/prompts/${c}/versions/${p}`,children:d.original.promptVersionId})}},{id:"actions",header:"",size:5,accessorKey:"id",cell:({row:d})=>e(h,{direction:"row",gap:"size-100",justifyContent:"end",width:"100%",children:e(pv,{promptVersionTagId:d.original.id,promptId:d.original.promptId},d.original.id)})}],[]),t=m.useMemo(()=>a.versionTags.map(d=>({id:d.id,name:d.name,description:d.description,promptId:a.id,promptVersionId:d.promptVersionId})),[a]),i=xe({columns:l,data:t,getCoreRowModel:De(),getSortedRowModel:kn()}),r=i.getRowModel().rows,o=r.length===0;return e(O,{title:"Tags",variant:"compact",bodyStyle:{padding:0},children:s("table",{css:tn,children:[e("thead",{children:i.getHeaderGroups().map(d=>e("tr",{children:d.headers.map(c=>e("th",{colSpan:c.colSpan,children:c.isPlaceholder?null:s("div",{className:c.column.getCanSort()?"cursor-pointer":"",onClick:c.column.getToggleSortingHandler(),style:{left:c.getStart(),width:c.getSize()},children:[Z(c.column.columnDef.header,c.getContext()),c.column.getIsSorted()?e(_,{className:"sort-icon",svg:c.column.getIsSorted()==="asc"?e(dn,{}):e(on,{})}):null]})},c.id))},d.id))}),o?e(rn,{message:"No Tags"}):e("tbody",{children:r.map(d=>e("tr",{children:d.getVisibleCells().map(c=>e("td",{children:Z(c.column.columnDef.cell,c.getContext())},c.id))},d.id))})]})})}function C2(){const n=Ue();return e(h,{direction:"row",height:"100%",children:e(C,{height:"100%",overflow:"auto",width:"100%","data-testid":"scroll-container",children:e(C,{padding:"size-200",children:e(h,{direction:"column",gap:"size-200",marginStart:"auto",marginEnd:"auto",maxWidth:900,children:e(gv,{prompt:n.prompt})})})})})}function F2(){const n=Ue();return e(gg,{query:n,children:e(Oe,{})})}const Du=function(){var n={alias:null,args:null,kind:"ScalarField",name:"passwordNeedsReset",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"authenticatedRootLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"ViewerContext_viewer"},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[n],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"authenticatedRootLoaderQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[l],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},n],storageKey:null}]},params:{cacheID:"d63c6184305079deb38a6f6235ba88e6",id:null,metadata:{},name:"authenticatedRootLoaderQuery",operationKind:"query",text:`query authenticatedRootLoaderQuery {
  ...ViewerContext_viewer
  viewer {
    passwordNeedsReset
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}

fragment ViewerContext_viewer on Query {
  viewer {
    id
    username
    email
    profilePictureUrl
    role {
      name
    }
    authMethod
    ...APIKeysTableFragment
  }
}
`}}}();Du.hash="d30a68846023740517243e9394be73a8";async function K2(){var a;const n=await x.fetchQuery(be,Du,{}).toPromise();if((a=n==null?void 0:n.viewer)!=null&&a.passwordNeedsReset){const l=Or({path:"/reset-password"});return Ua(l)}return n}const yv=T`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: var(--ac-global-dimension-size-200);
  padding: var(--ac-global-dimension-size-200);
`;function T2(){return e("main",{children:s(h,{direction:"column",width:"100%",children:[e(C,{padding:"size-200",borderBottomColor:"dark",borderBottomWidth:"thin",children:s(h,{direction:"column",gap:"size-50",children:[e(te,{level:1,children:"Support"}),e(v,{color:"text-700",children:"We are here to help. Pick a channel below to get in touch with us."})]})}),s("div",{css:yv,children:[e(Qa,{leadingVisual:e(_,{svg:e(yg,{})}),href:"https://docs.arize.com/phoenix",title:"Documentation",description:"Visit our documentation for tutorials and AI support."}),e(Qa,{leadingVisual:e(_,{svg:e(yi,{})}),href:"https://github.com/Arize-ai/phoenix/issues",title:"GitHub Issues",description:"Create an issue on Github to report bugs or request new features."}),e(Qa,{leadingVisual:e(_,{svg:e(yi,{})}),href:"https://github.com/Arize-ai/phoenix/discussions",title:"GitHub Discussions",description:"Create a discussion on Github to ask questions or share feedback."}),e(Qa,{leadingVisual:e(_,{svg:e(fi,{})}),href:"https://arize-ai.slack.com/join/shared_invite/zt-11t1vbu4x-xkBIHmOREQnYnYDH1GDfCg?__hstc=259489365.a667dfafcfa0169c8aee4178d115dc81.1733501603539.1733501603539.1733501603539.1&__hssc=259489365.1.1733501603539&__hsfp=3822854628&submissionGuid=381a0676-8f38-437b-96f2-fc10875658df#/shared-invite/email",title:"Slack",description:"Join our Slack community to chat with other users and the team."}),e(Qa,{leadingVisual:e(_,{svg:e(fi,{})}),href:"mailto:phoenix-support@arize.com?subject=Slack%20Connect%20Request",title:"Slack Connect",description:"Get a dedicated support channel for you and your team."})]})]})})}const fv=T`
  padding: var(--ac-global-dimension-size-200)
    var(--ac-global-dimension-size-200) var(--ac-global-dimension-size-200);
  border: var(--ac-global-border-size-thin) solid
    var(--ac-global-border-color-dark);
  border-radius: var(--ac-global-dimension-size-100);
  cursor: pointer;
  background-color: var(--ac-global-background-color-dark);
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-50);
  color: var(--ac-global-color-text-700);
  transition: border-color 0.2s ease-in-out;
  text-decoration: none;
  &:hover {
    border-color: var(--ac-global-color-primary);
  }
`,Qa=({leadingVisual:n,href:a,title:l,description:t})=>s("a",{css:fv,href:a,target:"_blank",rel:"noreferrer",children:[s(h,{direction:"row",gap:"size-100",alignItems:"center",children:[n,e(te,{level:2,children:l})]}),e(v,{color:"text-700",children:t})]});export{Dv as $,a2 as A,Xv as B,r2 as C,Qv as D,$v as E,g2 as F,i2 as G,f2 as H,k2 as I,h2 as J,S2 as K,c2 as L,zv as M,b2 as N,v2 as O,y2 as P,Iv as Q,Dn as R,Av as S,ra as T,Vv as U,Ev as V,wv as W,Mv as X,Pv as Y,C2 as Z,xv as _,jn as a,Lv as a0,d2 as a1,T2 as a2,o2 as a3,s2 as a4,Tv as a5,F2 as a6,Bv as a7,Kv as a8,Fv as a9,Kn as b,uy as c,u2 as d,m2 as e,K2 as f,jv as g,Nv as h,Ov as i,Hv as j,Jv as k,qv as l,Cv as m,_v as n,Gv as o,Uv as p,Wv as q,p2 as r,Rv as s,Zv as t,h1 as u,Yv as v,l2 as w,t2 as x,n2 as y,e2 as z};
